<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><meta name="baidu-site-verification" content="code-Um7dmQVTiB"><title>某外买APP设备指纹风控分析 - R1024</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="R1024"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="R1024"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="大多数电商防御方案是通过端上安全、链路安全、接口和数据传输安全保护，再借助设备安全核验技术、人机识别及时发现各种模拟行为和异操作风险、同时集合风控策略实现多节点防护。"><meta property="og:type" content="blog"><meta property="og:title" content="R1024"><meta property="og:url" content="http://www.404nofoundx.top/20220112/%E6%9F%90%E5%A4%96%E4%B9%B0APP%E8%AE%BE%E5%A4%87%E6%8C%87%E7%BA%B9%E9%A3%8E%E6%8E%A7%E5%88%86%E6%9E%90/"><meta property="og:site_name" content="R1024"><meta property="og:description" content="大多数电商防御方案是通过端上安全、链路安全、接口和数据传输安全保护，再借助设备安全核验技术、人机识别及时发现各种模拟行为和异操作风险、同时集合风控策略实现多节点防护。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://gitee.com/nofound404/image-cloud/raw/master/wecover_APP风控.jpg"><meta property="article:published_time" content="2022-01-12T10:53:09.000Z"><meta property="article:modified_time" content="2022-01-13T12:05:53.272Z"><meta property="article:author" content="R1024"><meta property="article:tag" content="安卓逆向"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://gitee.com/nofound404/image-cloud/raw/master/wecover_APP风控.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://www.404nofoundx.top/20220112/%E6%9F%90%E5%A4%96%E4%B9%B0APP%E8%AE%BE%E5%A4%87%E6%8C%87%E7%BA%B9%E9%A3%8E%E6%8E%A7%E5%88%86%E6%9E%90/"},"headline":"某外买APP设备指纹风控分析","image":["https://gitee.com/nofound404/image-cloud/raw/master/wecover_APP风控.jpg"],"datePublished":"2022-01-12T10:53:09.000Z","dateModified":"2022-01-13T12:05:53.272Z","author":{"@type":"Person","name":"R1024"},"publisher":{"@type":"Organization","name":"R1024","logo":{"@type":"ImageObject","url":{"text":"R1024"}}},"description":"大多数电商防御方案是通过端上安全、链路安全、接口和数据传输安全保护，再借助设备安全核验技术、人机识别及时发现各种模拟行为和异操作风险、同时集合风控策略实现多节点防护。"}</script><link rel="canonical" href="http://www.404nofoundx.top/20220112/%E6%9F%90%E5%A4%96%E4%B9%B0APP%E8%AE%BE%E5%A4%87%E6%8C%87%E7%BA%B9%E9%A3%8E%E6%8E%A7%E5%88%86%E6%9E%90/"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><script>var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?52c041fd9882a2d4b05bb16f933cdf75";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();</script><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">R1024</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">主页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/about">关于</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/404nofoundx"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><div class="card"><article class="card-content article" role="article"><h1 class="title is-3 is-size-4-mobile">某外买APP设备指纹风控分析</h1><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2022-01-12</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2022-01-13</time></span><span class="level-item"><a class="link-muted" href="/categories/%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91/">安卓逆向</a></span><span class="level-item">2 小时读完 (大约18981个字)</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>次访问</span></div></div><div class="content"><blockquote>
<p>本文章转自看雪论坛 “我是小三”</p>
<p>如有侵权,请作者联系删除.(由于原作者发帖不久被删帖,故转发该贴到本个人博客)</p>
</blockquote>
<h1 id="一、电商类APP业务风险类型"><a href="#一、电商类APP业务风险类型" class="headerlink" title="一、电商类APP业务风险类型"></a>一、电商类APP业务风险类型</h1><p>电商行业的各个业务场景面临不同的风险种类：客户端漏洞利用、协议逆向、注册小号、商品信息被抓取、推广渠道作弊、营销活动被薅羊毛、商品秒杀等。<br>大多的防御方案是通过端上安全、链路安全、接口和数据传输安全保护，再借助设备安全核验技术、人机识别及时发现各种模拟行为和异操作风险、同时集合风控策略实现多节点防护。</p>
<h1 id="二、设备指纹在业务中的应用"><a href="#二、设备指纹在业务中的应用" class="headerlink" title="二、设备指纹在业务中的应用"></a>二、设备指纹在业务中的应用</h1><p>设备指纹技术是使用更多的信息来完成对终端设备的唯一性识别，在业务中可以有效辨别设备是真实用户还是机器在注册、登录，及时检测出单设备登入多帐号、防止批量注册、登录等操作行为。</p>
<h1 id="三、整体框架"><a href="#三、整体框架" class="headerlink" title="三、整体框架"></a>三、整体框架</h1><p>因为框架流程过于复杂，我将框架分为两个部分，一是初始化，二是设备指纹，这样会更清楚些，如图3-1与3-2所示：</p>
<p><img src="https://gitee.com/nofound404/image-cloud/raw/master/536985_R89VVQ2HVHU88ZC.png" alt="图3-1"></p>
<p><img src="https://gitee.com/nofound404/image-cloud/raw/master/536985_WJXB49XPJ7M6MYD.png" alt="图3-2"></p>
<h1 id="四、初始化流程分析"><a href="#四、初始化流程分析" class="headerlink" title="四、初始化流程分析"></a>四、初始化流程分析</h1><h2 id="4-1、初始化准备"><a href="#4-1、初始化准备" class="headerlink" title="4.1、初始化准备"></a>4.1、初始化准备</h2><p>java层调用init()初始化，获取Context，包名，AppInfo，XML配置信息等，然后加载so libmtguard.so 在so中注册一个Native方法，该Native方法传入不同的数字代表不同的功能，代码如下所示：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Lcom/meituan/android/common/mtguard/MTGuard;-&gt;loadSo(Ljava/lang/String;)V</span><br><span class="line">System.loadLibrary(<span class="string">&quot;mtguard&quot;</span>);</span><br><span class="line"><span class="comment">//注册Native方法</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">native</span> Object[] main(<span class="keyword">int</span> arg0, Object[] arg1)<span class="comment">//arg0:传入不同的编号走不同的逻辑，arg1:参数</span></span><br></pre></td></tr></table></figure>

<h2 id="4-2、系统环境检测"><a href="#4-2、系统环境检测" class="headerlink" title="4.2、系统环境检测"></a>4.2、系统环境检测</h2><p>调用Native层Object[] v12_2 = NBridge.main3(1, new Object[1])，传入参数为1,表示检测环境， 检测系统目录中是否有ls文件且是否为elf格式:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">.text:B1BF744E 01 26       MOVS            R6, #1</span><br><span class="line">.text:B1BF7450 2E 70       STRB            R6, [R5]</span><br><span class="line">.text:B1BF7452 20 48       LDR             R0, =(aSystemBinLs - 0xB1BF7458) ; &quot;/system/bin/ls&quot;</span><br><span class="line">.text:B1BF7454 78 44       ADD             R0, PC                  ; &quot;/system/bin/ls&quot; ; file</span><br><span class="line">.text:B1BF7456 00 25       MOVS            R5, #0</span><br><span class="line">.text:B1BF7458 29 00       MOVS            R1, R5                  ; oflag</span><br><span class="line">.text:B1BF745A CF F7 A0 EC BLX             open</span><br><span class="line">.text:B1BF745E 04 00       MOVS            R4, R0</span><br><span class="line">.text:B1BF7460 00 2C       CMP             R4, #0</span><br><span class="line">.text:B1BF7462 25 DB       BLT             loc_B1BF74B0</span><br><span class="line">.text:B1BF7464 01 AD       ADD             R5, SP, #0x28+buf</span><br><span class="line">.text:B1BF7466 14 22       MOVS            R2, #0x14               ; nbytes</span><br><span class="line">.text:B1BF7468 20 00       MOVS            R0, R4                  ; fd</span><br><span class="line">.text:B1BF746A 29 00       MOVS            R1, R5                  ; buf</span><br><span class="line">.text:B1BF746C CF F7 10 EE BLX             read</span><br><span class="line">.text:B1BF7470 14 28       CMP             R0, #0x14</span><br><span class="line">.text:B1BF7472 18 D1       BNE             loc_B1BF74A6</span><br><span class="line">.text:B1BF7474 28 78       LDRB            R0, [R5]</span><br><span class="line">.text:B1BF7476 7F 28       CMP             R0, #0x7F</span><br><span class="line">.text:B1BF7478 15 D1       BNE             loc_B1BF74A6</span><br><span class="line">.text:B1BF747A 01 A8       ADD             R0, SP, #0x28+buf</span><br><span class="line">.text:B1BF747C 40 78       LDRB            R0, [R0,#1]</span><br><span class="line">.text:B1BF747E 45 28       CMP             R0, #0x45 ; &#x27;E&#x27;</span><br><span class="line">.text:B1BF7480 11 D1       BNE             loc_B1BF74A6</span><br><span class="line">.text:B1BF7482 01 A8       ADD             R0, SP, #0x28+buf</span><br><span class="line">.text:B1BF7484 80 78       LDRB            R0, [R0,#2]</span><br><span class="line">.text:B1BF7486 4C 28       CMP             R0, #0x4C ; &#x27;L&#x27;</span><br><span class="line">.text:B1BF7488 0D D1       BNE             loc_B1BF74A6</span><br><span class="line">.text:B1BF748A 01 A8       ADD             R0, SP, #0x28+buf</span><br><span class="line">.text:B1BF748C C0 78       LDRB            R0, [R0,#3]</span><br><span class="line">.text:B1BF748E 46 28       CMP             R0, #0x46 ; &#x27;F&#x27;</span><br><span class="line">.text:B1BF7490 09 D1       BNE             loc_B1BF74A6</span><br><span class="line">.text:B1BF7492 01 A8       ADD             R0, SP, #0x28+buf</span><br><span class="line">.text:B1BF7494 80 7C       LDRB            R0, [R0,#0x12]</span><br><span class="line">.text:B1BF7496 3E 28       CMP             R0, #0x3E ; &#x27;&gt;&#x27;</span><br><span class="line">.text:B1BF7498 01 D0       BEQ             loc_B1BF749E</span><br><span class="line">.text:B1BF749A 03 28       CMP             R0, #3</span><br><span class="line">.text:B1BF749C 03 D1       BNE             loc_B1BF74A6</span><br><span class="line">.text:B1BF749E</span><br><span class="line">.text:B1BF749E             loc_B1BF749E</span><br><span class="line">.text:B1BF749E 20 00       MOVS            R0, R4                  ; fd</span><br><span class="line">.text:B1BF74A0 CF F7 88 EC BLX             close</span><br></pre></td></tr></table></figure>

<p>检测XPOSED、代理、ROM是否为自己编译的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">//检测</span><br><span class="line">de.robv.android.xposed.XposedBridge</span><br><span class="line"> </span><br><span class="line">//检测代理</span><br><span class="line">http.proxyHost</span><br><span class="line">https.proxyHost</span><br><span class="line">getProperty</span><br></pre></td></tr></table></figure>

<p>检测关键方法是否被hook</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//检测方法是否被hook</span><br><span class="line">传入方法首地址进行对比 0x780x5F  0xF8DF</span><br><span class="line">//如果检测到第一个方法被hook，结果如下</span><br><span class="line">1|</span><br><span class="line">如果检测到第2个方法被hook，结果如下</span><br><span class="line">1|2|</span><br><span class="line">如果检测到第3个方法被hook，结果如下</span><br><span class="line">1|2|3|</span><br></pre></td></tr></table></figure>

<p>其它检测，代码如下:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">boolean</span> v2 = MTGuard.isEmu();</span><br><span class="line"><span class="keyword">boolean</span> v3 = MTGuard.isRoot();</span><br><span class="line"><span class="keyword">boolean</span> v4 = MTGuard.hasMalware();</span><br><span class="line"><span class="keyword">boolean</span> v5 = MTGuard.isDarkSystem();</span><br><span class="line"><span class="keyword">boolean</span> v6 = MTGuard.isVirtualLocation();</span><br><span class="line"><span class="keyword">boolean</span> v7 = MTGuard.isRemoteCall();</span><br><span class="line"><span class="keyword">boolean</span> v8 = MTGuard.isSigCheckOK();</span><br><span class="line"><span class="keyword">boolean</span> v11 = MTGuard.inSandBox();</span><br><span class="line"><span class="keyword">boolean</span> v13 = MTGuard.isHook();</span><br><span class="line"><span class="keyword">boolean</span> v14 = MTGuard.isDebug();</span><br><span class="line"><span class="keyword">boolean</span> v15 = MTGuard.isProxy();</span><br><span class="line"><span class="keyword">boolean</span> v16 = MTGuard.isCameraHack();</span><br><span class="line">最终都会走到Native方法中去</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">native</span> Object[] main(<span class="keyword">int</span> arg0, Object[] arg1);</span><br></pre></td></tr></table></figure>

<h2 id="4-3、读取资源文件并解密"><a href="#4-3、读取资源文件并解密" class="headerlink" title="4.3、读取资源文件并解密"></a>4.3、读取资源文件并解密</h2><h3 id="4-3-1、读文件META-INF-SANKUAI-RSA计算MD5"><a href="#4-3-1、读文件META-INF-SANKUAI-RSA计算MD5" class="headerlink" title="4.3.1、读文件META-INF/SANKUAI.RSA计算MD5"></a>4.3.1、读文件META-INF/SANKUAI.RSA计算MD5</h3><p>代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">.text:B65E1FE4 F0 B5       PUSH            &#123;R4-R7,LR&#125;</span><br><span class="line">.text:B65E1FE6 03 AF       ADD             R7, SP, #0xC</span><br><span class="line">.text:B65E1FE8 8F B0       SUB             SP, SP, #0x3C</span><br><span class="line">.text:B65E1FEA 0E 00       MOVS            R6, R1</span><br><span class="line">.text:B65E1FEC 2D 49       LDR             R1, =(__stack_chk_guard_ptr - 0xB65E1FF2)</span><br><span class="line">.text:B65E1FEE 79 44       ADD             R1, PC                  ; __stack_chk_guard_ptr</span><br><span class="line">.text:B65E1FF0 0C 68       LDR             R4, [R1]                ; __stack_chk_guard</span><br><span class="line">.text:B65E1FF2 21 68       LDR             R1, [R4]</span><br><span class="line">.text:B65E1FF4 0E 91       STR             R1, [SP,#0x48+var_10]</span><br><span class="line">.text:B65E1FF6 0A 21       MOVS            R1, #0xA</span><br><span class="line">.text:B65E1FF8 CA 43       MVNS            R2, R1</span><br><span class="line">.text:B65E1FFA 01 68       LDR             R1, [R0]                ; file</span><br><span class="line">.text:B65E1FFC 48 1E       SUBS            R0, R1, #1</span><br><span class="line">.text:B65E1FFE 82 58       LDR             R2, [R0,R2]</span><br><span class="line">.text:B65E2000 00 25       MOVS            R5, #0</span><br><span class="line">.text:B65E2002 E8 43       MVNS            R0, R5</span><br><span class="line">.text:B65E2004 00 2A       CMP             R2, #0</span><br><span class="line">.text:B65E2006 43 D0       BEQ             loc_B65E2090</span><br><span class="line">.text:B65E2008 00 25       MOVS            R5, #0</span><br><span class="line">.text:B65E200A 05 95       STR             R5, [SP,#0x48+var_34]</span><br><span class="line">.text:B65E200C 04 90       STR             R0, [SP,#0x48+var_38]</span><br><span class="line">.text:B65E200E 06 90       STR             R0, [SP,#0x48+var_30]</span><br><span class="line">.text:B65E2010 07 95       STR             R5, [SP,#0x48+var_2C]</span><br><span class="line">.text:B65E2012 08 90       STR             R0, [SP,#0x48+var_28]</span><br><span class="line">.text:B65E2014 0C 90       STR             R0, [SP,#0x48+var_18]</span><br><span class="line">.text:B65E2016 0D 95       STR             R5, [SP,#0x48+var_14]</span><br><span class="line">.text:B65E2018 E8 43       MVNS            R0, R5</span><br><span class="line">.text:B65E201A 0B 90       STR             R0, [SP,#0x48+var_1C]</span><br><span class="line">.text:B65E201C 0A 90       STR             R0, [SP,#0x48+var_20]</span><br><span class="line">.text:B65E201E 04 A8       ADD             R0, SP, #0x48+var_38    ; int</span><br><span class="line">.text:B65E2020 0D F0 40 FF BL              openfile_sub_C6BADEA4   ; R3：要读取的文件</span><br><span class="line">.text:B65E2024 01 30       ADDS            R0, #1</span><br><span class="line">.text:B65E2026 30 D0       BEQ             loc_B65E208A</span><br><span class="line">.text:B65E2028 02 96       STR             R6, [SP,#0x48+var_40]</span><br><span class="line">.text:B65E202A 04 A8       ADD             R0, SP, #0x48+var_38</span><br><span class="line">.text:B65E202C 1E 49       LDR             R1, =(sub_B65E20AC+1 - 0xB65E2032)</span><br><span class="line">.text:B65E202E 79 44       ADD             R1, PC                  ; sub_B65E20AC</span><br><span class="line">.text:B65E2030 0E F0 C8 F9 BL              size_sub_C6BAE3C4</span><br><span class="line">.text:B65E2034 06 00       MOVS            R6, R0</span><br><span class="line">.text:B65E2036 00 2E       CMP             R6, #0</span><br><span class="line">.text:B65E2038 27 D0       BEQ             loc_B65E208A</span><br><span class="line">.text:B65E203A 00 25       MOVS            R5, #0</span><br><span class="line">.text:B65E203C 03 95       STR             R5, [SP,#0x48+byte_count]</span><br><span class="line">.text:B65E203E 04 A8       ADD             R0, SP, #0x48+var_38</span><br><span class="line">.text:B65E2040 03 AA       ADD             R2, SP, #0x48+byte_count</span><br><span class="line">.text:B65E2042 31 00       MOVS            R1, R6</span><br><span class="line">.text:B65E2044 0E F0 2E FB BL              read_sub_C6BAE6A4</span><br><span class="line">.text:B65E2048 03 99       LDR             R1, [SP,#0x48+byte_count]</span><br><span class="line">.text:B65E204A 00 29       CMP             R1, #0</span><br><span class="line">.text:B65E204C 1D D0       BEQ             loc_B65E208A</span><br><span class="line">.text:B65E204E 00 28       CMP             R0, #0</span><br><span class="line">.text:B65E2050 1B D0       BEQ             loc_B65E208A</span><br><span class="line">.text:B65E2052 08 00       MOVS            R0, R1                  ; byte_count</span><br><span class="line">.text:B65E2054 01 91       STR             R1, [SP,#0x48+var_44]</span><br><span class="line">.text:B65E2056 EF F7 48 EE BLX             malloc                  ; 分配存放空间</span><br><span class="line">.text:B65E205A 02 00       MOVS            R2, R0</span><br><span class="line">.text:B65E205C 00 28       CMP             R0, #0</span><br><span class="line">.text:B65E205E 14 D0       BEQ             loc_B65E208A</span><br><span class="line">.text:B65E2060 00 21       MOVS            R1, #0</span><br><span class="line">.text:B65E2062 15 00       MOVS            R5, R2</span><br><span class="line">.text:B65E2064 28 00       MOVS            R0, R5</span><br><span class="line">.text:B65E2066 01 9A       LDR             R2, [SP,#0x48+var_44]</span><br><span class="line">.text:B65E2068 16 F0 2A FA BL              memset_sub_C6BB64C0</span><br><span class="line">.text:B65E206C 04 A8       ADD             R0, SP, #0x48+var_38</span><br><span class="line">.text:B65E206E 31 00       MOVS            R1, R6</span><br><span class="line">.text:B65E2070 2A 00       MOVS            R2, R5</span><br><span class="line">.text:B65E2072 0E F0 6B FB BL              ReadFile_unzip_sub_C6BAE74C ; 读取并解压</span><br><span class="line">.text:B65E2076 00 28       CMP             R0, #0</span><br><span class="line">.text:B65E2078 03 D0       BEQ             loc_B65E2082</span><br><span class="line">.text:B65E207A 03 98       LDR             R0, [SP,#0x48+byte_count]</span><br><span class="line">.text:B65E207C 02 99       LDR             R1, [SP,#0x48+var_40]</span><br><span class="line">.text:B65E207E 08 60       STR             R0, [R1]</span><br></pre></td></tr></table></figure>

<p>读取的数据与APk包中的内容是一样的。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">B3C7B000  30 82 03 F5 06 09 2A 86  48 86 F7 0D 01 07 02 A0  0.......H.......</span><br><span class="line">B3C7B010  82 03 E6 30 82 03 E2 02  01 01 31 0F 30 0D 06 09  ..........1.0...</span><br><span class="line">B3C7B020  60 86 48 01 65 03 04 02  01 05 00 30 0B 06 09 2A  `.H.e......0...*</span><br><span class="line">B3C7B030  86 48 86 F7 0D 01 07 01  A0 82 02 83 30 82 02 7F  .H..........0...</span><br><span class="line">B3C7B040  30 82 01 E8 A0 03 02 01  02 02 04 4D 69 1B B8 30  0..........Mi..0</span><br><span class="line">B3C7B050  0D 06 09 2A 86 48 86 F7  0D 01 01 05 05 00 30 81  ...*.H........0.</span><br><span class="line">B3C7B060  82 31 0B 30 09 06 03 55  04 06 13 02 43 4E 31 10  .1.0...U....CN1.</span><br><span class="line">B3C7B070  30 0E 06 03 55 04 08 13  07 42 65 69 6A 69 6E 67  0...U....Beijing</span><br><span class="line">B3C7B080  31 10 30 0E 06 03 55 04  07 13 07 42 65 69 6A 69  1.0...U....Beiji</span><br><span class="line">B3C7B090  6E 67 31 24 30 22 06 03  55 04 0A 13 1B 53 61 6E  ng1$0&quot;..U....San</span><br><span class="line">B3C7B0A0  6B 75 61 69 20 54 65 63  68 6E 6F 6C 6F 67 79 20  kuai Technology</span><br><span class="line">B3C7B0B0  43 6F 2E 20 4C 74 64 2E  31 14 30 12 06 03 55 04  Co. Ltd.1.0...U.</span><br><span class="line">B3C7B0C0  0B 13 0B 6D 65 69 74 75  61 6E 2E 63 6F 6D 31 13  ...meituan.com1.</span><br></pre></td></tr></table></figure>

<p>检测是否为RSA文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">.text:B65EFCBC             isRSA_sub_CB471CBC</span><br><span class="line">.text:B65EFCBC             ; __unwind &#123; // FDA46000</span><br><span class="line">.text:B65EFCBC D0 B5       PUSH            &#123;R4,R6,R7,LR&#125;</span><br><span class="line">.text:B65EFCBE 02 AF       ADD             R7, SP, #8</span><br><span class="line">.text:B65EFCC0 01 00       MOVS            R1, R0</span><br><span class="line">.text:B65EFCC2 00 20       MOVS            R0, #0</span><br><span class="line">.text:B65EFCC4 00 29       CMP             R1, #0</span><br><span class="line">.text:B65EFCC6 1B D0       BEQ             locret_B65EFD00</span><br><span class="line">.text:B65EFCC8 0A 78       LDRB            R2, [R1]</span><br><span class="line">.text:B65EFCCA 30 2A       CMP             R2, #0x30 ; &#x27;0&#x27;</span><br><span class="line">.text:B65EFCCC 18 D1       BNE             locret_B65EFD00</span><br><span class="line">.text:B65EFCCE 01 22       MOVS            R2, #1</span><br><span class="line">.text:B65EFCD0 8C 56       LDRSB           R4, [R1,R2]</span><br><span class="line">.text:B65EFCD2 7F 22       MOVS            R2, #0x7F</span><br><span class="line">.text:B65EFCD4 22 40       ANDS            R2, R4</span><br><span class="line">.text:B65EFCD6 FF 23       MOVS            R3, #0xFF</span><br><span class="line">.text:B65EFCD8 23 40       ANDS            R3, R4</span><br><span class="line">.text:B65EFCDA 00 2C       CMP             R4, #0</span><br><span class="line">.text:B65EFCDC 00 DB       BLT             loc_B65EFCE0</span><br><span class="line">.text:B65EFCDE 1A 00       MOVS            R2, R3</span><br><span class="line">.text:B65EFCE0</span><br><span class="line">.text:B65EFCE0             loc_B65EFCE0                    </span><br><span class="line">.text:B65EFCE0 04 2A       CMP             R2, #4</span><br><span class="line">.text:B65EFCE2 0D D8       BHI             locret_B65EFD00</span><br><span class="line">.text:B65EFCE4 00 2A       CMP             R2, #0</span><br><span class="line">.text:B65EFCE6 0B D0       BEQ             locret_B65EFD00</span><br><span class="line">.text:B65EFCE8 02 31       ADDS            R1, #2</span><br><span class="line">.text:B65EFCEA D3 00       LSLS            R3, R2, #3</span><br><span class="line">.text:B65EFCEC 08 3B       SUBS            R3, #8</span><br><span class="line">.text:B65EFCEE 00 20       MOVS            R0, #0</span><br><span class="line">.text:B65EFCF0</span><br><span class="line">.text:B65EFCF0             loc_B65EFCF0  </span><br><span class="line">.text:B65EFCF0 0C 78       LDRB            R4, [R1]</span><br><span class="line">.text:B65EFCF2 9C 40       LSLS            R4, R3</span><br><span class="line">.text:B65EFCF4 20 43       ORRS            R0, R4</span><br><span class="line">.text:B65EFCF6 01 3A       SUBS            R2, #1</span><br><span class="line">.text:B65EFCF8 08 3B       SUBS            R3, #8</span><br><span class="line">.text:B65EFCFA 01 31       ADDS            R1, #1</span><br><span class="line">.text:B65EFCFC 00 2A       CMP             R2, #0</span><br><span class="line">.text:B65EFCFE F7 D1       BNE             loc_B65EFCF0</span><br><span class="line">.text:B65EFD00</span><br><span class="line">.text:B65EFD00             locret_B65EFD00  </span><br><span class="line">.text:B65EFD00 D0 BD       POP             &#123;R4,R6,R7,PC&#125;</span><br></pre></td></tr></table></figure>

<p>计算MD5值</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __fastcall <span class="title">md5_sub_C6FEF398</span><span class="params">(<span class="keyword">int</span> a1, <span class="keyword">int</span> a2, <span class="keyword">int</span> a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// r0</span></span><br><span class="line">  <span class="keyword">int</span> v8[<span class="number">26</span>]; <span class="comment">// [sp+10h] [bp-68h] BYREF</span></span><br><span class="line"> </span><br><span class="line">  <span class="built_in">memset_sub_C6BB64C0</span>(v8, <span class="number">0</span>, <span class="number">88</span>);</span><br><span class="line">  v8[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">  v8[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">  v8[<span class="number">2</span>] = <span class="number">1732584193</span>;</span><br><span class="line">  v8[<span class="number">3</span>] = <span class="number">-271733879</span>;</span><br><span class="line">  v8[<span class="number">4</span>] = <span class="number">-1732584194</span>;</span><br><span class="line">  v8[<span class="number">5</span>] = <span class="number">271733878</span>;</span><br><span class="line">  <span class="built_in">sub_B65F11F4</span>(v8, a1, a2);</span><br><span class="line">  <span class="built_in">sub_B65F1294</span>(v8, a3);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i != <span class="number">88</span>; ++i )</span><br><span class="line">    *((_BYTE *)v8 + i) = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> _stack_chk_guard - v8[<span class="number">22</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>计算后的值为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">638C81261479C2104EDE3F2518E91725</span><br></pre></td></tr></table></figure>

<p>该值会作为解密资源密钥的一部分。</p>
<h3 id="4-3-2、解密assets-ms-com-sankuai-meituan"><a href="#4-3-2、解密assets-ms-com-sankuai-meituan" class="headerlink" title="4.3.2、解密assets/ms_com.sankuai.meituan"></a>4.3.2、解密assets/ms_com.sankuai.meituan</h3><p>组合密钥：<br>包名+常量字符(WU@TEN)+META-INF/SANKUAI.RSA(md5)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">com.sankuai.meituanWU@TEN638C81261479C2104EDE3F2518E91725</span><br></pre></td></tr></table></figure>

<p>将组合后的字符串加密Sha1值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">.text:C1D52AA4 F0 B5       PUSH            &#123;R4-R7,LR&#125;</span><br><span class="line">.text:C1D52AA6 03 AF       ADD             R7, SP, #0xC</span><br><span class="line">.text:C1D52AA8 8F B0       SUB             SP, SP, #0x3C</span><br><span class="line">.text:C1D52AAA 15 00       MOVS            R5, R2</span><br><span class="line">.text:C1D52AAC 0E 00       MOVS            R6, R1</span><br><span class="line">.text:C1D52AAE 02 90       STR             R0, [SP,#0x48+var_40]</span><br><span class="line">.text:C1D52AB0 1A 48       LDR             R0, =(__stack_chk_guard_ptr - 0xC1D52AB6)</span><br><span class="line">.text:C1D52AB2 78 44       ADD             R0, PC                  ; __stack_chk_guard_ptr</span><br><span class="line">.text:C1D52AB4 04 68       LDR             R4, [R0]                ; __stack_chk_guard</span><br><span class="line">.text:C1D52AB6 20 68       LDR             R0, [R4]</span><br><span class="line">.text:C1D52AB8 0E 90       STR             R0, [SP,#0x48+var_10]</span><br><span class="line">.text:C1D52ABA 00 2E       CMP             R6, #0</span><br><span class="line">.text:C1D52ABC 1F D0       BEQ             loc_C1D52AFE</span><br><span class="line">.text:C1D52ABE 00 2D       CMP             R5, #0</span><br><span class="line">.text:C1D52AC0 1D D0       BEQ             loc_C1D52AFE</span><br><span class="line">.text:C1D52AC2 01 94       STR             R4, [SP,#0x48+var_44]</span><br><span class="line">.text:C1D52AC4 05 AC       ADD             R4, SP, #0x48+var_34</span><br><span class="line">.text:C1D52AC6 21 21       MOVS            R1, #0x21 ; &#x27;!&#x27;</span><br><span class="line">.text:C1D52AC8 20 00       MOVS            R0, R4</span><br><span class="line">.text:C1D52ACA F2 F7 26 E9 BLX             __aeabi_memclr4</span><br><span class="line">.text:C1D52ACE 30 00       MOVS            R0, R6</span><br><span class="line">.text:C1D52AD0 29 00       MOVS            R1, R5</span><br><span class="line">.text:C1D52AD2 22 00       MOVS            R2, R4</span><br><span class="line">.text:C1D52AD4 12 F0 8E FB BL              JMP_Sha1_256_sub_C6BB01F4 ; R0:原始值，R1：大小,R2:返回值</span><br><span class="line">.text:C1D52AD8 03 A8       ADD             R0, SP, #0x48+var_3C</span><br><span class="line">.text:C1D52ADA 20 22       MOVS            R2, #0x20 ; &#x27; &#x27;</span><br><span class="line">.text:C1D52ADC 21 00       MOVS            R1, R4</span><br><span class="line">.text:C1D52ADE 01 9C       LDR             R4, [SP,#0x48+var_44]</span><br><span class="line">.text:C1D52AE0 FF F7 72 FF BL              Hex2String_sub_C6B9D9C8 ; R1:返回值，R2：大小</span><br><span class="line">.text:C1D52AE4 03 98       LDR             R0, [SP,#0x48+var_3C]</span><br><span class="line">.text:C1D52AE6 02 99       LDR             R1, [SP,#0x48+var_40]</span><br><span class="line">.text:C1D52AE8 08 60       STR             R0, [R1]</span><br><span class="line">.text:C1D52AEA 0D 48       LDR             R0, =(off_C1DD8C48 - 0xC1D52AF0)</span><br><span class="line">.text:C1D52AEC 78 44       ADD             R0, PC                  ; off_C1DD8C48</span><br><span class="line">.text:C1D52AEE 00 68       LDR             R0, [R0]                ; dword_C1DEAADC</span><br><span class="line">.text:C1D52AF0 01 00       MOVS            R1, R0</span><br><span class="line">.text:C1D52AF2 0C 31       ADDS            R1, #0xC</span><br><span class="line">.text:C1D52AF4 03 91       STR             R1, [SP,#0x48+var_3C]</span><br><span class="line">.text:C1D52AF6 04 A9       ADD             R1, SP, #0x48+var_38</span><br><span class="line">.text:C1D52AF8 6B F0 26 FE BL              free_sub_B2943748</span><br></pre></td></tr></table></figure>

<p>加密后的值为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//该值为解密assets/ms_com.sankuai.meituan的密钥</span><br><span class="line">69fe5963f3b95d9718c8d3e4f924ad9379500e9b51d80686e65347890e1748fe</span><br></pre></td></tr></table></figure>

<p>读取资源文件assets/ms_com.sankuai.meituan</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __fastcall <span class="title">ReadFile_unzip_sub_C6BAE74C</span><span class="params">(<span class="keyword">int</span> *a1, <span class="keyword">int</span> a2, <span class="keyword">int</span> a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// r0</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// r5</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// r0</span></span><br><span class="line">  <span class="keyword">int</span> v8; <span class="comment">// r6</span></span><br><span class="line">  <span class="keyword">int</span> v9; <span class="comment">// r5</span></span><br><span class="line">  <span class="keyword">int</span> v10; <span class="comment">// r0</span></span><br><span class="line">  __int64 v13; <span class="comment">// [sp+24h] [bp-28h] BYREF</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v14; <span class="comment">// [sp+30h] [bp-1Ch] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v15; <span class="comment">// [sp+34h] [bp-18h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v16; <span class="comment">// [sp+38h] [bp-14h] BYREF</span></span><br><span class="line"> </span><br><span class="line">  v5 = a2 - <span class="number">10000</span>;</span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( a2 &gt;= <span class="number">10000</span> &amp;&amp; v5 &lt; a1[<span class="number">8</span>] )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( *(_DWORD *)(a1[<span class="number">9</span>] + <span class="number">8</span> * v5) )</span><br><span class="line">    &#123;</span><br><span class="line">      v6 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">if</span> ( <span class="built_in">read_sub_C6BAE448</span>(a1, a2, &amp;v16, &amp;v15, (<span class="keyword">int</span> *)&amp;v14, &amp;v13, <span class="number">0</span>, <span class="number">0</span>) )</span><br><span class="line">      &#123;</span><br><span class="line">        v7 = <span class="built_in">mapfile_sub_C6BAE6C0</span>(a1, a2);</span><br><span class="line">        v8 = v7;</span><br><span class="line">        <span class="keyword">if</span> ( v7 )</span><br><span class="line">        &#123;</span><br><span class="line">          v9 = *(_DWORD *)(v7 + <span class="number">24</span>);</span><br><span class="line">          <span class="keyword">if</span> ( v14 &gt; <span class="number">0x8000</span> )</span><br><span class="line">            <span class="built_in">sub_C1D62E3C</span>(v7, <span class="number">2</span>);</span><br><span class="line">          <span class="keyword">if</span> ( v16 )</span><br><span class="line">          &#123;</span><br><span class="line">            v10 = <span class="built_in">unzip_sub_C6BAE820</span>(a3, v9, v15, v14);</span><br><span class="line">            v6 = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span> ( !v10 )</span><br><span class="line">            &#123;</span><br><span class="line">LABEL_15:</span><br><span class="line">              <span class="built_in">free_sub_CA79DF8C</span>(v8);</span><br><span class="line">              <span class="keyword">return</span> v6;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span></span><br><span class="line">          &#123;</span><br><span class="line">            <span class="built_in">getvalu_sub_C87B550A</span>(a3, v9, v15);</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> ( v14 &gt; <span class="number">0x8000</span> )</span><br><span class="line">            <span class="built_in">sub_C1D62E3C</span>(v8, <span class="number">0</span>);</span><br><span class="line">          v6 = <span class="number">1</span>;</span><br><span class="line">          <span class="keyword">goto</span> LABEL_15;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v6;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>读取后内容(部分)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">BCF4A000  89 50 4E 47 0D 0A 1A 0A  00 00 00 0D 49 48 44 52  .PNG........IHDR</span><br><span class="line">BCF4A010  00 00 00 3C 00 00 00 3C  08 06 00 00 00 3A FC D9  ...&lt;...&lt;.....:..</span><br><span class="line">BCF4A020  72 00 00 13 56 49 44 41  54 78 DA ED 5A 79 70 55  r...VIDATx..ZypU</span><br><span class="line">BCF4A030  D7 79 BF 42 AC C6 80 09  5E 00 DB 98 5D E0 64 92  ...B.ƀ .^...]...</span><br><span class="line">BCF4A040  4E 92 76 6C 37 EE 4C 26  4D 5D A7 6E DA 74 49 26  N.vl7...M].n..I&amp;</span><br><span class="line">BCF4A050  53 B7 C9 8C FF 68 DC 75  9C DA 1D D7 F5 C4 4E 13  S.Ɍ .h..........</span><br><span class="line">BCF4A060  63 D7 98 C5 80 36 90 90  D0 CA 62 83 84 D9 F4 F4  cט ŀ 6....b.....</span><br><span class="line">BCF4A070  16 BD 4D CB D3 BE 20 24  10 9B 10 12 9B 04 48 08  ..M... $......H.</span><br><span class="line">BCF4A080  B4 DE 5F 7F E7 DC E5 9D  FB 24 40 24 B6 EB E9 F4  .........$@$....</span><br></pre></td></tr></table></figure>

<p>解析解密图片得到PIC数据</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __fastcall <span class="title">ParsePng_sub_CB4C8858</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="keyword">int</span> *a1,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="keyword">unsigned</span> <span class="keyword">int</span> *a2,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="keyword">unsigned</span> <span class="keyword">int</span> *a3,</span></span></span><br><span class="line"><span class="params"><span class="function">        _DWORD *a4,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="keyword">unsigned</span> <span class="keyword">int</span> data,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="keyword">unsigned</span> <span class="keyword">int</span> a6)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> *v54; <span class="comment">// r4</span></span><br><span class="line">  <span class="keyword">void</span> *v55; <span class="comment">// r0</span></span><br><span class="line">  <span class="built_in"><span class="keyword">int</span></span> (__fastcall *v56)(<span class="keyword">void</span> **, <span class="keyword">int</span> *, <span class="keyword">unsigned</span> __int8 *, <span class="keyword">unsigned</span> <span class="keyword">int</span>, _DWORD *);</span><br><span class="line">  v7 = <span class="number">0</span>;</span><br><span class="line">  *a1 = <span class="number">0</span>;</span><br><span class="line">  *a3 = <span class="number">0</span>;</span><br><span class="line">  *a2 = <span class="number">0</span>;</span><br><span class="line">  result = <span class="built_in">CRC32_sub_CB4C7D08</span>((<span class="keyword">int</span> *)a2, (<span class="keyword">int</span> *)a3, a4, (<span class="keyword">unsigned</span> __int8 *)data, a6);</span><br><span class="line">  a4[<span class="number">92</span>] = result;</span><br><span class="line">  <span class="keyword">if</span> ( result )</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  v110 = a4 + <span class="number">92</span>;</span><br><span class="line">  v9 = a4[<span class="number">39</span>];</span><br><span class="line">  v10 = a4[<span class="number">38</span>];</span><br><span class="line">  v135 = a4 + <span class="number">39</span>;</span><br><span class="line">  v104 = a4 + <span class="number">38</span>;</span><br><span class="line">  v108 = a4;</span><br><span class="line">  v131 = a4 + <span class="number">35</span>;</span><br><span class="line">  v148 = (<span class="keyword">void</span> *)*a3;</span><br><span class="line">  v11 = *a2;</span><br><span class="line">  v12 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v10 &lt;= <span class="number">6</span> )</span><br><span class="line">    v12 = dword_C1DD1C40[v10];</span><br><span class="line">  v13 = v12 * v9;</span><br><span class="line">  v14 = v108[<span class="number">27</span>];</span><br><span class="line">  v15 = v108[<span class="number">28</span>];</span><br><span class="line">  <span class="keyword">if</span> ( v14 &lt;= <span class="number">6</span> )</span><br><span class="line">    v7 = dword_C1DD1C40[v14];</span><br><span class="line">  <span class="keyword">if</span> ( v13 &lt;= v7 * v15 )</span><br><span class="line">  &#123;</span><br><span class="line">    v18 = <span class="number">0</span>;</span><br><span class="line">    v17 = *a3;</span><br><span class="line">    <span class="keyword">if</span> ( v14 &lt;= <span class="number">6</span> )</span><br><span class="line">      v18 = dword_C1DD1C40[v14];</span><br><span class="line">    v143 = v15 * v18;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v16 = <span class="number">0</span>;</span><br><span class="line">    v17 = *a3;</span><br><span class="line">    <span class="keyword">if</span> ( v10 &lt;= <span class="number">6</span> )</span><br><span class="line">      v16 = dword_C1DD1C40[v10];</span><br><span class="line">    v143 = v9 * v16;</span><br><span class="line">  &#125;</span><br><span class="line">  v19 = v11 * v17;</span><br><span class="line">  v20 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v11 )</span><br><span class="line">  &#123;</span><br><span class="line">    v21 = <span class="built_in">to1028_sub_CA812FD0</span>(v11 * v17, v11);</span><br><span class="line">    v20 = <span class="number">0</span>;</span><br><span class="line">    v17 = (<span class="keyword">unsigned</span> <span class="keyword">int</span>)v148;</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="keyword">void</span> *)v21 != v148 )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_125;</span><br><span class="line">    <span class="keyword">if</span> ( v19 )</span><br><span class="line">    &#123;</span><br><span class="line">      v22 = <span class="built_in">to1028_sub_CA812FD0</span>(<span class="number">8</span> * v19, v19);</span><br><span class="line">      v20 = <span class="number">0</span>;</span><br><span class="line">      v17 = (<span class="keyword">unsigned</span> <span class="keyword">int</span>)v148;</span><br><span class="line">      <span class="keyword">if</span> ( v22 != <span class="number">8</span> )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v11 &gt;&gt; <span class="number">3</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v23 = <span class="built_in">to1028_sub_CA812FD0</span>((v11 &gt;&gt; <span class="number">3</span>) * v143, v11 &gt;&gt; <span class="number">3</span>);</span><br><span class="line">      v17 = (<span class="keyword">unsigned</span> <span class="keyword">int</span>)v148;</span><br><span class="line">      v20 = (v11 &gt;&gt; <span class="number">3</span>) * v143;</span><br><span class="line">      <span class="keyword">if</span> ( v23 != v143 )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  v24 = v20 + (((v11 &amp; <span class="number">7</span>) * v143 + <span class="number">7</span>) &gt;&gt; <span class="number">3</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v24 &lt; v20 || v24 &gt; <span class="number">0xFFFFFFFA</span> || <span class="built_in">to1028_sub_CA812FD0</span>(v17 * (v24 + <span class="number">5</span>), v24 + <span class="number">5</span>) != v17 )</span><br><span class="line">  &#123;</span><br><span class="line">LABEL_125:</span><br><span class="line">    result = <span class="number">92</span>;</span><br><span class="line">    *v110 = <span class="number">92</span>;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line">  v25 = v108;</span><br><span class="line">  v111 = v108 + <span class="number">1</span>;</span><br><span class="line">  v26 = (<span class="keyword">unsigned</span> __int8 *)(data + <span class="number">33</span>);</span><br><span class="line">  pdata = <span class="number">0</span>;</span><br><span class="line">  v129 = <span class="number">0</span>;</span><br><span class="line">  v119 = <span class="number">0</span>;</span><br><span class="line">  v116 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v27 = (<span class="keyword">unsigned</span> <span class="keyword">int</span>)&amp;v26[-data + <span class="number">12</span>];</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> <span class="keyword">int</span>)v26 &lt; data || v27 &gt; a6 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v25[<span class="number">7</span>] )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_136;</span><br><span class="line">      v44 = <span class="number">30</span>;</span><br><span class="line">      <span class="keyword">goto</span> LABEL_132;</span><br><span class="line">    &#125;</span><br><span class="line">    v144 = v26;</span><br><span class="line">    v28 = v26;</span><br><span class="line">    v29 = _byteswap_ulong(*(_DWORD *)v26);</span><br><span class="line">    v30 = v110;</span><br><span class="line">    <span class="keyword">if</span> ( v29 &lt; <span class="number">0</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v25 = v108;</span><br><span class="line">      <span class="keyword">if</span> ( v108[<span class="number">7</span>] )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_136;</span><br><span class="line">      v44 = <span class="number">63</span>;</span><br><span class="line">      <span class="keyword">goto</span> LABEL_133;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v29 + v27 &gt; a6 || (<span class="keyword">unsigned</span> <span class="keyword">int</span>)&amp;v26[v29 + <span class="number">12</span>] &lt; data )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    v31 = v26 + <span class="number">8</span>;</span><br><span class="line">    <span class="keyword">if</span> ( !byte_C1DEAAB4 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">DecString</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)byte_C1DE8374, aXpvn, <span class="number">17</span>, <span class="number">4</span>);</span><br><span class="line">      v28 = v144;</span><br><span class="line">      byte_C1DE8378 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    byte_C1DEAAB4 = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">getIHDR_sub_CCBFBBC8</span>(v28, byte_C1DE8374) )</span><br><span class="line">    &#123;</span><br><span class="line">      v32 = v29 + v129;</span><br><span class="line">      <span class="keyword">if</span> ( v29 + v129 &lt; v29 )</span><br><span class="line">      &#123;</span><br><span class="line">        v43 = <span class="number">95</span>;</span><br><span class="line">        <span class="keyword">goto</span> LABEL_134;</span><br><span class="line">      &#125;</span><br><span class="line">      v122 = v29 + v129;</span><br><span class="line">      <span class="keyword">if</span> ( v119 &gt;= v32 )</span><br><span class="line">      &#123;</span><br><span class="line">        v34 = (<span class="keyword">int</span>)pdata;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        v33 = v29 + v129;</span><br><span class="line">        <span class="keyword">if</span> ( v32 &lt;= <span class="number">2</span> * v119 )</span><br><span class="line">          v33 = (<span class="number">3</span> * v32) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        v119 = v33;</span><br><span class="line">        v34 = <span class="built_in">realloc</span>(pdata);</span><br><span class="line">        <span class="keyword">if</span> ( !v34 )</span><br><span class="line">        &#123;</span><br><span class="line">          v43 = <span class="number">83</span>;</span><br><span class="line">          <span class="keyword">goto</span> LABEL_134;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      v35 = <span class="number">0</span>;</span><br><span class="line">      v116 = <span class="number">3</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v29 )</span><br><span class="line">      &#123;</span><br><span class="line">        v37 = v129;</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">          *(_BYTE *)(v34 + v37) = *v31++;</span><br><span class="line">          --v29;</span><br><span class="line">          ++v37;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> ( v29 );</span><br><span class="line">      &#125;</span><br><span class="line">      v129 = v122;</span><br><span class="line">      pdata = (<span class="keyword">unsigned</span> __int8 *)v34;</span><br><span class="line">      <span class="keyword">goto</span> LABEL_50;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( !byte_C1DEAAB5 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">DecString</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)byte_C1DE8379, aPv, <span class="number">18</span>, <span class="number">4</span>);</span><br><span class="line">      byte_C1DE837D = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    v35 = <span class="number">1</span>;</span><br><span class="line">    byte_C1DEAAB5 = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">getIHDR_sub_CCBFBBC8</span>(v144, byte_C1DE8379) )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_50;</span><br><span class="line">    <span class="keyword">if</span> ( !byte_C1DEAAA8 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">DecString</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)byte_C1DE8338, aSjI, <span class="number">3</span>, <span class="number">4</span>);</span><br><span class="line">      unk_C1DE833C = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    byte_C1DEAAA8 = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">getIHDR_sub_CCBFBBC8</span>(v144, byte_C1DE8338) )</span><br><span class="line">    &#123;</span><br><span class="line">      v36 = <span class="built_in">dec_sub_CA801FF0</span>(v104, v31, v29);</span><br><span class="line">      *v110 = v36;</span><br><span class="line">      v35 = <span class="number">0</span>;</span><br><span class="line">      v116 = <span class="number">2</span>;</span><br><span class="line">LABEL_67:</span><br><span class="line">      v25 = v108;</span><br><span class="line">      v38 = (<span class="keyword">unsigned</span> <span class="keyword">int</span> *)v144;</span><br><span class="line">      <span class="keyword">if</span> ( v36 )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_136;</span><br><span class="line">LABEL_51:</span><br><span class="line">      <span class="keyword">if</span> ( !v25[<span class="number">5</span>] )</span><br><span class="line">      &#123;</span><br><span class="line">        v39 = <span class="built_in">gencrc_sub_CA800C08</span>(v38);</span><br><span class="line">        v38 = (<span class="keyword">unsigned</span> <span class="keyword">int</span> *)v144;</span><br><span class="line">        <span class="keyword">if</span> ( v39 )</span><br><span class="line">        &#123;</span><br><span class="line">          v44 = <span class="number">57</span>;</span><br><span class="line">LABEL_132:</span><br><span class="line">          v30 = v110;</span><br><span class="line">LABEL_133:</span><br><span class="line">          *v30 = v44;</span><br><span class="line">          <span class="keyword">goto</span> LABEL_136;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( v35 )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_136;</span><br><span class="line">LABEL_55:</span><br><span class="line">      v40 = *v110;</span><br><span class="line">      <span class="keyword">goto</span> LABEL_56;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( !byte_C1DEAAA9 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">DecString</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)byte_C1DE833D, aPud, <span class="number">4</span>, <span class="number">4</span>);</span><br><span class="line">      byte_C1DE8341 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    byte_C1DEAAA9 = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">getIHDR_sub_CCBFBBC8</span>(v144, byte_C1DE833D) )</span><br><span class="line">    &#123;</span><br><span class="line">      v36 = <span class="built_in">sub_C1DB9080</span>(v104, v31, v29);</span><br><span class="line">LABEL_66:</span><br><span class="line">      *v110 = v36;</span><br><span class="line">      v35 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">goto</span> LABEL_67;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( !byte_C1DEAAAA )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">DecString</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)byte_C1DE8342, aGclj, <span class="number">5</span>, <span class="number">4</span>);</span><br><span class="line">      byte_C1DE8346 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    byte_C1DEAAAA = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">getIHDR_sub_CCBFBBC8</span>(v144, byte_C1DE8342) )</span><br><span class="line">    &#123;</span><br><span class="line">      v36 = <span class="built_in">sub_C1DB9100</span>(v131, v31, v29);</span><br><span class="line">      <span class="keyword">goto</span> LABEL_66;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( !byte_C1DEAAAB )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">DecString</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)byte_C1DE8347, aRlt, <span class="number">6</span>, <span class="number">4</span>);</span><br><span class="line">      byte_C1DE834B = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    byte_C1DEAAAB = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">getIHDR_sub_CCBFBBC8</span>(v144, byte_C1DE8347) )</span><br><span class="line">    &#123;</span><br><span class="line">      v35 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v108[<span class="number">9</span>] )</span><br><span class="line">      &#123;</span><br><span class="line">        v36 = <span class="built_in">sub_C1DB917C</span>((<span class="keyword">int</span>)v131, v31, v29);</span><br><span class="line">LABEL_79:</span><br><span class="line">        *v110 = v36;</span><br><span class="line">        <span class="keyword">goto</span> LABEL_67;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">goto</span> LABEL_50;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( !byte_C1DEAAAC )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">DecString</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)byte_C1DE834C, aUd, <span class="number">7</span>, <span class="number">4</span>);</span><br><span class="line">      byte_C1DE8350 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    byte_C1DEAAAC = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">getIHDR_sub_CCBFBBC8</span>(v144, byte_C1DE834C) )</span><br><span class="line">    &#123;</span><br><span class="line">      v35 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v108[<span class="number">9</span>] )</span><br><span class="line">      &#123;</span><br><span class="line">        v36 = <span class="built_in">sub_C1DB923C</span>(v131, v111, v31, v29);</span><br><span class="line">        <span class="keyword">goto</span> LABEL_79;</span><br><span class="line">      &#125;</span><br><span class="line">LABEL_50:</span><br><span class="line">      v25 = v108;</span><br><span class="line">      v38 = (<span class="keyword">unsigned</span> <span class="keyword">int</span> *)v144;</span><br><span class="line">      <span class="keyword">goto</span> LABEL_51;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( !byte_C1DEAAAD )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">DecString</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)byte_C1DE8351, aAVe, <span class="number">8</span>, <span class="number">4</span>);</span><br><span class="line">      byte_C1DE8355 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    byte_C1DEAAAD = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">getIHDR_sub_CCBFBBC8</span>(v144, byte_C1DE8351) )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v108[<span class="number">9</span>] )</span><br><span class="line">      &#123;</span><br><span class="line">        v41 = <span class="built_in">sub_C1DB936C</span>(v131, v111, v31, v29);</span><br><span class="line">        *v110 = v41;</span><br><span class="line">        v25 = v108;</span><br><span class="line">        v38 = (<span class="keyword">unsigned</span> <span class="keyword">int</span> *)v144;</span><br><span class="line">        v35 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> ( v41 )</span><br><span class="line">          <span class="keyword">goto</span> LABEL_136;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        v25 = v108;</span><br><span class="line">        v38 = (<span class="keyword">unsigned</span> <span class="keyword">int</span> *)v144;</span><br><span class="line">        v35 = <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">goto</span> LABEL_51;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( !byte_C1DEAAAE )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">DecString</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)byte_C1DE8356, aEbw, <span class="number">9</span>, <span class="number">4</span>);</span><br><span class="line">      unk_C1DE835A = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    byte_C1DEAAAE = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">getIHDR_sub_CCBFBBC8</span>(v144, byte_C1DE8356) )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v29 != <span class="number">7</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v43 = <span class="number">73</span>;</span><br><span class="line">LABEL_134:</span><br><span class="line">        v30 = v110;</span><br><span class="line">        <span class="keyword">goto</span> LABEL_135;</span><br><span class="line">      &#125;</span><br><span class="line">      v108[<span class="number">58</span>] = <span class="number">1</span>;</span><br><span class="line">      v38 = (<span class="keyword">unsigned</span> <span class="keyword">int</span> *)v144;</span><br><span class="line">      v108[<span class="number">59</span>] = (v144[<span class="number">8</span>] &lt;&lt; <span class="number">8</span>) | v144[<span class="number">9</span>];</span><br><span class="line">      v108[<span class="number">60</span>] = v144[<span class="number">10</span>];</span><br><span class="line">      v108[<span class="number">61</span>] = v144[<span class="number">11</span>];</span><br><span class="line">      v108[<span class="number">62</span>] = v144[<span class="number">12</span>];</span><br><span class="line">      v108[<span class="number">63</span>] = v144[<span class="number">13</span>];</span><br><span class="line">      v108[<span class="number">64</span>] = v144[<span class="number">14</span>];</span><br><span class="line">LABEL_92:</span><br><span class="line">      v35 = <span class="number">0</span>;</span><br><span class="line">      *v110 = <span class="number">0</span>;</span><br><span class="line">      v25 = v108;</span><br><span class="line">      <span class="keyword">goto</span> LABEL_51;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( !byte_C1DEAAAF )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">DecString</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)byte_C1DE835B, aZei, <span class="number">10</span>, <span class="number">4</span>);</span><br><span class="line">      unk_C1DE835F = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    byte_C1DEAAAF = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">getIHDR_sub_CCBFBBC8</span>(v144, byte_C1DE835B) )</span><br><span class="line">    &#123;</span><br><span class="line">      v36 = <span class="built_in">sub_C1DB95FC</span>(v131, (<span class="keyword">int</span>)v31, v29);</span><br><span class="line">      <span class="keyword">goto</span> LABEL_66;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( !byte_C1DEAAB0 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">DecString</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)byte_C1DE8360, aLoU, <span class="number">11</span>, <span class="number">4</span>);</span><br><span class="line">      unk_C1DE8364 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    byte_C1DEAAB0 = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">getIHDR_sub_CCBFBBC8</span>(v144, byte_C1DE8360) )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v29 != <span class="number">4</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v43 = <span class="number">96</span>;</span><br><span class="line">        <span class="keyword">goto</span> LABEL_134;</span><br><span class="line">      &#125;</span><br><span class="line">      v108[<span class="number">69</span>] = <span class="number">1</span>;</span><br><span class="line">      v38 = (<span class="keyword">unsigned</span> <span class="keyword">int</span> *)v144;</span><br><span class="line">      v108[<span class="number">70</span>] = _byteswap_ulong(*((_DWORD *)v144 + <span class="number">2</span>));</span><br><span class="line">      <span class="keyword">goto</span> LABEL_92;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( !byte_C1DEAAB1 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">DecString</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)byte_C1DE8365, aOgX, <span class="number">12</span>, <span class="number">4</span>);</span><br><span class="line">      unk_C1DE8369 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    byte_C1DEAAB1 = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">getIHDR_sub_CCBFBBC8</span>(v144, byte_C1DE8365) )</span><br><span class="line">    &#123;</span><br><span class="line">      v36 = <span class="built_in">sub_C1DB9640</span>(v131, (<span class="keyword">unsigned</span> <span class="keyword">int</span> *)v31, v29);</span><br><span class="line">      <span class="keyword">goto</span> LABEL_66;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( !byte_C1DEAAB2 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">DecString</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)byte_C1DE836A, aBtt, <span class="number">13</span>, <span class="number">4</span>);</span><br><span class="line">      unk_C1DE836E = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    byte_C1DEAAB2 = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">getIHDR_sub_CCBFBBC8</span>(v144, byte_C1DE836A) )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v29 != <span class="number">1</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v43 = <span class="number">98</span>;</span><br><span class="line">        <span class="keyword">goto</span> LABEL_134;</span><br><span class="line">      &#125;</span><br><span class="line">      v108[<span class="number">80</span>] = <span class="number">1</span>;</span><br><span class="line">      v108[<span class="number">81</span>] = *v31;</span><br><span class="line">      v35 = <span class="number">0</span>;</span><br><span class="line">      *v110 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">goto</span> LABEL_50;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( !byte_C1DEAAB3 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">DecString</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)byte_C1DE836F, aGrwg, <span class="number">14</span>, <span class="number">4</span>);</span><br><span class="line">      unk_C1DE8373 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    byte_C1DEAAB3 = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">getIHDR_sub_CCBFBBC8</span>(v144, byte_C1DE836F) )</span><br><span class="line">    &#123;</span><br><span class="line">      v36 = <span class="built_in">sub_C1DB9714</span>(v131, v111, v31, v29);</span><br><span class="line">      <span class="keyword">goto</span> LABEL_66;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( !v108[<span class="number">6</span>] &amp;&amp; (v144[<span class="number">4</span>] &amp; <span class="number">0x20</span>) == <span class="number">0</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v43 = <span class="number">69</span>;</span><br><span class="line">      <span class="keyword">goto</span> LABEL_134;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( !v108[<span class="number">10</span>] )</span><br><span class="line">    &#123;</span><br><span class="line">      v25 = v108;</span><br><span class="line">      v38 = (<span class="keyword">unsigned</span> <span class="keyword">int</span> *)v144;</span><br><span class="line">      <span class="keyword">goto</span> LABEL_55;</span><br><span class="line">    &#125;</span><br><span class="line">    v25 = v108;</span><br><span class="line">    v42 = <span class="built_in">sub_C1DB7CCE</span>(&amp;v108[v116 + <span class="number">85</span>], &amp;v108[v116 + <span class="number">88</span>], (<span class="keyword">unsigned</span> <span class="keyword">int</span> *)v144);</span><br><span class="line">    v38 = (<span class="keyword">unsigned</span> <span class="keyword">int</span> *)v144;</span><br><span class="line">    *v110 = v42;</span><br><span class="line">    v40 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v42 )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_136;</span><br><span class="line">LABEL_56:</span><br><span class="line">    v26 = <span class="built_in">isPng_sub_CA800C80</span>((<span class="keyword">unsigned</span> __int8 *)v38);</span><br><span class="line">    <span class="keyword">if</span> ( v40 )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_136;</span><br><span class="line">  &#125;</span><br><span class="line">  v43 = <span class="number">64</span>;</span><br><span class="line">LABEL_135:</span><br><span class="line">  *v30 = v43;</span><br><span class="line">  v25 = v108;</span><br><span class="line">LABEL_136:</span><br><span class="line">  v154 = <span class="number">0</span>;</span><br><span class="line">  v152 = <span class="number">0</span>;</span><br><span class="line">  v153 = <span class="number">0</span>;</span><br><span class="line">  v45 = v25[<span class="number">37</span>];</span><br><span class="line">  v123 = v25 + <span class="number">37</span>;</span><br><span class="line">  v46 = *a2;</span><br><span class="line">  <span class="keyword">if</span> ( v45 )</span><br><span class="line">  &#123;</span><br><span class="line">    v145 = *a3;</span><br><span class="line">    v47 = (*a3 + <span class="number">7</span>) &gt;&gt; <span class="number">3</span>;</span><br><span class="line">    v140 = <span class="built_in">sub_C1DBAC4C</span>((v46 + <span class="number">7</span>) &gt;&gt; <span class="number">3</span>, v47, (<span class="keyword">unsigned</span> <span class="keyword">int</span> *)v104);</span><br><span class="line">    v48 = v46 + <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v46 &gt;= <span class="number">5</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v49 = <span class="built_in">sub_C1DBAC4C</span>(v48 &gt;&gt; <span class="number">3</span>, v47, (<span class="keyword">unsigned</span> <span class="keyword">int</span> *)v104) + v140;</span><br><span class="line">      v48 = v46 + <span class="number">3</span>;</span><br><span class="line">      v140 = v49;</span><br><span class="line">    &#125;</span><br><span class="line">    v50 = <span class="built_in">sub_C1DBAC4C</span>(v48 &gt;&gt; <span class="number">2</span>, (v145 + <span class="number">3</span>) &gt;&gt; <span class="number">3</span>, (<span class="keyword">unsigned</span> <span class="keyword">int</span> *)v104) + v140;</span><br><span class="line">    v51 = v46 + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v46 &gt;= <span class="number">3</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v50 += <span class="built_in">sub_C1DBAC4C</span>(v51 &gt;&gt; <span class="number">2</span>, (v145 + <span class="number">3</span>) &gt;&gt; <span class="number">2</span>, (<span class="keyword">unsigned</span> <span class="keyword">int</span> *)v104);</span><br><span class="line">      v51 = v46 + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    v52 = <span class="built_in">sub_C1DBAC4C</span>(v51 &gt;&gt; <span class="number">1</span>, (v145 + <span class="number">1</span>) &gt;&gt; <span class="number">2</span>, (<span class="keyword">unsigned</span> <span class="keyword">int</span> *)v104) + v50;</span><br><span class="line">    <span class="keyword">if</span> ( v46 &gt;= <span class="number">2</span> )</span><br><span class="line">      v52 += <span class="built_in">sub_C1DBAC4C</span>(v46 &gt;&gt; <span class="number">1</span>, (v145 + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, (<span class="keyword">unsigned</span> <span class="keyword">int</span> *)v104);</span><br><span class="line">    v53 = <span class="built_in">sub_C1DBAC4C</span>(v46, v145 &gt;&gt; <span class="number">1</span>, (<span class="keyword">unsigned</span> <span class="keyword">int</span> *)v104) + v52;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v53 = <span class="built_in">sub_C1DBAC4C</span>(*a2, *a3, (<span class="keyword">unsigned</span> <span class="keyword">int</span> *)v104);</span><br><span class="line">  &#125;</span><br><span class="line">  v54 = v110;</span><br><span class="line">  <span class="keyword">if</span> ( !*v110 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( !v53 )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_149;</span><br><span class="line">    v55 = (<span class="keyword">void</span> *)<span class="built_in">realloc</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> ( !v55 )</span><br><span class="line">    &#123;</span><br><span class="line">      v57 = <span class="number">83</span>;</span><br><span class="line">      <span class="keyword">goto</span> LABEL_157;</span><br><span class="line">    &#125;</span><br><span class="line">    v152 = v55;</span><br><span class="line">    v154 = v53;</span><br><span class="line">    <span class="keyword">if</span> ( !*v110 )</span><br><span class="line">    &#123;</span><br><span class="line">LABEL_149:</span><br><span class="line">      v56 = (<span class="built_in"><span class="keyword">int</span></span> (__fastcall *)(<span class="keyword">void</span> **, <span class="keyword">int</span> *, <span class="keyword">unsigned</span> __int8 *, <span class="keyword">unsigned</span> <span class="keyword">int</span>, _DWORD *))v108[<span class="number">2</span>];</span><br><span class="line">      <span class="keyword">if</span> ( v56 )</span><br><span class="line">        v57 = <span class="built_in">v56</span>(&amp;v152, &amp;v153, pdata, v129, v111);</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        v57 = <span class="built_in">sub_C1DB7A98</span>(&amp;v152, &amp;v153, pdata, v129, v111);</span><br><span class="line">      v58 = v57;</span><br><span class="line">      v54 = v110;</span><br><span class="line">      <span class="keyword">if</span> ( v153 != v53 )</span><br><span class="line">        v58 = <span class="number">91</span>;</span><br><span class="line">      <span class="keyword">if</span> ( !v57 )</span><br><span class="line">        v57 = v58;</span><br><span class="line">LABEL_157:</span><br><span class="line">      *v54 = v57;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">free</span>(pdata);</span><br><span class="line">  <span class="keyword">if</span> ( !*v54 )</span><br><span class="line">  &#123;</span><br><span class="line">    v59 = *v135;</span><br><span class="line">    v107 = *a2;</span><br><span class="line">    v132 = *a3;</span><br><span class="line">    v146 = *v104;</span><br><span class="line">    v60 = <span class="built_in">sub_C1DB7DA4</span>(*a2, *a3, *v104, *v135);</span><br><span class="line">    v61 = <span class="built_in">malloc</span>(v60);</span><br><span class="line">    *a1 = v61;</span><br><span class="line">    v62 = <span class="number">83</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v61 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v60 )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">for</span> ( i = <span class="number">0</span>; i != v60; ++i )</span><br><span class="line">        &#123;</span><br><span class="line">          *(_BYTE *)(v61 + i) = <span class="number">0</span>;</span><br><span class="line">          v61 = *a1;</span><br><span class="line">        &#125;</span><br><span class="line">        v64 = v108[<span class="number">38</span>];</span><br><span class="line">        v59 = *v135;</span><br><span class="line">        v132 = *a3;</span><br><span class="line">        v107 = *a2;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        v64 = v146;</span><br><span class="line">      &#125;</span><br><span class="line">      v147 = (<span class="keyword">char</span> *)v152;</span><br><span class="line">      v65 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v64 &lt;= <span class="number">6</span> )</span><br><span class="line">        v65 = dword_C1DD1C40[v64];</span><br><span class="line">      v66 = v59 * v65;</span><br><span class="line">      v62 = <span class="number">31</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v66 )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( *v123 )</span><br><span class="line">        &#123;</span><br><span class="line">          v139 = v61;</span><br><span class="line">          <span class="built_in">sub_C1DBAF5C</span>(v159, v158, v157, v156, v155, v107, v132, v66);</span><br><span class="line">          v67 = <span class="number">0</span>;</span><br><span class="line">          <span class="keyword">do</span></span><br><span class="line">          &#123;</span><br><span class="line">            v68 = *(_DWORD *)&amp;v158[v67];</span><br><span class="line">            v141 = v67;</span><br><span class="line">            v136 = &amp;v147[*(_DWORD *)&amp;v156[v67]];</span><br><span class="line">            v69 = *(_DWORD *)&amp;v159[v67];</span><br><span class="line">            v62 = <span class="built_in">sub_C1DBAC80</span>(v136);</span><br><span class="line">            <span class="keyword">if</span> ( v62 )</span><br><span class="line">            &#123;</span><br><span class="line">              v80 = <span class="number">0</span>;</span><br><span class="line">              v54 = v110;</span><br><span class="line">              <span class="keyword">goto</span> LABEL_206;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> ( v66 &lt;= <span class="number">7</span> )</span><br><span class="line">              <span class="built_in">sub_C1DBAECC</span>(&amp;v147[*(_DWORD *)&amp;v155[v141]], v136, v69 * v66, (v69 * v66 + <span class="number">7</span>) &amp; <span class="number">0xFFFFFFF8</span>, v68);</span><br><span class="line">            v67 = v141 + <span class="number">4</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">while</span> ( v141 != <span class="number">24</span> );</span><br><span class="line">          <span class="built_in">sub_C1DBAF5C</span>(v164, v163, v162, v161, v160, v107, v132, v66);</span><br><span class="line">          <span class="keyword">if</span> ( v66 &lt;= <span class="number">7</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            v81 = <span class="number">0</span>;</span><br><span class="line">            v118 = v66;</span><br><span class="line">            <span class="keyword">do</span></span><br><span class="line">            &#123;</span><br><span class="line">              v96 = v81;</span><br><span class="line">              v82 = v81;</span><br><span class="line">              v106 = v163[v82];</span><br><span class="line">              <span class="keyword">if</span> ( v106 )</span><br><span class="line">              &#123;</span><br><span class="line">                v134 = v164[v82];</span><br><span class="line">                v103 = &amp;dword_C1DD1BAC[v82];</span><br><span class="line">                v101 = (_DWORD *)((<span class="keyword">char</span> *)&amp;unk_C1DD1BC8 + v82 * <span class="number">4</span>);</span><br><span class="line">                v99 = &amp;dword_C1DD1BE4[v82];</span><br><span class="line">                v98 = &amp;dword_C1DD1C00[v82];</span><br><span class="line">                v97 = &amp;v160[v82 * <span class="number">4</span>];</span><br><span class="line">                <span class="keyword">for</span> ( j = <span class="number">0</span>; j != v106; ++j )</span><br><span class="line">                &#123;</span><br><span class="line">                  <span class="keyword">if</span> ( v134 )</span><br><span class="line">                  &#123;</span><br><span class="line">                    pdatab = (<span class="keyword">void</span> *)((*v99 * j + *v98) * v107 + *v101);</span><br><span class="line">                    v125 = *v103;</span><br><span class="line">                    v121 = <span class="number">8</span> * *(_DWORD *)v97;</span><br><span class="line">                    v83 = <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">do</span></span><br><span class="line">                    &#123;</span><br><span class="line">                      v84 = (v83 + v134 * j) * v66 + v121;</span><br><span class="line">                      v138 = v83;</span><br><span class="line">                      v85 = ((_DWORD)pdatab + v125 * v83) * v66;</span><br><span class="line">                      v86 = v66;</span><br><span class="line">                      <span class="keyword">do</span></span><br><span class="line">                      &#123;</span><br><span class="line">                        v87 = ((<span class="keyword">unsigned</span> __int8)v147[v84 &gt;&gt; <span class="number">3</span>] &gt;&gt; (~(_BYTE)v84 &amp; <span class="number">7</span>)) &amp; <span class="number">1</span>;</span><br><span class="line">                        ++v84;</span><br><span class="line">                        <span class="keyword">if</span> ( v87 )</span><br><span class="line">                          *(_BYTE *)(v139 + (v85 &gt;&gt; <span class="number">3</span>)) |= (_BYTE)v87 &lt;&lt; (~(_BYTE)v85 &amp; <span class="number">7</span>);</span><br><span class="line">                        --v86;</span><br><span class="line">                        ++v85;</span><br><span class="line">                      &#125;</span><br><span class="line">                      <span class="keyword">while</span> ( v86 );</span><br><span class="line">                      v83 = v138 + <span class="number">1</span>;</span><br><span class="line">                      v66 = v118;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">while</span> ( v138 + <span class="number">1</span> != v134 );</span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">              v81 = v96 + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">while</span> ( v96 != <span class="number">6</span> );</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span></span><br><span class="line">          &#123;</span><br><span class="line">            v70 = v66 &gt;&gt; <span class="number">3</span>;</span><br><span class="line">            v71 = <span class="number">0</span>;</span><br><span class="line">            v149 = v66 &gt;&gt; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">do</span></span><br><span class="line">            &#123;</span><br><span class="line">              v100 = v71;</span><br><span class="line">              v72 = v71;</span><br><span class="line">              pdataa = (<span class="keyword">void</span> *)v163[v71];</span><br><span class="line">              <span class="keyword">if</span> ( pdataa )</span><br><span class="line">              &#123;</span><br><span class="line">                v120 = &amp;dword_C1DD1BAC[v72];</span><br><span class="line">                v117 = (_DWORD *)((<span class="keyword">char</span> *)&amp;unk_C1DD1BC8 + v72 * <span class="number">4</span>);</span><br><span class="line">                v112 = &amp;dword_C1DD1BE4[v72];</span><br><span class="line">                v105 = &amp;dword_C1DD1C00[v72];</span><br><span class="line">                v102 = &amp;v160[v72 * <span class="number">4</span>];</span><br><span class="line">                v142 = v164[v71];</span><br><span class="line">                v124 = v142 * v70;</span><br><span class="line">                v133 = <span class="number">0</span>;</span><br><span class="line">                v130 = v147;</span><br><span class="line">                <span class="keyword">do</span></span><br><span class="line">                &#123;</span><br><span class="line">                  <span class="keyword">if</span> ( v142 )</span><br><span class="line">                  &#123;</span><br><span class="line">                    v73 = &amp;v130[*(_DWORD *)v102];</span><br><span class="line">                    v137 = *v120 * v70;</span><br><span class="line">                    v74 = (_BYTE *)(v139 + (*v117 + (*v105 + *v112 * (_DWORD)v133) * v107) * v70);</span><br><span class="line">                    <span class="keyword">for</span> ( k = <span class="number">0</span>; k != v142; ++k )</span><br><span class="line">                    &#123;</span><br><span class="line">                      <span class="keyword">if</span> ( v70 )</span><br><span class="line">                      &#123;</span><br><span class="line">                        v76 = v73;</span><br><span class="line">                        v77 = (<span class="keyword">char</span> *)v149;</span><br><span class="line">                        v78 = v74;</span><br><span class="line">                        <span class="keyword">do</span></span><br><span class="line">                        &#123;</span><br><span class="line">                          *v78 = *v76++;</span><br><span class="line">                          --v77;</span><br><span class="line">                          ++v78;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">while</span> ( v77 );</span><br><span class="line">                      &#125;</span><br><span class="line">                      v70 = v149;</span><br><span class="line">                      v73 += v149;</span><br><span class="line">                      v74 += v137;</span><br><span class="line">                    &#125;</span><br><span class="line">                  &#125;</span><br><span class="line">                  v130 += v124;</span><br><span class="line">                  v133 = (<span class="keyword">char</span> *)v133 + <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">while</span> ( v133 != pdataa );</span><br><span class="line">              &#125;</span><br><span class="line">              v71 = v100 + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">while</span> ( v100 != <span class="number">6</span> );</span><br><span class="line">          &#125;</span><br><span class="line">          v62 = <span class="number">0</span>;</span><br><span class="line">          v54 = v110;</span><br><span class="line">          v80 = <span class="number">1</span>;</span><br><span class="line">LABEL_206:</span><br><span class="line">          <span class="keyword">if</span> ( v80 )</span><br><span class="line">LABEL_207:</span><br><span class="line">            v62 = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ( v66 &gt; <span class="number">7</span> || (v79 = v107 * v66, v107 * v66 == ((v107 * v66 + <span class="number">7</span>) &amp; <span class="number">0xFFFFFFF8</span>)) )</span><br><span class="line">        &#123;</span><br><span class="line">          v62 = <span class="built_in">sub_C1DBAC80</span>(v61);</span><br><span class="line">          <span class="keyword">if</span> ( !v62 )</span><br><span class="line">            <span class="keyword">goto</span> LABEL_207;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          v151 = (<span class="keyword">void</span> *)((v107 * v66 + <span class="number">7</span>) &amp; <span class="number">0xFFFFFFF8</span>);</span><br><span class="line">          v95 = v61;</span><br><span class="line">          v62 = <span class="built_in">sub_C1DBAC80</span>(v152);</span><br><span class="line">          <span class="keyword">if</span> ( !v62 )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="built_in">sub_C1DBAECC</span>(v95, v147, v79, v151, v132);</span><br><span class="line">            <span class="keyword">goto</span> LABEL_207;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    *v54 = v62;</span><br><span class="line">  &#125;</span><br><span class="line">  v88 = <span class="number">0</span>;</span><br><span class="line">  v153 = <span class="number">0</span>;</span><br><span class="line">  v154 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">free</span>(v152);</span><br><span class="line">  result = *v54;</span><br><span class="line">  <span class="keyword">if</span> ( !*v54 )</span><br><span class="line">  &#123;</span><br><span class="line">    v89 = v108 + <span class="number">27</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v108[<span class="number">8</span>] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( !<span class="built_in">sub_C1DB8460</span>(v108 + <span class="number">27</span>, v104) )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( (*v89 | <span class="number">4</span>) != <span class="number">6</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          result = <span class="number">56</span>;</span><br><span class="line">          <span class="keyword">if</span> ( v108[<span class="number">28</span>] != <span class="number">8</span> )</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line">        v150 = (<span class="keyword">void</span> *)*a1;</span><br><span class="line">        v90 = *a3;</span><br><span class="line">        v91 = *a2;</span><br><span class="line">        v92 = <span class="built_in">sub_C1DB7DA4</span>(*a2, *a3, *v89, v108[<span class="number">28</span>]);</span><br><span class="line">        v93 = <span class="built_in">malloc</span>(v92);</span><br><span class="line">        *a1 = v93;</span><br><span class="line">        v94 = <span class="number">83</span>;</span><br><span class="line">        <span class="keyword">if</span> ( v93 )</span><br><span class="line">          v94 = <span class="built_in">sub_C1DB8064</span>(v93, v150, v89, v104, v91, v90);</span><br><span class="line">        *v110 = v94;</span><br><span class="line">        <span class="built_in">free</span>(v150);</span><br><span class="line">        <span class="keyword">return</span> *v110;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      result = <span class="built_in">sub_C1DB7D34</span>(v108 + <span class="number">27</span>, v104);</span><br><span class="line">      *v110 = result;</span><br><span class="line">      <span class="keyword">if</span> ( result )</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> v88;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>得到PIC数据(部分)(这个数据是伴随APP整个生命周期,主要用途是加解密密钥)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">BDC74300  2E 50 49 43 90 01 00 00  10 02 00 00 B0 02 00 00  .PIC............</span><br><span class="line">BDC74310  82 1B 33 E3 4F 0C 49 C7  00 00 00 00 2D AA F5 F4  ..3...I.....-...</span><br><span class="line">BDC74320  52 22 D7 92 FB 3E EB AA  4A A2 74 C9 12 2D F9 92  R&quot;ג .&gt;....t..-..</span><br><span class="line">BDC74330  F4 E7 CD 2C D8 33 1A B5  D4 8F F1 1E 11 6A 63 4D  ........ԏ ....cM</span><br><span class="line">BDC74340  73 AC 1E 88 BB E5 A5 D2  19 F4 46 8A 7D 13 57 F8  s.............W.</span><br><span class="line">BDC74350  0C 14 F1 4C C7 E2 89 01  1A BD C8 72 66 3F F0 A9  ............f?..</span><br><span class="line">BDC74360  C2 BA 6B 75 6D E3 03 FC  8F 61 20 96 6F 2C 44 2D  º kum....a .o,D-</span><br><span class="line">BDC74370  D6 19 DE F4 74 8E 6F 01  6B 9D 5F BB 6D C4 6C CD  ....t.o.k._.m...</span><br><span class="line">BDC74380  49 00 8F 36 F9 18 8E 50  2D 35 F3 6C F0 6C 75 84  I..6...P-5....u.</span><br><span class="line">BDC74390  2C 78 A0 D7 8E 64 A1 E9  CC 5C 1A 59 C3 78 E3 7A  ,x...d.....Y....</span><br></pre></td></tr></table></figure>

<h2 id="4-4、采集系统环境信息加密"><a href="#4-4、采集系统环境信息加密" class="headerlink" title="4.4、采集系统环境信息加密"></a>4.4、采集系统环境信息加密</h2><h3 id="4-4-1、循环获取信息-0x34次"><a href="#4-4-1、循环获取信息-0x34次" class="headerlink" title="4.4.1、循环获取信息 0x34次"></a>4.4.1、循环获取信息 0x34次</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">.text:C1AF5224 02 98       LDR             R0, [SP,#8]</span><br><span class="line">.text:C1AF5226 06 59       LDR             R6, [R0,R4]</span><br><span class="line">.text:C1AF5228 D6 F7 46 F8 BL              init_DecString_sub_C84582B8</span><br><span class="line">.text:C1AF522C 06 90       STR             R0, [SP,#0x18]</span><br><span class="line">.text:C1AF522E 0A AD       ADD             R5, SP, #0x28 ; &#x27;(&#x27;</span><br><span class="line">.text:C1AF5230 28 00       MOVS            R0, R5</span><br><span class="line">.text:C1AF5232 04 99       LDR             R1, [SP,#0x10]</span><br><span class="line">.text:C1AF5234 05 9A       LDR             R2, [SP,#0x14]</span><br><span class="line">.text:C1AF5236 33 00       MOVS            R3, R6</span><br><span class="line">.text:C1AF5238 FB F7 AC FE BL              GetDeviceInfo_dispatch_loop_sub_C89F8F94 ; 获取设备信息1</span><br><span class="line">.text:C1AF523C 06 98       LDR             R0, [SP,#0x18]</span><br><span class="line">.text:C1AF523E 31 00       MOVS            R1, R6</span><br><span class="line">.text:C1AF5240 2A 00       MOVS            R2, R5</span><br><span class="line">.text:C1AF5242 03 9D       LDR             R5, [SP,#0xC]</span><br><span class="line">.text:C1AF5244 F9 F7 BE F9 BL              jmp_checkField_sub_C89F65C4 ; 判断采集的设备信息是否等于如下特殊字符[]，&#123;&#125;，mtg_block，mtg_unsupport</span><br><span class="line">.text:C1AF5248 0A 98       LDR             R0, [SP,#0x28]</span><br><span class="line">.text:C1AF524A 40 19       ADDS            R0, R0, R5</span><br><span class="line">.text:C1AF524C 09 A9       ADD             R1, SP, #0x24 ; &#x27;$&#x27;</span><br><span class="line">.text:C1AF524E 4C F0 7B FA BL              free_sub_B2943748</span><br><span class="line">.text:C1AF5252 04 34       ADDS            R4, #4</span><br><span class="line">.text:C1AF5254 34 2C       CMP             R4, #0x34 ; &#x27;4&#x27;         ; 判断是否结束</span><br><span class="line">.text:C1AF5256 E5 D1       BNE             loc_C1AF5224</span><br><span class="line">.text:C1AF5258 03 B5       PUSH            &#123;R0,R1,LR&#125;              ; 获取结束</span><br></pre></td></tr></table></figure>

<p>在下面地方下是跳转到每一个采集信息方法入口的地方，下好断点:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.text:C207A134 80 00       LSLS            R0, R0, #2              ; 跳到真实执行方法</span><br><span class="line">.text:C207A136 02 A1       ADR             R1, loc_C207A140</span><br><span class="line">.text:C207A138 08 58       LDR             R0, [R1,R0]             ; 取方法表偏移</span><br><span class="line">.text:C207A13A 08 18       ADDS            R0, R1, R0</span><br><span class="line">.text:C207A13C 87 46       MOV             PC, R0</span><br></pre></td></tr></table></figure>

<p>获取的系统环境信息</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;0&quot;</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="attr">&quot;1&quot;</span>: [<span class="string">&quot;-&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;google&quot;</span>, <span class="string">&quot;user&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;PQ2A.190305.002&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;sailfish&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;Pixel&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;adb&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;&#123;\&quot;1\&quot;:\&quot;-\&quot;,\&quot;2\&quot;:\&quot;-\&quot;,\&quot;3\&quot;:\&quot;-\&quot;,\&quot;4\&quot;:\&quot;\&quot;,\&quot;5\&quot;:\&quot;\&quot;,\&quot;6\&quot;:\&quot;-\&quot;,\&quot;7\&quot;:\&quot;-\&quot;,\&quot;8\&quot;:\&quot;\&quot;,\&quot;9\&quot;:\&quot;\&quot;,\&quot;10\&quot;:\&quot;-\&quot;,\&quot;11\&quot;:\&quot;-\&quot;,\&quot;12\&quot;:\&quot;32\&quot;,\&quot;13\&quot;:\&quot;\&quot;,\&quot;14\&quot;:\&quot;-\&quot;,\&quot;15\&quot;:\&quot;\&quot;,\&quot;33\&quot;:&#123;\&quot;0\&quot;:0,\&quot;1\&quot;:\&quot;-\&quot;,\&quot;2\&quot;:\&quot;-\&quot;,\&quot;3\&quot;:\&quot;-\&quot;,\&quot;4\&quot;:\&quot;-\&quot;,\&quot;5\&quot;:\&quot;-\&quot;,\&quot;6\&quot;:\&quot;-\&quot;,\&quot;7\&quot;:\&quot;-\&quot;,\&quot;8\&quot;:\&quot;-\&quot;,\&quot;9\&quot;:\&quot;-\&quot;,\&quot;10\&quot;:\&quot;-\&quot;,\&quot;11\&quot;:\&quot;-\&quot;,\&quot;12\&quot;:\&quot;-\&quot;,\&quot;13\&quot;:\&quot;-\&quot;,\&quot;14\&quot;:\&quot;-\&quot;,\&quot;15\&quot;:\&quot;-\&quot;&#125;&#125;&quot;</span>, <span class="string">&quot;midi,adb&quot;</span>, <span class="string">&quot;midi,adb&quot;</span>, <span class="string">&quot;release-keys&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;1&quot;</span>, <span class="string">&quot;1&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;9&quot;</span>],</span><br><span class="line">    <span class="attr">&quot;2&quot;</span>: [<span class="string">&quot;-&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;-&quot;</span>],</span><br><span class="line">    <span class="attr">&quot;3&quot;</span>: <span class="string">&quot;&#123;&#125;&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-4-2、加密设备信息"><a href="#4-4-2、加密设备信息" class="headerlink" title="4.4.2、加密设备信息"></a>4.4.2、加密设备信息</h3><p>压缩信息</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">result = <span class="built_in">deflateInit_</span>(&amp;strm, <span class="number">-1</span>, a128, <span class="number">56</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !result )</span><br><span class="line">  &#123;</span><br><span class="line">    v6 = <span class="built_in">deflate</span>(&amp;strm, <span class="number">4</span>);</span><br><span class="line">    <span class="keyword">if</span> ( v6 == <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      *a4 = strm.total_out;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">deflateEnd</span>(&amp;strm);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">deflateEnd</span>(&amp;strm);</span><br><span class="line">    <span class="keyword">if</span> ( v6 != <span class="number">2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v6 != <span class="number">-5</span> )</span><br><span class="line">        <span class="keyword">return</span> v6;</span><br><span class="line">      result = <span class="number">-3</span>;</span><br><span class="line">      <span class="keyword">if</span> ( strm.avail_in )</span><br><span class="line">        <span class="keyword">return</span> v6;</span><br><span class="line">      <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-3</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br></pre></td></tr></table></figure>

<p>压缩后信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">C3904500  78 9C 9D 92 DB 0A C2 30  0C 86 DF 25 D7 CD E8 61  x...............</span><br><span class="line">C3904510  53 B7 3B DF 60 5E 5B 2F  26 AB 5A 9C 0C 56 04 65  S.;..^[/&amp;.Z..V.e</span><br><span class="line">C3904520  F4 DD ED 0E B0 20 4E A6  17 81 2F E1 4F D2 9F B4  ..... N.../.....</span><br><span class="line">C3904530  05 0E 99 64 20 20 DB 03  02 FB 1A E7 BA 3E 57 26  ...d  ........W&amp;</span><br><span class="line">C3904540  C0 DD 99 66 AC E5 3B B9  8D 44 CA 15 4F 22 CE E5  ...f.....D..O&quot;..</span><br><span class="line">C3904550  5B 87 2B 6C 75 B2 EE 42  4A B9 7D 98 EA C3 F0 A2  [.+lu.....&#125;.....</span><br><span class="line">C3904560  3C CE AC 6D 35 08 0D 99  06 D4 C0 34 48 C2 8A 70  &lt;ά m5......4H..p</span><br><span class="line">C3904570  DC 73 8F C9 84 2B A2 58  13 DE 4C 92 74 42 C1 89  ...Ʉ +.X....tB..</span><br><span class="line">C3904580  44 D0 AD 62 58 AB E4 90  29 D2 13 53 19 59 AD 3A  DЭ bX......S.Y.:</span><br><span class="line">C3904590  51 78 7C 37 93 B3 5F 4C  20 71 81 0B 6C 20 F1 81  Qx|7.._L q..l ..</span><br></pre></td></tr></table></figure>

<p>解密PIC数据获取加密key 上面计算得到的sha256值，(包名+固定字符+SANKUAI.RSA的MD5值)-&gt;转换成hex 69fe5963f3b95d9718c8d3e4f924ad9379500e9b51d80686e65347890e1748fe</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">69 FE 59 63 F3 B9 5D 97 18 C8 D3 E4 F9 24 AD 93 79 50 0E 9B 51 D8 06 86 E6 53 47 89 0E 17 48 FE</span><br></pre></td></tr></table></figure>

<p>取前0x10字节</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">69 FE 59 63 F3 B9 5D 97 18 C8 D3 E4 F9 24 AD 93</span><br></pre></td></tr></table></figure>

<p>生成AES KEY</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">.text:C1AE9DA2 0A A8       ADD             R0, SP, #0x28 ; &#x27;(&#x27;     ; 生成AES key</span><br><span class="line">.text:C1AE9DA4 08 90       STR             R0, [SP,#0x20]</span><br><span class="line">.text:C1AE9DA6 84 5D       LDRB            R4, [R0,R6]</span><br><span class="line">.text:C1AE9DA8 82 B0       SUB             SP, SP, #8</span><br><span class="line">.text:C1AE9DAA 03 B5       PUSH            &#123;R0,R1,LR&#125;</span><br><span class="line">.text:C1AE9DAC DF F7 72 E9 BLX             jmp_sub_B288C094</span><br><span class="line">.text:C1AE9DB0 54 01       LSLS            R4, R2, #5</span><br><span class="line">.text:C1AE9DB2 00 00       MOVS            R0, R0</span><br><span class="line">.text:C1AE9DB4 01 BC       POP             &#123;R0&#125;</span><br><span class="line">.text:C1AE9DB6 20 18       ADDS            R0, R4, R0</span><br><span class="line">.text:C1AE9DB8 29 00       MOVS            R1, R5</span><br><span class="line">.text:C1AE9DBA 63 F0 49 F9 BL              sub_C1B4D050</span><br><span class="line">.text:C1AE9DBE 07 91       STR             R1, [SP,#0x1C]</span><br><span class="line">.text:C1AE9DC0 82 B0       SUB             SP, SP, #8</span><br><span class="line">.text:C1AE9DC2 03 B5       PUSH            &#123;R0,R1,LR&#125;</span><br><span class="line">.text:C1AE9DC4 DF F7 66 E9 BLX             jmp_sub_B288C094</span><br><span class="line">.text:C1AE9DC8 40 01       LSLS            R0, R0, #5</span><br><span class="line">.text:C1AE9DCA 00 00       MOVS            R0, R0</span><br><span class="line">.text:C1AE9DCC 01 BC       POP             &#123;R0&#125;</span><br><span class="line">.text:C1AE9DCE 20 18       ADDS            R0, R4, R0</span><br><span class="line">.text:C1AE9DD0 04 99       LDR             R1, [SP,#0x10]</span><br><span class="line">.text:C1AE9DD2 63 F0 3D F9 BL              sub_C1B4D050</span><br><span class="line">.text:C1AE9DD6 69 43       MULS            R1, R5</span><br><span class="line">.text:C1AE9DD8 07 98       LDR             R0, [SP,#0x1C]</span><br><span class="line">.text:C1AE9DDA 08 18       ADDS            R0, R1, R0              ; 初始化密钥</span><br><span class="line">.text:C1AE9DDC 03 21       MOVS            R1, #3</span><br><span class="line">.text:C1AE9DDE 41 43       MULS            R1, R0</span><br><span class="line">.text:C1AE9DE0 06 98       LDR             R0, [SP,#0x18]</span><br><span class="line">.text:C1AE9DE2 40 18       ADDS            R0, R0, R1</span><br><span class="line">.text:C1AE9DE4 80 78       LDRB            R0, [R0,#2]</span><br><span class="line">.text:C1AE9DE6 20 40       ANDS            R0, R4</span><br><span class="line">.text:C1AE9DE8 FE 21       MOVS            R1, #0xFE</span><br><span class="line">.text:C1AE9DEA 01 40       ANDS            R1, R0</span><br><span class="line">.text:C1AE9DEC 08 98       LDR             R0, [SP,#0x20]</span><br><span class="line">.text:C1AE9DEE 81 55       STRB            R1, [R0,R6]             ; 存储密钥</span><br><span class="line">.text:C1AE9DF0 01 36       ADDS            R6, #1</span><br><span class="line">.text:C1AE9DF2 10 2E       CMP             R6, #0x10               ; 判断是否结束</span><br><span class="line">.text:C1AE9DF4 D5 D1       BNE             loc_C1AE9DA2            ; 生成AES key</span><br></pre></td></tr></table></figure>

<p>生成最终的AES KEY</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">68 98 08 02 F2 80 1C 94 08 C8 90 E4 A0 04 AC 82</span><br></pre></td></tr></table></figure>

<p>AES 解密pic</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">//IV 0102030405060708</span><br><span class="line">.text:C1AE7598 57 F0 7A F8 BL              AES_set_decrypt_key_sub_CB601690 ; R0:key,R1:大小,R2:初始AES_KEY返回结构</span><br><span class="line">.text:C1AE759C 00 20       MOVS            R0, #0</span><br><span class="line">.text:C1AE759E 69 46       MOV             R1, SP</span><br><span class="line">.text:C1AE75A0 06 9A       LDR             R2, [SP,#0x128+var_110]</span><br><span class="line">.text:C1AE75A2 0A 60       STR             R2, [R1,#0x128+var_128]</span><br><span class="line">.text:C1AE75A4 48 60       STR             R0, [R1,#0x128+var_124]</span><br><span class="line">.text:C1AE75A6 08 98       LDR             R0, [SP,#0x128+var_108]</span><br><span class="line">.text:C1AE75A8 04 9E       LDR             R6, [SP,#0x128+var_118]</span><br><span class="line">.text:C1AE75AA 31 00       MOVS            R1, R6</span><br><span class="line">.text:C1AE75AC 07 9C       LDR             R4, [SP,#0x128+var_10C]</span><br><span class="line">.text:C1AE75AE 22 00       MOVS            R2, R4</span><br><span class="line">.text:C1AE75B0 03 9B       LDR             R3, [SP,#0x128+var_11C]</span><br><span class="line">.text:C1AE75B2 57 F0 35 FD BL              AES_cbc_Dncrypt_sub_CB602020</span><br><span class="line">.text:C1AE75B6 30 00       MOVS            R0, R6</span><br></pre></td></tr></table></figure>

<p>解密解压后PIC数据</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;a1&quot;</span>:<span class="number">0</span>,<span class="attr">&quot;a10&quot;</span>:<span class="number">400</span>,<span class="attr">&quot;a2&quot;</span>:<span class="string">&quot;com.sankuai.meituan&quot;</span>,<span class="attr">&quot;a11&quot;</span>:<span class="string">&quot;c1ee9178c95d9ec75f0f076a374df94a032d54c8576298d4f75e653de3705449&quot;</span>,<span class="attr">&quot;a3&quot;</span>:<span class="string">&quot;0a16ecd60eb56a6a3349f66cdcf7f7bf5190e5a42d6280d8dc0ee3be228398ec&quot;</span>,<span class="attr">&quot;a4&quot;</span>:<span class="number">1100030200</span>,<span class="attr">&quot;k0&quot;</span>:&#123;<span class="attr">&quot;k1&quot;</span>:<span class="string">&quot;meituan1sankuai0&quot;</span>,<span class="attr">&quot;k2&quot;</span>:<span class="string">&quot;meituan0sankuai1&quot;</span>,<span class="attr">&quot;k3&quot;</span>:<span class="string">&quot;$MXMYBS@HelloPay&quot;</span>,<span class="attr">&quot;k4&quot;</span>:<span class="string">&quot;Maoyan010iauknaS&quot;</span>,<span class="attr">&quot;k5&quot;</span>:<span class="string">&quot;34281a9dw2i701d4&quot;</span>,<span class="attr">&quot;k6&quot;</span>:<span class="string">&quot;X%rj@KiuU+|xY&#125;?f&quot;</span>&#125;,<span class="attr">&quot;a5&quot;</span>:<span class="string">&quot;11.3.200&quot;</span>,<span class="attr">&quot;a0&quot;</span>:<span class="string">&quot;pw/LhTdeoTTyaxPHcHMy+/ssGNS1ihNkrJ+uBI74FIfd90KlTil1m0i7FF/n0bhY&quot;</span>,<span class="attr">&quot;a6&quot;</span>:<span class="string">&quot;/HntC9XIfdUyII/UiVfx020EQPpHz2XZY3qzM2aiNmM0i0pB1yeSO689TY9SBB3s&quot;</span>,<span class="attr">&quot;a7&quot;</span>:<span class="string">&quot;QsHnU6kFjTYR8Z6tHEvkGMO2Hrt+NRnVQhmxg6EtVBzuzQcBpma3AdhTWNMpesFT&quot;</span>,<span class="attr">&quot;c0&quot;</span>:&#123;<span class="attr">&quot;c1&quot;</span>:<span class="literal">true</span>,<span class="attr">&quot;c2&quot;</span>:<span class="literal">false</span>&#125;,<span class="attr">&quot;a9&quot;</span>:<span class="string">&quot;SDEzWXi5LHL/cuMCZ1zYyv+0hIViqWWf+ShbUYILWf4=&quot;</span>,<span class="attr">&quot;a8&quot;</span>:<span class="number">1603800117167</span>&#125;</span><br></pre></td></tr></table></figure>

<p>解析json获取key k6</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X%rj@KiuU+|xY&#125;?f</span><br></pre></td></tr></table></figure>

<p>计算压缩后信息的CRC值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">.text:C1B2C832             crc32_loc_CCBA9832 </span><br><span class="line">.text:C1B2C848↓j</span><br><span class="line">.text:C1B2C832 FF 25       MOVS            R5, #0xFF</span><br><span class="line">.text:C1B2C834 05 40       ANDS            R5, R0</span><br><span class="line">.text:C1B2C836 16 78       LDRB            R6, [R2]</span><br><span class="line">.text:C1B2C838 6E 40       EORS            R6, R5</span><br><span class="line">.text:C1B2C83A B5 00       LSLS            R5, R6, #2</span><br><span class="line">.text:C1B2C83C 65 59       LDR             R5, [R4,R5]</span><br><span class="line">.text:C1B2C83E 00 0A       LSRS            R0, R0, #8</span><br><span class="line">.text:C1B2C840 68 40       EORS            R0, R5</span><br><span class="line">.text:C1B2C842 01 39       SUBS            R1, #1</span><br><span class="line">.text:C1B2C844 01 32       ADDS            R2, #1</span><br><span class="line">.text:C1B2C846 00 29       CMP             R1, #0</span><br><span class="line">.text:C1B2C848 F3 D1       BNE             crc32_loc_CCBA9832</span><br></pre></td></tr></table></figure>

<p>计算后的CRC值为 744d7275 组合加密压缩后设备环境信息的key</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">744d7275X%rj@Kiu //crc32+k6前8字节</span><br></pre></td></tr></table></figure>

<p>AES加密压缩后数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">.text:C1AE750E 32 00       MOVS            R2, R6</span><br><span class="line">.text:C1AE7510 56 F0 30 FF BL              AES_set_Encrypt_key_sub_CB601374 ; R0:key,R1:长度,R2:返回值</span><br><span class="line">.text:C1AE7514 06 9A       LDR             R2, [SP,#0x120+byte_count]</span><br><span class="line">.text:C1AE7516 01 20       MOVS            R0, #1</span><br><span class="line">.text:C1AE7518 69 46       MOV             R1, SP</span><br><span class="line">.text:C1AE751A 04 9B       LDR             R3, [SP,#0x120+var_110]</span><br><span class="line">.text:C1AE751C 0B 60       STR             R3, [R1,#0x120+var_120]</span><br><span class="line">.text:C1AE751E 48 60       STR             R0, [R1,#0x120+var_11C]</span><br><span class="line">.text:C1AE7520 05 98       LDR             R0, [SP,#0x120+p]</span><br><span class="line">.text:C1AE7522 02 9C       LDR             R4, [SP,#0x120+var_118]</span><br><span class="line">.text:C1AE7524 21 00       MOVS            R1, R4</span><br><span class="line">.text:C1AE7526 33 00       MOVS            R3, R6</span><br><span class="line">.text:C1AE7528 57 F0 7A FD BL              AES_cbc_Encrypt_sub_CB602020 ; R0：原始数据,R1:返回,R2:大小,R3:key</span><br><span class="line">.text:C1AE752C 06 98       LDR             R0, [SP,#0x120+byte_count]</span><br><span class="line">.text:C1AE752E 03 99       LDR             R1, [SP,#0x120+var_114]</span><br></pre></td></tr></table></figure>

<p>加密后数据(部分)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">C37514E0  2E 5D 33 AF C8 C3 6B 6A  7F C2 9F F6 39 16 52 57  .]3...kj.......W</span><br><span class="line">C37514F0  1D CB 01 FF A2 FA 48 0B  2D 2B 7E 39 73 EB 65 E7  ......H.-+~9s...</span><br><span class="line">C3751500  14 93 59 D9 15 F2 D7 CB  C7 40 DC B5 9D 0D 34 16  ..Y......@....4.</span><br><span class="line">C3751510  9C BF 69 C6 54 97 81 C8  69 7A 26 03 BF FA F3 D9  ..i......z&amp;.....</span><br><span class="line">C3751520  A3 D2 BE 38 B0 99 48 4A  5E 56 F0 C6 88 54 79 BD  .Ҿ 8..HJ^V....y.</span><br><span class="line">C3751530  56 86 96 A7 40 D4 61 32  6D A4 07 55 F1 46 46 EF  V...@..2m..U....</span><br><span class="line">C3751540  4E A1 CA 86 F8 1E 69 09  0B CF 6D 05 3B D3 0F B4  N.ʆ ..i.....;...</span><br><span class="line">C3751550  63 78 65 6D AD F7 B2 C4  75 86 C5 35 B5 6F 42 BA  cxem.........oB.</span><br><span class="line">C3751560  FA AF E7 4C 56 41 CF 36  46 86 3E E0 11 A3 35 9E  .....A..F.&gt;...5.</span><br></pre></td></tr></table></figure>

<p>base64加密</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">.text:C1ACFE62 27 DB       BLT             loc_C1ACFEB4</span><br><span class="line">.text:C1ACFE64 00 25       MOVS            R5, #0</span><br><span class="line">.text:C1ACFE66 3A 4A       LDR             R2, =(aAbcdefghijklmn - 0xC1ACFE6C) ; &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklm&quot;...</span><br><span class="line">.text:C1ACFE68 7A 44       ADD             R2, PC                  ; &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklm&quot;...</span><br><span class="line">.text:C1ACFE6A 01 9E       LDR             R6, [SP,#0x28+var_24]</span><br><span class="line">.text:C1ACFE6C</span><br><span class="line">.text:C1ACFE6C             loc_C1ACFE6C                            ; CODE XREF: base64_sub_C795AE10+A0↓j</span><br><span class="line">.text:C1ACFE6C 43 5D       LDRB            R3, [R0,R5]             ; 加密后数据</span><br><span class="line">.text:C1ACFE6E 9B 08       LSRS            R3, R3, #2</span><br><span class="line">.text:C1ACFE70 D3 5C       LDRB            R3, [R2,R3]             ; base64 key</span><br><span class="line">.text:C1ACFE72 33 70       STRB            R3, [R6]</span><br><span class="line">.text:C1ACFE74 43 5D       LDRB            R3, [R0,R5]</span><br><span class="line">.text:C1ACFE76 1B 01       LSLS            R3, R3, #4</span><br><span class="line">.text:C1ACFE78 30 24       MOVS            R4, #0x30 ; &#x27;0&#x27;</span><br><span class="line">.text:C1ACFE7A 1C 40       ANDS            R4, R3</span><br><span class="line">.text:C1ACFE7C 43 19       ADDS            R3, R0, R5</span><br><span class="line">.text:C1ACFE7E 08 00       MOVS            R0, R1</span><br><span class="line">.text:C1ACFE80 59 78       LDRB            R1, [R3,#1]</span><br><span class="line">.text:C1ACFE82 09 09       LSRS            R1, R1, #4</span><br><span class="line">.text:C1ACFE84 21 43       ORRS            R1, R4</span><br><span class="line">.text:C1ACFE86 51 5C       LDRB            R1, [R2,R1]</span><br><span class="line">.text:C1ACFE88 71 70       STRB            R1, [R6,#1]</span><br><span class="line">.text:C1ACFE8A 59 78       LDRB            R1, [R3,#1]</span><br><span class="line">.text:C1ACFE8C 89 00       LSLS            R1, R1, #2</span><br><span class="line">.text:C1ACFE8E 3C 24       MOVS            R4, #0x3C ; &#x27;&lt;&#x27;</span><br><span class="line">.text:C1ACFE90 0C 40       ANDS            R4, R1</span><br><span class="line">.text:C1ACFE92 99 78       LDRB            R1, [R3,#2]</span><br><span class="line">.text:C1ACFE94 89 09       LSRS            R1, R1, #6</span><br><span class="line">.text:C1ACFE96 21 43       ORRS            R1, R4</span><br><span class="line">.text:C1ACFE98 51 5C       LDRB            R1, [R2,R1]</span><br><span class="line">.text:C1ACFE9A B1 70       STRB            R1, [R6,#2]</span><br><span class="line">.text:C1ACFE9C 99 78       LDRB            R1, [R3,#2]</span><br><span class="line">.text:C1ACFE9E 3F 23       MOVS            R3, #0x3F ; &#x27;?&#x27;</span><br><span class="line">.text:C1ACFEA0 0B 40       ANDS            R3, R1</span><br><span class="line">.text:C1ACFEA2 D1 5C       LDRB            R1, [R2,R3]</span><br><span class="line">.text:C1ACFEA4 F1 70       STRB            R1, [R6,#3]</span><br><span class="line">.text:C1ACFEA6 01 00       MOVS            R1, R0</span><br><span class="line">.text:C1ACFEA8 04 98       LDR             R0, [SP,#0x28+var_18]</span><br><span class="line">.text:C1ACFEAA 04 36       ADDS            R6, #4</span><br><span class="line">.text:C1ACFEAC 03 35       ADDS            R5, #3</span><br><span class="line">.text:C1ACFEAE 8D 42       CMP             R5, R1</span><br><span class="line">.text:C1ACFEB0 DC DB       BLT             loc_C1ACFE6C            ; 加密后数据</span><br><span class="line">.text:C1ACFEB2 02 9A       LDR             R2, [SP,#0x28+var_20]</span><br><span class="line">.text:C1ACFEB4</span><br><span class="line">.text:C1ACFEB4             loc_C1ACFEB4                            ; CODE XREF: base64_sub_C795AE10+52↑j</span><br><span class="line">.text:C1ACFEB4 95 42       CMP             R5, R2</span><br><span class="line">.text:C1ACFEB6 1F DA       BGE             loc_C1ACFEF8</span><br><span class="line">.text:C1ACFEB8 41 5D       LDRB            R1, [R0,R5]</span><br><span class="line">.text:C1ACFEBA 14 00       MOVS            R4, R2</span><br><span class="line">.text:C1ACFEBC 8A 08       LSRS            R2, R1, #2</span><br><span class="line">.text:C1ACFEBE 25 49       LDR             R1, =(aAbcdefghijklmn - 0xC1ACFEC4) ; &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklm&quot;...</span><br><span class="line">.text:C1ACFEC0 79 44       ADD             R1, PC                  ; &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklm&quot;...</span><br><span class="line">.text:C1ACFEC2 8A 5C       LDRB            R2, [R1,R2]</span><br><span class="line">.text:C1ACFEC4 32 70       STRB            R2, [R6]</span><br><span class="line">.text:C1ACFEC6 42 5D       LDRB            R2, [R0,R5]</span><br><span class="line">.text:C1ACFEC8 13 01       LSLS            R3, R2, #4</span><br><span class="line">.text:C1ACFECA 30 22       MOVS            R2, #0x30 ; &#x27;0&#x27;</span><br><span class="line">.text:C1ACFECC 1A 40       ANDS            R2, R3</span><br><span class="line">.text:C1ACFECE 63 1E       SUBS            R3, R4, #1</span><br><span class="line">.text:C1ACFED0 9D 42       CMP             R5, R3</span><br><span class="line">.text:C1ACFED2 14 D1       BNE             loc_C1ACFEFE</span><br><span class="line">.text:C1ACFED4 89 5C       LDRB            R1, [R1,R2]</span><br><span class="line">.text:C1ACFED6 71 70       STRB            R1, [R6,#1]</span><br><span class="line">.text:C1ACFED8 3D 21       MOVS            R1, #0x3D ; &#x27;=&#x27;</span><br><span class="line">.text:C1ACFEDA 1B E0       B               loc_C1ACFF14</span><br></pre></td></tr></table></figure>

<p>Base64加密后</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ll0zr8jDa2p/wp/2ORZSVx3LAf+i+kgLLSt+OXPrZecUk1nZFfLXy8dA3LWdDTQWnL9pxlSXgchpeiYDv/rz2aPSvjiwmUhKXlbwxohUeb1WhpanQNRhMm2kB1XxRkbvTqHKhvgeaQkLz20FO9MPtGN4ZW2t97LEdYbFNbVvQrr6r+dMVkHPNkaGPuARozWeaQGSSMkoMMJ+ve9rA1L+aQTgGSootSpmPnT3TPLrCPN0Z6HzPKtpxopqfsjfcIV7YcP7M8Wc847wXfhMA2hYTRO24or97heGubGuxo8hQyw=</span><br></pre></td></tr></table></figure>

<p>将CRC值与Base64加密后值组合,(签名时使用到)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">744d7275Ll0zr8jDa2p/wp/2ORZSVx3LAf+i+kgLLSt+OXPrZecUk1nZFfLXy8dA3LWdDTQWnL9pxlSXgchpeiYDv/rz2aPSvjiwmUhKXlbwxohUeb1WhpanQNRhMm2kB1XxRkbvTqHKhvgeaQkLz20FO9MPtGN4ZW2t97LEdYbFNbVvQrr6r+dMVkHPNkaGPuARozWeaQGSSMkoMMJ+ve9rA1L+aQTgGSootSpmPnT3TPLrCPN0Z6HzPKtpxopqfsjfcIV7YcP7M8Wc847wXfhMA2hYTRO24or97heGubGuxo8hQyw=</span><br></pre></td></tr></table></figure>

<h2 id="4-5、第二次加密设备信息"><a href="#4-5、第二次加密设备信息" class="headerlink" title="4.5、第二次加密设备信息"></a>4.5、第二次加密设备信息</h2><p>设备信息数据</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;voltage&quot;</span>:<span class="string">&quot;1&quot;</span>,<span class="attr">&quot;type&quot;</span>:<span class="string">&quot;user&quot;</span>,<span class="attr">&quot;brand&quot;</span>:<span class="string">&quot;google&quot;</span>,<span class="attr">&quot;psuc&quot;</span>:<span class="string">&quot;adb&quot;</span>,<span class="attr">&quot;temp&quot;</span>:<span class="string">&quot;1&quot;</span>,<span class="attr">&quot;suc&quot;</span>:<span class="string">&quot;midi,adb&quot;</span>,<span class="attr">&quot;id&quot;</span>:<span class="string">&quot;PQ2A.190305.002&quot;</span>,<span class="attr">&quot;sus&quot;</span>:<span class="string">&quot;midi,adb&quot;</span>,<span class="attr">&quot;tags&quot;</span>:<span class="string">&quot;release-keys&quot;</span>,<span class="attr">&quot;timestamp&quot;</span>:<span class="string">&quot;1631688160837&quot;</span>,<span class="attr">&quot;hardware&quot;</span>:<span class="string">&quot;sailfish&quot;</span>,<span class="attr">&quot;version&quot;</span>:<span class="string">&quot;9&quot;</span>,<span class="attr">&quot;model&quot;</span>:<span class="string">&quot;Pixel&quot;</span>&#125;</span><br></pre></td></tr></table></figure>

<p>压缩数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">C42FEF80  78 9C 55 8E 41 12 82 30  0C 45 EF D2 35 32 2D 8C  x.U.A..0.E...2-.</span><br><span class="line">C42FEF90  08 EE BC 81 1E 21 D8 08  19 5B CA 34 80 32 8E 77  .  .!...[...2.w</span><br><span class="line">C42FEFA0  37 15 37 AE 92 FF F2 93  FC 97 5A 82 9B A0 43 75  7.7.......Z...Cu</span><br><span class="line">C42FEFB0  54 46 65 6A 5A C7 D4 CE  8C 51 54 1B 61 B0 22 BB  TFejZ..Ό QT.a.&quot;.</span><br><span class="line">C42FEFC0  10 3A 87 02 46 9E AF A2  C1 B6 C9 8B 7E FC AD 6D  .:..F.....ɋ ~..m</span><br><span class="line">C42FEFD0  D8 93 A5 6C 9B 51 5A 3B  5F 8A 53 6E 1A 5D EA 7D  ...l.QZ;_.Sn.]..</span><br><span class="line">C42FEFE0  AE 75 F1 F5 F1 BF 4F 5E  27 12 D1 21 30 EE EE B8  .u....O^&#x27;...0...</span><br><span class="line">C42FEFF0  72 A2 E4 91 27 D8 CE 57  A5 A9 EA DA 54 BA 2E 0F  r......W........</span><br></pre></td></tr></table></figure>

<p>解密PIC数据获取key(k1),流程和上面一样</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">解密后得到key meituan1sankuai0</span><br></pre></td></tr></table></figure>

<p>AES 加密压缩后数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">.text:C1AE7510 56 F0 30 FF BL              AES_set_Encrypt_key_sub_CB601374 ; R0:key,R1:长度,R2:返回值</span><br><span class="line">.text:C1AE7514 06 9A       LDR             R2, [SP,#0x120+byte_count]</span><br><span class="line">.text:C1AE7516 01 20       MOVS            R0, #1</span><br><span class="line">.text:C1AE7518 69 46       MOV             R1, SP</span><br><span class="line">.text:C1AE751A 04 9B       LDR             R3, [SP,#0x120+var_110]</span><br><span class="line">.text:C1AE751C 0B 60       STR             R3, [R1,#0x120+var_120]</span><br><span class="line">.text:C1AE751E 48 60       STR             R0, [R1,#0x120+var_11C]</span><br><span class="line">.text:C1AE7520 05 98       LDR             R0, [SP,#0x120+p]</span><br><span class="line">.text:C1AE7522 02 9C       LDR             R4, [SP,#0x120+var_118]</span><br><span class="line">.text:C1AE7524 21 00       MOVS            R1, R4</span><br><span class="line">.text:C1AE7526 33 00       MOVS            R3, R6</span><br><span class="line">.text:C1AE7528 57 F0 7A FD BL              AES_cbc_Encrypt_sub_CB602020 ; R0：原始数据,R1:返回,R2:大小,R3:key</span><br><span class="line">.text:C1AE752C 06 98       LDR             R0, [SP,#0x120+byte_count]</span><br></pre></td></tr></table></figure>

<p>加密后数据(部分)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">DEED6F00  2E 0F E3 72 62 1C 2B FB  35 B0 A9 CA E5 29 9F 79  ......+.5....).y</span><br><span class="line">DEED6F10  C6 37 F0 02 CB 17 12 AE  6E 3D 5E AC EB A6 B5 DD  ........n=^.릵  .</span><br><span class="line">DEED6F20  33 B9 24 A9 F4 E0 6D 6C  64 D6 76 E4 65 88 6C 6F  3.$.....d.....lo</span><br><span class="line">DEED6F30  F3 53 20 FA B3 F8 02 6C  6D BC 75 C9 87 66 92 CE  .......lm.uɇ f..</span><br><span class="line">DEED6F40  51 7A BC 09 BF 69 5D C0  C3 0A 71 77 46 5B E0 81  Qz...i]...qwF[..</span><br><span class="line">DEED6F50  E2 15 67 05 5B 87 48 2D  0D D4 FA 99 EF 1C AC BD  ....[.H-........</span><br><span class="line">DEED6F60  53 26 56 13 16 91 68 A8  EC 5B 1F D8 5F F4 61 BB  S&amp;V...h.........</span><br><span class="line">DEED6F70  FA 2A 2F 03 B5 3F 6E 02  6E 57 ED 46 8B A1 1A 0A  .*/..?n.nW......</span><br><span class="line">DEED6F80  F5 C5 E7 38 9F E5 8E 70  B1 8C D6 CF E8 D5 16 6F  ...............o</span><br><span class="line">DEED6F90  F6 36 3B A5 D8 2B 3D D9  83 BD 17 C5 3F AA 3D 96  ......=ك .....=.</span><br></pre></td></tr></table></figure>

<p>Base64加密后</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Lg/jcmIcK/s1sKnK5SmfecY38ALLFxKubj1erOumtd0zuSSp9OBtbGTWduRliGxv81Mg+rP4AmxtvHXJh2aSzlF6vAm/aV3Awwpxd0Zb4IHiFWcFW4dILQ3U+pnvHKy9UyZWExaRaKjsWx/YX/Rhu/oqLwO1P24CblftRouhGgr1xec4n+WOcLGM1s/o1RZv9jY7pdgrPdmDvRfFP6o9liGe0rCXBoG85J1mm/6GmqQ=</span><br></pre></td></tr></table></figure>

<h2 id="4-6、代码混淆"><a href="#4-6、代码混淆" class="headerlink" title="4.6、代码混淆"></a>4.6、代码混淆</h2><p>代码逻辑跳转动态计算：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">模板1</span><br><span class="line">.text:B845707C 01 10 CE E3 BIC             R1, LR, #1</span><br><span class="line">.text:B8457080 00 11 91 E7 LDR             R1, [R1,R0,LSL#2]</span><br><span class="line">.text:B8457084 0E 10 81 E0 ADD             R1, R1, LR</span><br><span class="line">.text:B8457088 08 E0 9D E5 LDR             LR, [SP,#arg_8]</span><br><span class="line">.text:B845708C 08 10 8D E5 STR             R1, [SP,#arg_8]</span><br><span class="line">.text:B8457090 03 80 BD E8 POP             &#123;R0,R1,PC&#125;</span><br><span class="line"> </span><br><span class="line">模板2</span><br><span class="line">.text:C18BDAC0 7F B5       PUSH            &#123;R0-R6,LR&#125;</span><br><span class="line">.text:C18BDAC2 7F B5       PUSH            &#123;R0-R6,LR&#125;</span><br><span class="line">.text:C18BDAC4 0D 26       MOVS            R6, #0xD</span><br><span class="line">.text:C18BDAC6 63 21       MOVS            R1, #0x63 ; &#x27;c&#x27;</span><br><span class="line">.text:C18BDAC8 68 46       MOV             R0, SP</span><br><span class="line">.text:C18BDACA 10 30       ADDS            R0, #0x10</span><br><span class="line">.text:C18BDACC 02 26       MOVS            R6, #2</span><br><span class="line">.text:C18BDACE 08 30       ADDS            R0, #8</span><br><span class="line">.text:C18BDAD0 01 1D       ADDS            R1, R0, #4</span><br><span class="line">.text:C18BDAD2 8D 46       MOV             SP, R1</span><br><span class="line">.text:C18BDAD4 04 A6 05 36 ADRL            R6, byte_C18BDAED</span><br><span class="line">.text:C18BDAD8 02 21       MOVS            R1, #2</span><br><span class="line">.text:C18BDADA 0A 36       ADDS            R6, #0xA</span><br><span class="line">.text:C18BDADC 76 18       ADDS            R6, R6, R1</span><br><span class="line">.text:C18BDADE 46 62       STR             R6, [R0,#0x24]</span><br><span class="line">.text:C18BDAE0 40 BC       POP             &#123;R6&#125;</span><br><span class="line">.text:C18BDAE2 01 E0       B               loc_C18BDAE8</span><br><span class="line">.text:C18BDAE4             ;</span><br><span class="line">.text:C18BDAE4 84 44       ADD             R12, R0</span><br><span class="line">.text:C18BDAE6 12 34       ADDS            R4, #0x12</span><br><span class="line">.text:C18BDAE8</span><br><span class="line">.text:C18BDAE8             loc_C18BDAE8  </span><br><span class="line">.text:C18BDAE8 00 46       MOV             R0, R0</span><br><span class="line">.text:C18BDAEA 7F BD       POP             &#123;R0-R6,PC&#125;</span><br></pre></td></tr></table></figure>

<p>字符串解密:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">.text:C1D46060             DecString</span><br><span class="line">.text:C1D46060             ; __unwind &#123; // 91B9000</span><br><span class="line">.text:C1D46060 10 B5       PUSH            &#123;R4,LR&#125;</span><br><span class="line">.text:C1D46062 01 2B       CMP             R3, #1</span><br><span class="line">.text:C1D46064 08 DB       BLT             locret_C1D46078</span><br><span class="line">.text:C1D46066</span><br><span class="line">.text:C1D46066             loc_C1D46066</span><br><span class="line">.text:C1D46066 0C 78       LDRB            R4, [R1]</span><br><span class="line">.text:C1D46068 54 40       EORS            R4, R2</span><br><span class="line">.text:C1D4606A 04 70       STRB            R4, [R0]</span><br><span class="line">.text:C1D4606C 01 3B       SUBS            R3, #1</span><br><span class="line">.text:C1D4606E 01 30       ADDS            R0, #1</span><br><span class="line">.text:C1D46070 01 31       ADDS            R1, #1</span><br><span class="line">.text:C1D46072 03 32       ADDS            R2, #3</span><br><span class="line">.text:C1D46074 00 2B       CMP             R3, #0</span><br><span class="line">.text:C1D46076 F6 D1       BNE             loc_C1D46066</span><br><span class="line">.text:C1D46078</span><br><span class="line">.text:C1D46078             locret_C1D46078</span><br><span class="line">.text:C1D46078 10 BD       POP             &#123;R4,PC&#125;</span><br></pre></td></tr></table></figure>

<p>流程混淆:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">.text:C1AF41F0 00 2C       CMP             R4, #0</span><br><span class="line">.text:C1AF41F2 01 DA       BGE             loc_C1AF41F8</span><br><span class="line">.text:C1AF41F4 FC F7 C8 FF BL              loc_C1AF1188</span><br><span class="line">.text:C1AF41F8</span><br><span class="line">.text:C1AF41F8             loc_C1AF41F8                            ; CODE XREF: .text:C1AF41F2↑j</span><br><span class="line">.text:C1AF41F8 03 B5       PUSH            &#123;R0,R1,LR&#125;</span><br><span class="line">.text:C1AF41FA 01 48       LDR             R0, =0x4A</span><br><span class="line">.text:C1AF41FC FC F7 F0 FE BL              ret_sub_CA67BFE0</span><br><span class="line"> </span><br><span class="line">.text:C1AF0FE0             ret_sub_CA67BFE0</span><br><span class="line">.text:C1AF0FE0</span><br><span class="line">.text:C1AF0FE0 D8 F7 4C E8 BLX             jmp_sub_B288C07C</span><br><span class="line">.text:C1AF0FE4 F0 1D       ADDS            R0, R6, #7</span><br></pre></td></tr></table></figure>

<h1 id="五、反爬虫mtgsig签名"><a href="#五、反爬虫mtgsig签名" class="headerlink" title="五、反爬虫mtgsig签名"></a>五、反爬虫mtgsig签名</h1><h2 id="5-1、基本流程"><a href="#5-1、基本流程" class="headerlink" title="5.1、基本流程"></a>5.1、基本流程</h2><p>APP每一个业务网络请求的请求头中都有mtgsig参数，该参数是请求体与其它参数计算的签名值。<br>java层代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">makeHeader</span><span class="params">(<span class="keyword">byte</span>[] arg13, MODE arg14)</span> </span>&#123;</span><br><span class="line">      Object[] v8 = <span class="keyword">new</span> Object[]&#123;arg13, arg14&#125;;</span><br><span class="line">      ChangeQuickRedirect v11 = WTSign.changeQuickRedirect;</span><br><span class="line">      <span class="keyword">if</span>(PatchProxy.isSupport(v8, <span class="keyword">null</span>, v11, <span class="keyword">true</span>, <span class="string">&quot;4371e5fcb0c4ae2bd761bbf35c1a43bf&quot;</span>, <span class="number">0x6000000000000000L</span>)) &#123;</span><br><span class="line">          <span class="keyword">return</span> (String)PatchProxy.accessDispatch(v8, <span class="keyword">null</span>, v11, <span class="keyword">true</span>, <span class="string">&quot;4371e5fcb0c4ae2bd761bbf35c1a43bf&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line"> </span><br><span class="line">      <span class="keyword">if</span>(arg13 == <span class="keyword">null</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="string">&quot;-2003&quot;</span>;</span><br><span class="line">      &#125;</span><br><span class="line"> </span><br><span class="line">      Object[] v13 = NBridge.main3(<span class="number">2</span>, <span class="keyword">new</span> Object[]&#123;MTGuard.sAppKey, arg13, ((<span class="keyword">int</span>)arg14.mode)&#125;);</span><br><span class="line">      <span class="keyword">if</span>(v13 == <span class="keyword">null</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="string">&quot;-1001&quot;</span>;</span><br><span class="line">      &#125;</span><br><span class="line"> </span><br><span class="line">      <span class="keyword">return</span> (v13[<span class="number">0</span>] <span class="keyword">instanceof</span> Integer) ? v13[<span class="number">0</span>] : ((String)v13[<span class="number">0</span>]);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>最终会走到Native层进行签名计算</p>
<h2 id="5-2、加密系统环境信息"><a href="#5-2、加密系统环境信息" class="headerlink" title="5.2、加密系统环境信息"></a>5.2、加密系统环境信息</h2><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 是否root、ADB调试状态、USB调试模式等</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;b1&quot;</span>: <span class="string">&quot;&#123;\&quot;1\&quot;:\&quot;\&quot;,\&quot;2\&quot;:\&quot;1|2|3\&quot;,\&quot;3\&quot;:\&quot;\&quot;,\&quot;4\&quot;:\&quot;\&quot;,\&quot;5\&quot;:\&quot;\&quot;,\&quot;6\&quot;:\&quot;\&quot;,\&quot;7\&quot;:\&quot;2\&quot;,\&quot;8\&quot;:\&quot;\&quot;,\&quot;9\&quot;:\&quot;\&quot;,\&quot;10\&quot;:\&quot;\&quot;,\&quot;11\&quot;:\&quot;\&quot;,\&quot;12\&quot;:\&quot;32\&quot;,\&quot;13\&quot;:\&quot;\&quot;,\&quot;14\&quot;:\&quot;\&quot;,\&quot;15\&quot;:\&quot;\&quot;,\&quot;33\&quot;:&#123;\&quot;0\&quot;:2,\&quot;1\&quot;:\&quot;\&quot;,\&quot;2\&quot;:\&quot;\&quot;,\&quot;3\&quot;:\&quot;\&quot;,\&quot;4\&quot;:\&quot;2|22\&quot;,\&quot;5\&quot;:\&quot;\&quot;,\&quot;6\&quot;:\&quot;\&quot;,\&quot;7\&quot;:\&quot;\&quot;,\&quot;8\&quot;:\&quot;\&quot;,\&quot;9\&quot;:\&quot;\&quot;,\&quot;10\&quot;:\&quot;\&quot;,\&quot;11\&quot;:\&quot;\&quot;,\&quot;12\&quot;:\&quot;\&quot;,\&quot;13\&quot;:\&quot;\&quot;,\&quot;14\&quot;:\&quot;2\&quot;,\&quot;15\&quot;:\&quot;\&quot;&#125;&#125;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;b2&quot;</span>: <span class="number">35</span>,</span><br><span class="line">    <span class="attr">&quot;b3&quot;</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">&quot;b4&quot;</span>: <span class="string">&quot;com.sankuai.meituan&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;b5&quot;</span>: <span class="string">&quot;11.12.204&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;b6&quot;</span>: <span class="string">&quot;1100120204&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;b7&quot;</span>: <span class="number">1631754559</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>压缩信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">E53E7D80  78 9C 9D 91 C1 0E C2 20  10 44 FF 65 CF 0D 61 76  x........D.e..av</span><br><span class="line">E53E7D90  81 2A DF C2 A5 35 1E 1A  D3 7A D0 9E DA FE BB 40  .*...5....О ...@</span><br><span class="line">E53E7DA0  4D C0 A4 C6 C4 D3 3E 66  17 66 36 2C D4 83 3C 2D  M......f.f6,ԃ &lt;-</span><br><span class="line">E53E7DB0  81 10 C8 07 0A D4 04 E2  8C 58 79 95 7C 96 D2 32  ..........y.|...</span><br><span class="line">E53E7DC0  05 6D 41 57 B0 CD C8 99  4F 45 3E 17 84 AE B8 72  .mAW....OE&gt;....r</span><br><span class="line">E53E7DD0  C5 6E 2B FB 5D 54 A6 A8  5C 51 D9 4A 9A 89 D1 D3  ..+.]T..\Q......</span><br><span class="line">E53E7DE0  83 DC 1C AC 70 9C 9E 57  E6 9F 1B FC BF C0 B7 F8  ....p..W........</span><br><span class="line">E53E7DF0  FC 99 7F DB A8 A1 9E C9  8B 8D 55 C8 EB 58 4C FC  .......ɋ .U..XL.</span><br><span class="line">E53E7E00  8B CB 7D 54 8F 6E BA CD  DD A0 C6 EB F0 9C BB 29  ...T.n..........</span><br><span class="line">E53E7E10  4D DA D8 02 14 58 B1 36  49 70 59 D0 1A AC DF 4A  M....X.6IpY.....</span><br></pre></td></tr></table></figure>

<p>组合密钥</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1631754963 9b69f861-e054-4bc4-9daf-d36ae205ed3e  //当前时间加APPkey</span><br></pre></td></tr></table></figure>

<p>RC4加密压缩后数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">.text:C881966C 11 99       LDR             R1, [SP,#0x44]</span><br><span class="line">.text:C881966E 0E 9E       LDR             R6, [SP,#0x38]</span><br><span class="line">.text:C8819670 8A 59       LDR             R2, [R1,R6]</span><br><span class="line">.text:C8819672 16 A8       ADD             R0, SP, #0x58 ; &#x27;X&#x27;</span><br><span class="line">.text:C8819674 1A F0 B0 FF BL              initkey_sub_C79725D8    ; R1:key 15525971099b69f861-e054-4bc4-9daf-d36ae205ed3e R2:长度0x2E</span><br><span class="line">.text:C8819678 10 9B       LDR             R3, [SP,#0x40]</span><br><span class="line">.text:C881967A 29 00       MOVS            R1, R5</span><br><span class="line">.text:C881967C 2A 00       MOVS            R2, R5</span><br><span class="line">.text:C881967E 1A F0 B2 FF BL              RC4_sub_C79725E6        ; R0:初始化的KEY，R1：压缩后数据,R3:压缩后大小</span><br><span class="line">.text:C8819682 11 98       LDR             R0, [SP,#0x44]</span><br></pre></td></tr></table></figure>

<p>加密后</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">E53E7D80  62 16 1F 8D D5 8D AF 42  8B D2 2C 32 77 29 5A 5F  b...Ս .B...2w)Z_</span><br><span class="line">E53E7D90  1B ED 38 9E F7 85 82 50  E0 FA D1 0A CD C4 6F 29  ..............o)</span><br><span class="line">E53E7DA0  69 0C FA 10 AE 63 57 E1  11 EA A4 DF 12 36 B2 4D  i....cW......6.M</span><br><span class="line">E53E7DB0  A0 A2 78 3B 5A 60 E6 AB  E9 4C A1 13 CD DB EB F0  ..x;Z`...L......</span><br><span class="line">E53E7DC0  1B FC 49 D2 6C CE 5A 96  C6 6B 71 45 80 8B 5D B7  ..I.......qE..].</span><br><span class="line">E53E7DD0  97 54 D5 58 0F F8 5E 68  25 CE 31 58 2D 04 C0 F2  .T....^h%..X-...</span><br><span class="line">E53E7DE0  70 E7 D4 2E E7 C9 2C DD  07 F2 7A F4 CA 06 F3 CB  p...............</span><br><span class="line">E53E7DF0  C3 CC 14 76 0A 44 2C 48  A2 35 6B 7D 0D 8C 51 60  ...v.D,H.5k&#125;..Q`</span><br><span class="line">E53E7E00  3F A9 F8 C6 D1 02 04 2B  A3 BF 86 3F 54 83 D4 43  ?......+...?T...</span><br><span class="line">E53E7E10  39 9C AB 66 0D DD 21 90  2B 73 B9 1F C3 C2 B8 86  9..f....+s......</span><br></pre></td></tr></table></figure>

<p>Base64加密</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">An2sai6nXEuFYeKbDUk/qEo/7am8Jtn3O2Has5efofCux7iubGRCS8TKpjUgotJ6MGdQrBsvwh/peZwuikT+5rCr4RzN8SXXCeDOtZQ6sbo/snVdESSJweNqd6i/WbIwDOgv5eaWRQoISjdgNfW3hk7tf0QhsZFbOELcPxz5pRzo6d6EsBLFu5Mq8DbVNgsYF+6aqZ7302/G+Rr7MlUT2M9y3EjgjH01L39q/eRJ</span><br></pre></td></tr></table></figure>

<h2 id="5-3、获取dfpid-设备指纹"><a href="#5-3、获取dfpid-设备指纹" class="headerlink" title="5.3、获取dfpid (设备指纹)"></a>5.3、获取dfpid (设备指纹)</h2><p>判断本地是否有存储，如果有优先读取本地，如果无反谢java层从服务器端获取，这部分详细分析见后面设备指纹部分。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br></pre></td><td class="code"><pre><span class="line">.text:C8A93C78 F0 B5       PUSH            &#123;R4-R7,LR&#125;</span><br><span class="line">.text:C8A93C7A 03 AF       ADD             R7, SP, #0xC</span><br><span class="line">.text:C8A93C7C 91 B0       SUB             SP, SP, #0x44</span><br><span class="line">.text:C8A93C7E 09 92       STR             R2, [SP,#0x50+var_2C]</span><br><span class="line">.text:C8A93C80 0A 91       STR             R1, [SP,#0x50+var_28]</span><br><span class="line">.text:C8A93C82 01 B4       PUSH            &#123;R0&#125;</span><br><span class="line">.text:C8A93C84 10 BC       POP             &#123;R4&#125;</span><br><span class="line">.text:C8A93C86 8E 48       LDR             R0, =(__stack_chk_guard_ptr - 0xC8A93C8C)</span><br><span class="line">.text:C8A93C88 78 44       ADD             R0, PC                  ; __stack_chk_guard_ptr</span><br><span class="line">.text:C8A93C8A 05 68       LDR             R5, [R0]                ; __stack_chk_guard</span><br><span class="line">.text:C8A93C8C 28 68       LDR             R0, [R5]</span><br><span class="line">.text:C8A93C8E 10 90       STR             R0, [SP,#0x50+var_10]</span><br><span class="line">.text:C8A93C90 20 00       MOVS            R0, R4</span><br><span class="line">.text:C8A93C92 00 F0 3F F9 BL              getClassLoader_sub_C6FD9F14</span><br><span class="line">.text:C8A93C96 00 26       MOVS            R6, #0</span><br><span class="line">.text:C8A93C98 00 28       CMP             R0, #0</span><br><span class="line">.text:C8A93C9A 00 D1       BNE             loc_C8A93C9E</span><br><span class="line">.text:C8A93C9C 06 E1       B               loc_C8A93EAC</span><br><span class="line">.text:C8A93C9E             ; ---------------------------------------------------------------------------</span><br><span class="line">.text:C8A93C9E</span><br><span class="line">.text:C8A93C9E             loc_C8A93C9E                            ; CODE XREF: main2_sub_B6891C78+22↑j</span><br><span class="line">.text:C8A93C9E 0B 90       STR             R0, [SP,#0x50+var_24]</span><br><span class="line">.text:C8A93CA0 F6 F7 EE FC BL              malloc_sub_C8BC6680</span><br><span class="line">.text:C8A93CA4 9C 21       MOVS            R1, #0x9C</span><br><span class="line">.text:C8A93CA6 41 58       LDR             R1, [R0,R1]             ; char *</span><br><span class="line">.text:C8A93CA8 0E AE       ADD             R6, SP, #0x50+var_18</span><br><span class="line">.text:C8A93CAA 0D AA       ADD             R2, SP, #0x50+var_1C</span><br><span class="line">.text:C8A93CAC 30 00       MOVS            R0, R6                  ; int</span><br><span class="line">.text:C8A93CAE 6F F0 F7 FF BL              basic_string_sub_B2943CA0</span><br><span class="line">.text:C8A93CB2 20 00       MOVS            R0, R4</span><br><span class="line">.text:C8A93CB4 31 00       MOVS            R1, R6</span><br><span class="line">.text:C8A93CB6 03 F0 35 FF BL              NewStringUTF_sub_C6B9DB24</span><br><span class="line">.text:C8A93CBA 26 00       MOVS            R6, R4</span><br><span class="line">.text:C8A93CBC 04 00       MOVS            R4, R0</span><br><span class="line">.text:C8A93CBE 0E 98       LDR             R0, [SP,#0x50+var_18]</span><br><span class="line">.text:C8A93CC0 0C 38       SUBS            R0, #0xC</span><br><span class="line">.text:C8A93CC2 0F A9       ADD             R1, SP, #0x50+var_14</span><br><span class="line">.text:C8A93CC4 6F F0 40 FD BL              free_sub_B2943748</span><br><span class="line">.text:C8A93CC8 0C 96       STR             R6, [SP,#0x50+var_20]</span><br><span class="line">.text:C8A93CCA 30 00       MOVS            R0, R6</span><br><span class="line">.text:C8A93CCC 07 F0 FC FD BL              ExceptionCheck_sub_C6BA18C8</span><br><span class="line">.text:C8A93CD0 00 26       MOVS            R6, #0</span><br><span class="line">.text:C8A93CD2 00 28       CMP             R0, #0</span><br><span class="line">.text:C8A93CD4 07 D0       BEQ             loc_C8A93CE6</span><br><span class="line">.text:C8A93CD6 00 2C       CMP             R4, #0</span><br><span class="line">.text:C8A93CD8 00 D1       BNE             loc_C8A93CDC</span><br><span class="line">.text:C8A93CDA E2 E0       B               loc_C8A93EA2</span><br><span class="line">.text:C8A93CDC             ; ---------------------------------------------------------------------------</span><br><span class="line">.text:C8A93CDC</span><br><span class="line">.text:C8A93CDC             loc_C8A93CDC                            ; CODE XREF: main2_sub_B6891C78+60↑j</span><br><span class="line">.text:C8A93CDC 08 94       STR             R4, [SP,#0x50+var_30]</span><br><span class="line">.text:C8A93CDE 07 95       STR             R5, [SP,#0x50+var_34]</span><br><span class="line">.text:C8A93CE0 00 26       MOVS            R6, #0</span><br><span class="line">.text:C8A93CE2 0C 9C       LDR             R4, [SP,#0x50+var_20]</span><br><span class="line">.text:C8A93CE4 D7 E0       B               loc_C8A93E96</span><br><span class="line">.text:C8A93CE6             ; ---------------------------------------------------------------------------</span><br><span class="line">.text:C8A93CE6</span><br><span class="line">.text:C8A93CE6             loc_C8A93CE6                            ; CODE XREF: main2_sub_B6891C78+5C↑j</span><br><span class="line">.text:C8A93CE6 00 2C       CMP             R4, #0</span><br><span class="line">.text:C8A93CE8 00 D1       BNE             loc_C8A93CEC</span><br><span class="line">.text:C8A93CEA DA E0       B               loc_C8A93EA2</span><br><span class="line">.text:C8A93CEC             ; ---------------------------------------------------------------------------</span><br><span class="line">.text:C8A93CEC</span><br><span class="line">.text:C8A93CEC             loc_C8A93CEC                            ; CODE XREF: main2_sub_B6891C78+70↑j</span><br><span class="line">.text:C8A93CEC 08 94       STR             R4, [SP,#0x50+var_30]</span><br><span class="line">.text:C8A93CEE 07 95       STR             R5, [SP,#0x50+var_34]</span><br><span class="line">.text:C8A93CF0 74 4E       LDR             R6, =(byte_C8B2D4E0 - 0xC8A93CF6)</span><br><span class="line">.text:C8A93CF2 7E 44       ADD             R6, PC                  ; byte_C8B2D4E0</span><br><span class="line">.text:C8A93CF4 30 78       LDRB            R0, [R6]</span><br><span class="line">.text:C8A93CF6 00 28       CMP             R0, #0</span><br><span class="line">.text:C8A93CF8 0A D1       BNE             loc_C8A93D10</span><br><span class="line">.text:C8A93CFA 73 4C       LDR             R4, =(aJavaLangClassl - 0xC8A93D00) ; &quot;java/lang/ClassLoader&quot;</span><br><span class="line">.text:C8A93CFC 7C 44       ADD             R4, PC                  ; &quot;java/lang/ClassLoader&quot;</span><br><span class="line">.text:C8A93CFE 73 49       LDR             R1, =(unk_C8B1E8A0 - 0xC8A93D04)</span><br><span class="line">.text:C8A93D00 79 44       ADD             R1, PC                  ; unk_C8B1E8A0</span><br><span class="line">.text:C8A93D02 00 25       MOVS            R5, #0</span><br><span class="line">.text:C8A93D04 15 23       MOVS            R3, #0x15</span><br><span class="line">.text:C8A93D06 20 00       MOVS            R0, R4</span><br><span class="line">.text:C8A93D08 2A 00       MOVS            R2, R5</span><br><span class="line">.text:C8A93D0A F7 F7 A9 F9 BL              DecString</span><br><span class="line">.text:C8A93D0E 65 75       STRB            R5, [R4,#(aJavaLangClassl+0x15 - 0xC8B1E489)] ; &quot;&quot;</span><br><span class="line">.text:C8A93D10</span><br><span class="line">.text:C8A93D10             loc_C8A93D10                            ; CODE XREF: main2_sub_B6891C78+80↑j</span><br><span class="line">.text:C8A93D10 01 20       MOVS            R0, #1</span><br><span class="line">.text:C8A93D12 06 90       STR             R0, [SP,#0x50+var_38]</span><br><span class="line">.text:C8A93D14 30 70       STRB            R0, [R6]</span><br><span class="line">.text:C8A93D16 0C 9C       LDR             R4, [SP,#0x50+var_20]</span><br><span class="line">.text:C8A93D18 20 68       LDR             R0, [R4]</span><br><span class="line">.text:C8A93D1A 82 69       LDR             R2, [R0,#0x18]</span><br><span class="line">.text:C8A93D1C 6C 49       LDR             R1, =(aJavaLangClassl - 0xC8A93D22) ; &quot;java/lang/ClassLoader&quot;</span><br><span class="line">.text:C8A93D1E 79 44       ADD             R1, PC                  ; &quot;java/lang/ClassLoader&quot;</span><br><span class="line">.text:C8A93D20 20 00       MOVS            R0, R4</span><br><span class="line">.text:C8A93D22 90 47       BLX             R2</span><br><span class="line">.text:C8A93D24 05 00       MOVS            R5, R0</span><br><span class="line">.text:C8A93D26 20 00       MOVS            R0, R4</span><br><span class="line">.text:C8A93D28 07 F0 CE FD BL              ExceptionCheck_sub_C6BA18C8</span><br><span class="line">.text:C8A93D2C 00 26       MOVS            R6, #0</span><br><span class="line">.text:C8A93D2E 00 28       CMP             R0, #0</span><br><span class="line">.text:C8A93D30 05 D0       BEQ             loc_C8A93D3E</span><br><span class="line">.text:C8A93D32 00 2D       CMP             R5, #0</span><br><span class="line">.text:C8A93D34 20 B4       PUSH            &#123;R5&#125;</span><br><span class="line">.text:C8A93D36 02 BC       POP             &#123;R1&#125;</span><br><span class="line">.text:C8A93D38 00 D0       BEQ             loc_C8A93D3C</span><br><span class="line">.text:C8A93D3A A8 E0       B               loc_C8A93E8E</span><br><span class="line">.text:C8A93D3C             ; ---------------------------------------------------------------------------</span><br><span class="line">.text:C8A93D3C</span><br><span class="line">.text:C8A93D3C             loc_C8A93D3C                            ; CODE XREF: main2_sub_B6891C78+C0↑j</span><br><span class="line">.text:C8A93D3C AB E0       B               loc_C8A93E96</span><br><span class="line">.text:C8A93D3E             ; ---------------------------------------------------------------------------</span><br><span class="line">.text:C8A93D3E</span><br><span class="line">.text:C8A93D3E             loc_C8A93D3E                            ; CODE XREF: main2_sub_B6891C78+B8↑j</span><br><span class="line">.text:C8A93D3E 00 2D       CMP             R5, #0</span><br><span class="line">.text:C8A93D40 00 D1       BNE             loc_C8A93D44</span><br><span class="line">.text:C8A93D42 A8 E0       B               loc_C8A93E96</span><br><span class="line">.text:C8A93D44             ; ---------------------------------------------------------------------------</span><br><span class="line">.text:C8A93D44</span><br><span class="line">.text:C8A93D44             loc_C8A93D44                            ; CODE XREF: main2_sub_B6891C78+C8↑j</span><br><span class="line">.text:C8A93D44 05 95       STR             R5, [SP,#0x50+var_3C]</span><br><span class="line">.text:C8A93D46 63 4E       LDR             R6, =(byte_C8B2D4E1 - 0xC8A93D4C)</span><br><span class="line">.text:C8A93D48 7E 44       ADD             R6, PC                  ; byte_C8B2D4E1</span><br><span class="line">.text:C8A93D4A 30 78       LDRB            R0, [R6]</span><br><span class="line">.text:C8A93D4C 00 28       CMP             R0, #0</span><br><span class="line">.text:C8A93D4E 0A D1       BNE             loc_C8A93D66</span><br><span class="line">.text:C8A93D50 61 4D       LDR             R5, =(aLoadclass - 0xC8A93D56) ; &quot;loadClass&quot;</span><br><span class="line">.text:C8A93D52 7D 44       ADD             R5, PC                  ; &quot;loadClass&quot;</span><br><span class="line">.text:C8A93D54 61 49       LDR             R1, =(aMkfnnRej - 0xC8A93D5A) ; &quot;mkfnN|rej&quot;</span><br><span class="line">.text:C8A93D56 79 44       ADD             R1, PC                  ; &quot;mkfnN|rej&quot;</span><br><span class="line">.text:C8A93D58 01 22       MOVS            R2, #1</span><br><span class="line">.text:C8A93D5A 09 23       MOVS            R3, #9</span><br><span class="line">.text:C8A93D5C 28 00       MOVS            R0, R5</span><br><span class="line">.text:C8A93D5E F7 F7 7F F9 BL              DecString</span><br><span class="line">.text:C8A93D62 00 20       MOVS            R0, #0</span><br><span class="line">.text:C8A93D64 68 72       STRB            R0, [R5,#(aLoadclass+9 - 0xC8B1E49F)] ; &quot;&quot;</span><br><span class="line">.text:C8A93D66</span><br><span class="line">.text:C8A93D66             loc_C8A93D66                            ; CODE XREF: main2_sub_B6891C78+D6↑j</span><br><span class="line">.text:C8A93D66 06 9D       LDR             R5, [SP,#0x50+var_38]</span><br><span class="line">.text:C8A93D68 35 70       STRB            R5, [R6]</span><br><span class="line">.text:C8A93D6A 5D 4E       LDR             R6, =(byte_C8B2D4E2 - 0xC8A93D70)</span><br><span class="line">.text:C8A93D6C 7E 44       ADD             R6, PC                  ; byte_C8B2D4E2</span><br><span class="line">.text:C8A93D6E 30 78       LDRB            R0, [R6]</span><br><span class="line">.text:C8A93D70 00 28       CMP             R0, #0</span><br><span class="line">.text:C8A93D72 0E D1       BNE             loc_C8A93D92</span><br><span class="line">.text:C8A93D74 5B 48       LDR             R0, =(aLjavaLangStrin - 0xC8A93D7A) ; &quot;(Ljava/lang/String;)Ljava/lang/Class;&quot;</span><br><span class="line">.text:C8A93D76 78 44       ADD             R0, PC                  ; &quot;(Ljava/lang/String;)Ljava/lang/Class;&quot;</span><br><span class="line">.text:C8A93D78 03 90       STR             R0, [SP,#0x50+var_44]</span><br><span class="line">.text:C8A93D7A 5B 49       LDR             R1, =(unk_C8B1E8C0 - 0xC8A93D80)</span><br><span class="line">.text:C8A93D7C 79 44       ADD             R1, PC                  ; unk_C8B1E8C0</span><br><span class="line">.text:C8A93D7E 02 22       MOVS            R2, #2</span><br><span class="line">.text:C8A93D80 25 23       MOVS            R3, #0x25 ; &#x27;%&#x27;</span><br><span class="line">.text:C8A93D82 04 93       STR             R3, [SP,#0x50+var_40]</span><br><span class="line">.text:C8A93D84 04 9B       LDR             R3, [SP,#0x50+var_40]</span><br><span class="line">.text:C8A93D86 F7 F7 6B F9 BL              DecString</span><br><span class="line">.text:C8A93D8A 00 20       MOVS            R0, #0</span><br><span class="line">.text:C8A93D8C 04 99       LDR             R1, [SP,#0x50+var_40]</span><br><span class="line">.text:C8A93D8E 03 9A       LDR             R2, [SP,#0x50+var_44]</span><br><span class="line">.text:C8A93D90 50 54       STRB            R0, [R2,R1]</span><br><span class="line">.text:C8A93D92</span><br><span class="line">.text:C8A93D92             loc_C8A93D92                            ; CODE XREF: main2_sub_B6891C78+FA↑j</span><br><span class="line">.text:C8A93D92 35 70       STRB            R5, [R6]</span><br><span class="line">.text:C8A93D94 20 68       LDR             R0, [R4]</span><br><span class="line">.text:C8A93D96 84 21       MOVS            R1, #0x84</span><br><span class="line">.text:C8A93D98 46 58       LDR             R6, [R0,R1]</span><br><span class="line">.text:C8A93D9A 54 4A       LDR             R2, =(aLoadclass - 0xC8A93DA0) ; &quot;loadClass&quot;</span><br><span class="line">.text:C8A93D9C 7A 44       ADD             R2, PC                  ; &quot;loadClass&quot;</span><br><span class="line">.text:C8A93D9E 54 4B       LDR             R3, =(aLjavaLangStrin - 0xC8A93DA4) ; &quot;(Ljava/lang/String;)Ljava/lang/Class;&quot;</span><br><span class="line">.text:C8A93DA0 7B 44       ADD             R3, PC                  ; &quot;(Ljava/lang/String;)Ljava/lang/Class;&quot;</span><br><span class="line">.text:C8A93DA2 20 00       MOVS            R0, R4</span><br><span class="line">.text:C8A93DA4 05 99       LDR             R1, [SP,#0x50+var_3C]</span><br><span class="line">.text:C8A93DA6 B0 47       BLX             R6</span><br><span class="line">.text:C8A93DA8 05 00       MOVS            R5, R0</span><br><span class="line">.text:C8A93DAA 20 00       MOVS            R0, R4</span><br><span class="line">.text:C8A93DAC 07 F0 8C FD BL              ExceptionCheck_sub_C6BA18C8</span><br><span class="line">.text:C8A93DB0 00 26       MOVS            R6, #0</span><br><span class="line">.text:C8A93DB2 00 28       CMP             R0, #0</span><br><span class="line">.text:C8A93DB4 6A D1       BNE             loc_C8A93E8C</span><br><span class="line">.text:C8A93DB6 00 2D       CMP             R5, #0</span><br><span class="line">.text:C8A93DB8 68 D0       BEQ             loc_C8A93E8C</span><br><span class="line">.text:C8A93DBA 20 00       MOVS            R0, R4</span><br><span class="line">.text:C8A93DBC 0B 99       LDR             R1, [SP,#0x50+var_24]</span><br><span class="line">.text:C8A93DBE 2A 00       MOVS            R2, R5</span><br><span class="line">.text:C8A93DC0 08 9B       LDR             R3, [SP,#0x50+var_30]</span><br><span class="line">.text:C8A93DC2 00 F0 13 F9 BL              CallObjectMethodV_sub_C6B99FEC</span><br><span class="line">.text:C8A93DC6 05 00       MOVS            R5, R0</span><br><span class="line">.text:C8A93DC8 20 00       MOVS            R0, R4</span><br><span class="line">.text:C8A93DCA 07 F0 7D FD BL              ExceptionCheck_sub_C6BA18C8</span><br><span class="line">.text:C8A93DCE 00 28       CMP             R0, #0</span><br><span class="line">.text:C8A93DD0 04 D0       BEQ             loc_C8A93DDC</span><br><span class="line">.text:C8A93DD2 00 26       MOVS            R6, #0</span><br><span class="line">.text:C8A93DD4 00 2D       CMP             R5, #0</span><br><span class="line">.text:C8A93DD6 05 99       LDR             R1, [SP,#0x50+var_3C]</span><br><span class="line">.text:C8A93DD8 53 D1       BNE             loc_C8A93E82</span><br><span class="line">.text:C8A93DDA 58 E0       B               loc_C8A93E8E</span><br><span class="line">.text:C8A93DDC             ; ---------------------------------------------------------------------------</span><br><span class="line">.text:C8A93DDC</span><br><span class="line">.text:C8A93DDC             loc_C8A93DDC                            ; CODE XREF: main2_sub_B6891C78+158↑j</span><br><span class="line">.text:C8A93DDC 00 2D       CMP             R5, #0</span><br><span class="line">.text:C8A93DDE 05 99       LDR             R1, [SP,#0x50+var_3C]</span><br><span class="line">.text:C8A93DE0 55 D0       BEQ             loc_C8A93E8E</span><br><span class="line">.text:C8A93DE2 04 95       STR             R5, [SP,#0x50+var_40]</span><br><span class="line">.text:C8A93DE4 43 4E       LDR             R6, =(byte_C8B2D4E3 - 0xC8A93DEA)</span><br><span class="line">.text:C8A93DE6 7E 44       ADD             R6, PC                  ; byte_C8B2D4E3</span><br><span class="line">.text:C8A93DE8 30 78       LDRB            R0, [R6]</span><br><span class="line">.text:C8A93DEA 00 28       CMP             R0, #0</span><br><span class="line">.text:C8A93DEC 0A D1       BNE             loc_C8A93E04</span><br><span class="line">.text:C8A93DEE 42 4D       LDR             R5, =(aMain2 - 0xC8A93DF4) ; &quot;main2&quot;</span><br><span class="line">.text:C8A93DF0 7D 44       ADD             R5, PC                  ; &quot;main2&quot;</span><br><span class="line">.text:C8A93DF2 42 49       LDR             R1, =(aNgB - 0xC8A93DF8) ; &quot;ng`b=&quot;</span><br><span class="line">.text:C8A93DF4 79 44       ADD             R1, PC                  ; &quot;ng`b=&quot;</span><br><span class="line">.text:C8A93DF6 03 22       MOVS            R2, #3</span><br><span class="line">.text:C8A93DF8 05 23       MOVS            R3, #5</span><br><span class="line">.text:C8A93DFA 28 00       MOVS            R0, R5</span><br><span class="line">.text:C8A93DFC F7 F7 30 F9 BL              DecString</span><br><span class="line">.text:C8A93E00 00 20       MOVS            R0, #0</span><br><span class="line">.text:C8A93E02 68 71       STRB            R0, [R5,#(aMain2+5 - 0xC8B1E4CF)] ; &quot;&quot;</span><br><span class="line">.text:C8A93E04</span><br><span class="line">.text:C8A93E04             loc_C8A93E04                            ; CODE XREF: main2_sub_B6891C78+174↑j</span><br><span class="line">.text:C8A93E04 06 9D       LDR             R5, [SP,#0x50+var_38]</span><br><span class="line">.text:C8A93E06 35 70       STRB            R5, [R6]</span><br><span class="line">.text:C8A93E08 3D 4E       LDR             R6, =(byte_C8B2D4E4 - 0xC8A93E0E)</span><br><span class="line">.text:C8A93E0A 7E 44       ADD             R6, PC                  ; byte_C8B2D4E4</span><br><span class="line">.text:C8A93E0C 30 78       LDRB            R0, [R6]</span><br><span class="line">.text:C8A93E0E 00 28       CMP             R0, #0</span><br><span class="line">.text:C8A93E10 0E D1       BNE             loc_C8A93E30</span><br><span class="line">.text:C8A93E12 3C 48       LDR             R0, =(aILjavaLangObje_0 - 0xC8A93E18) ; &quot;(I[Ljava/lang/Object;)Ljava/lang/Object&quot;...</span><br><span class="line">.text:C8A93E14 78 44       ADD             R0, PC                  ; &quot;(I[Ljava/lang/Object;)Ljava/lang/Object&quot;...</span><br><span class="line">.text:C8A93E16 02 90       STR             R0, [SP,#0x50+var_48]</span><br><span class="line">.text:C8A93E18 3B 49       LDR             R1, =(unk_C8B1E8F0 - 0xC8A93E1E)</span><br><span class="line">.text:C8A93E1A 79 44       ADD             R1, PC                  ; unk_C8B1E8F0</span><br><span class="line">.text:C8A93E1C 04 22       MOVS            R2, #4</span><br><span class="line">.text:C8A93E1E 28 23       MOVS            R3, #0x28 ; &#x27;(&#x27;</span><br><span class="line">.text:C8A93E20 03 93       STR             R3, [SP,#0x50+var_44]</span><br><span class="line">.text:C8A93E22 03 9B       LDR             R3, [SP,#0x50+var_44]</span><br><span class="line">.text:C8A93E24 F7 F7 1C F9 BL              DecString</span><br><span class="line">.text:C8A93E28 00 20       MOVS            R0, #0</span><br><span class="line">.text:C8A93E2A 03 99       LDR             R1, [SP,#0x50+var_44]</span><br><span class="line">.text:C8A93E2C 02 9A       LDR             R2, [SP,#0x50+var_48]</span><br><span class="line">.text:C8A93E2E 50 54       STRB            R0, [R2,R1]</span><br><span class="line">.text:C8A93E30</span><br><span class="line">.text:C8A93E30             loc_C8A93E30                            ; CODE XREF: main2_sub_B6891C78+198↑j</span><br><span class="line">.text:C8A93E30 35 70       STRB            R5, [R6]</span><br><span class="line">.text:C8A93E32 71 20 80 00 MOVS            R0, #0x1C4</span><br><span class="line">.text:C8A93E36 21 68       LDR             R1, [R4]</span><br><span class="line">.text:C8A93E38 0D 58       LDR             R5, [R1,R0]</span><br><span class="line">.text:C8A93E3A 34 4A       LDR             R2, =(aMain2 - 0xC8A93E40) ; &quot;main2&quot;</span><br><span class="line">.text:C8A93E3C 7A 44       ADD             R2, PC                  ; &quot;main2&quot;</span><br><span class="line">.text:C8A93E3E 34 4B       LDR             R3, =(aILjavaLangObje_0 - 0xC8A93E44) ; &quot;(I[Ljava/lang/Object;)Ljava/lang/Object&quot;...</span><br><span class="line">.text:C8A93E40 7B 44       ADD             R3, PC                  ; &quot;(I[Ljava/lang/Object;)Ljava/lang/Object&quot;...</span><br><span class="line">.text:C8A93E42 20 00       MOVS            R0, R4</span><br><span class="line">.text:C8A93E44 04 99       LDR             R1, [SP,#0x50+var_40]</span><br><span class="line">.text:C8A93E46 A8 47       BLX             R5</span><br><span class="line">.text:C8A93E48 05 00       MOVS            R5, R0</span><br><span class="line">.text:C8A93E4A 20 00       MOVS            R0, R4</span><br><span class="line">.text:C8A93E4C 07 F0 3C FD BL              ExceptionCheck_sub_C6BA18C8</span><br><span class="line">.text:C8A93E50 00 26       MOVS            R6, #0</span><br><span class="line">.text:C8A93E52 00 28       CMP             R0, #0</span><br><span class="line">.text:C8A93E54 14 D1       BNE             loc_C8A93E80</span><br><span class="line">.text:C8A93E56 2A 00       MOVS            R2, R5</span><br><span class="line">.text:C8A93E58 00 2D       CMP             R5, #0</span><br><span class="line">.text:C8A93E5A 04 9D       LDR             R5, [SP,#0x50+var_40]</span><br><span class="line">.text:C8A93E5C 11 D0       BEQ             loc_C8A93E82</span><br><span class="line">.text:C8A93E5E 68 46       MOV             R0, SP</span><br><span class="line">.text:C8A93E60 09 99       LDR             R1, [SP,#0x50+var_2C]</span><br><span class="line">.text:C8A93E62 01 60       STR             R1, [R0,#0x50+var_50]</span><br><span class="line">.text:C8A93E64 20 00       MOVS            R0, R4</span><br><span class="line">.text:C8A93E66 29 00       MOVS            R1, R5</span><br><span class="line">.text:C8A93E68 0A 9B       LDR             R3, [SP,#0x50+var_28]</span><br><span class="line">.text:C8A93E6A 00 F0 DD F8 BL              CallStaticObjectMethodV_sub_B6892028</span><br><span class="line">.text:C8A93E6E 0A 90       STR             R0, [SP,#0x50+var_28]</span><br><span class="line">.text:C8A93E70 20 00       MOVS            R0, R4</span><br><span class="line">.text:C8A93E72 07 F0 29 FD BL              ExceptionCheck_sub_C6BA18C8</span><br><span class="line">.text:C8A93E76 00 26       MOVS            R6, #0</span><br><span class="line">.text:C8A93E78 00 28       CMP             R0, #0</span><br><span class="line">.text:C8A93E7A 02 D1       BNE             loc_C8A93E82</span><br><span class="line">.text:C8A93E7C 0A 9E       LDR             R6, [SP,#0x50+var_28]</span><br><span class="line">.text:C8A93E7E 00 E0       B               loc_C8A93E82</span><br><span class="line">.text:C8A93E80             ; ---------------------------------------------------------------------------</span><br><span class="line">.text:C8A93E80</span><br><span class="line">.text:C8A93E80             loc_C8A93E80                            ; CODE XREF: main2_sub_B6891C78+1DC↑j</span><br><span class="line">.text:C8A93E80 04 9D       LDR             R5, [SP,#0x50+var_40]</span><br><span class="line">.text:C8A93E82</span><br><span class="line">.text:C8A93E82             loc_C8A93E82                            ; CODE XREF: main2_sub_B6891C78+160↑j</span><br><span class="line">.text:C8A93E82                                                     ; main2_sub_B6891C78+1E4↑j ...</span><br><span class="line">.text:C8A93E82 20 68       LDR             R0, [R4]</span><br><span class="line">.text:C8A93E84 C2 6D       LDR             R2, [R0,#0x5C]</span><br><span class="line">.text:C8A93E86 20 00       MOVS            R0, R4</span><br><span class="line">.text:C8A93E88 29 00       MOVS            R1, R5</span><br><span class="line">.text:C8A93E8A 90 47       BLX             R2</span><br><span class="line">.text:C8A93E8C</span><br><span class="line">.text:C8A93E8C             loc_C8A93E8C                            ; CODE XREF: main2_sub_B6891C78+13C↑j</span><br><span class="line">.text:C8A93E8C                                                     ; main2_sub_B6891C78+140↑j</span><br><span class="line">.text:C8A93E8C 05 99       LDR             R1, [SP,#0x50+var_3C]</span><br></pre></td></tr></table></figure>

<p>获取到的dfpid如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DAD796C46B5A6525F4B89DF661A97C7A218A219FC24B93F689DEBD92</span><br></pre></td></tr></table></figure>

<h2 id="5-4、获取xid-设备指纹"><a href="#5-4、获取xid-设备指纹" class="headerlink" title="5.4、获取xid (设备指纹)"></a>5.4、获取xid (设备指纹)</h2><p>判断本地是否有存储，如果有优先读取本地，如果无反谢java层从服务器端获取，APP第一次运行进就用UUID与时间加密生成一个，这部分详细分析见后面设备指纹部分。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">.text:C8AEE3A4 F0 B5       PUSH            &#123;R4-R7,LR&#125;</span><br><span class="line">.text:C8AEE3A6 03 AF       ADD             R7, SP, #0xC</span><br><span class="line">.text:C8AEE3A8 81 B0       SUB             SP, SP, #4</span><br><span class="line">.text:C8AEE3AA 0C 00       MOVS            R4, R1</span><br><span class="line">.text:C8AEE3AC 06 00       MOVS            R6, R0</span><br><span class="line">.text:C8AEE3AE 00 23       MOVS            R3, #0</span><br><span class="line">.text:C8AEE3B0 20 00       MOVS            R0, R4</span><br><span class="line">.text:C8AEE3B2 11 00       MOVS            R1, R2</span><br><span class="line">.text:C8AEE3B4 1A 00       MOVS            R2, R3</span><br><span class="line">.text:C8AEE3B6 A5 F7 5F FC BL              main2_sub_B6891C78 ; 反射调用java层</span><br><span class="line">.text:C8AEE3BA 05 00       MOVS            R5, R0</span><br><span class="line">.text:C8AEE3BC 20 00       MOVS            R0, R4</span><br><span class="line">.text:C8AEE3BE AD F7 83 FA BL              ExceptionCheck_sub_C6BA18C8</span><br><span class="line">.text:C8AEE3C2 00 28       CMP             R0, #0</span><br><span class="line">.text:C8AEE3C4 09 D0       BEQ             loc_C8AEE3DA</span><br><span class="line">.text:C8AEE3C6 9C F7 5B F9 BL              malloc_sub_C8BC6680</span><br><span class="line">.text:C8AEE3CA 01 00       MOVS            R1, R0</span><br><span class="line">.text:C8AEE3CC 7C 31       ADDS            R1, #0x7C ; &#x27;|&#x27;</span><br><span class="line">.text:C8AEE3CE 30 00       MOVS            R0, R6</span><br><span class="line">.text:C8AEE3D0 15 F0 30 FA BL              empty_sub_C6C09834</span><br><span class="line">.text:C8AEE3D4 00 2D       CMP             R5, #0</span><br><span class="line">.text:C8AEE3D6 07 D1       BNE             loc_C8AEE3E8</span><br><span class="line">.text:C8AEE3D8 13 E0       B               loc_C8AEE402</span><br><span class="line">.text:C8AEE3DA             ; ---------------------------------------------------------------------------</span><br><span class="line">.text:C8AEE3DA</span><br><span class="line">.text:C8AEE3DA             loc_C8AEE3DA                            ; CODE XREF: main2_sub_B292E3A4+20↑j</span><br><span class="line">.text:C8AEE3DA 00 2D       CMP             R5, #0</span><br><span class="line">.text:C8AEE3DC 0A D0       BEQ             loc_C8AEE3F4</span><br><span class="line">.text:C8AEE3DE 30 00       MOVS            R0, R6</span><br><span class="line">.text:C8AEE3E0 21 00       MOVS            R1, R4</span><br><span class="line">.text:C8AEE3E2 2A 00       MOVS            R2, R5</span><br><span class="line">.text:C8AEE3E4 A9 F7 CE FC BL              String_sub_B28D7D84     ; 出现字符串</span><br></pre></td></tr></table></figure>

<p>获取到的xid如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Rs8NOy0BFS5JQxfdOoIxpMnKV3iqYWcblAjp0vpnWZyNzyF9rfsi3ekpm4ScaIZgeImizX/5AbS3e838Or4el4+PPPI2kD8XW+8vbvjDBSM=</span><br></pre></td></tr></table></figure>

<p>组合json</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;a0&quot;</span>: <span class="string">&quot;2.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;a1&quot;</span>: <span class="string">&quot;9b69f861-e054-4bc4-9daf-d36ae205ed3e&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;a3&quot;</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="attr">&quot;a4&quot;</span>: <span class="number">1631754963</span>,</span><br><span class="line">    <span class="attr">&quot;a5&quot;</span>: <span class="string">&quot;An2sai6nXEuFYeKbDUk/qEo/7am8Jtn3O2Has5efofCux7iubGRCS8TKpjUgotJ6MGdQrBsvwh/peZwuikT+5rCr4RzN8SXXCeDOtZQ6sbo/snVdESSJweNqd6i/WbIwDOgv5eaWRQoISjdgNfW3hk7tf0QhsZFbOELcPxz5pRzo6d6EsBLFu5Mq8DbVNgsYF+6aqZ7302/G+Rr7MlUT2M9y3EjgjH01L39q/eRJ&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;a6&quot;</span>: <span class="number">1025</span>,</span><br><span class="line">    <span class="attr">&quot;a7&quot;</span>: <span class="string">&quot;Rs8NOy0BFS5JQxfdOoIxpMnKV3iqYWcblAjp0vpnWZyNzyF9rfsi3ekpm4ScaIZgeImizX/5AbS3e838Or4el4+PPPI2kD8XW+8vbvjDBSM=&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;a8&quot;</span>: <span class="string">&quot;DAD796C46B5A6525F4B89DF661A97C7A218A219FC24B93F689DEBD92&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;a9&quot;</span>: <span class="string">&quot;f4ec12efNkQBqdtVlV78x1/Mln2Us/xw171NuJjdEXrGWsFDdMV5Te45wqjL0nPO8OFFKjvKthvva+lS9xqhMhSt1WZRjDYpsWc/eh3z4F2JTv3MOh8NEDmk7Frthx5/bczdDIKvRP0QneTfNKSm116fUjdLhOEYlNbym/xI+5jZAEJGfGjltFLEOmtOwgxasgHQh2woMl/vAyr7ePuoVC6wEcbv2+w6n/+Pl1U1KO2YcTw4peiZDqC7iHpTVQH4fWri9R5+Ev1zx/xObVqoxqe3TEW/t2EIRqQ4QoRZRix0xC6C280faz8U5vOqafUnm+qev7tjs7SOV4SNxBv+LEJTxr5IJU302FJEk/CqhKoz5eWRYtT5Z52kEanlfu4AGHcJLC343kpI3GxYw7uPeewA/Ye0qDgZUyfj0MPpaYMPj0UmtvnbXEU4+FaRaCb/LsQtWdOtEiEKveUQU9bTW4NfHch2+6gcHP2/E+UQSlREX67PPa9XN8tgL4H6qzghiE1NL3gYw0rrjzEXiO6jsjvIdzwDjeab9woJyr8W3xSACz3sezUS+AJAKohnJvlQkFM9cdG3lPYS7gByAK++K2/vI714kxJHqCZQQMbVNsoWj5w64YL+sE1A4byzOPgK71oPb9w6Cb+KwVlDtqH8F5vlVkO23Iq8E28BI2vQuq5TLRzMunjo45Ks2Py9ZZuHkGb+QIVpUz6ViB+JlUONKinIJF1p6g==&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;a10&quot;</span>: <span class="string">&quot;&#123;&#125;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;x0&quot;</span>: <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>每一个字段的解释：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0:版本，a1:appkey, a3:版本,a4:时间,a5:加密的设备环境,a6:固定数字,a7:xid,a8:dfpid,a9:初始化时加密的设备环境信息(前8字符中CRC:f4ec12ef)</span><br></pre></td></tr></table></figure>

<h2 id="5-5、计算请求体签名值"><a href="#5-5、计算请求体签名值" class="headerlink" title="5.5、计算请求体签名值"></a>5.5、计算请求体签名值</h2><p>获取请求体数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">.text:C8A8FA4C 29 68       LDR             R1, [R5]</span><br><span class="line">.text:C8A8FA4E 0A 58       LDR             R2, [R1,R0]</span><br><span class="line">.text:C8A8FA50 28 00       MOVS            R0, R5</span><br><span class="line">.text:C8A8FA52 31 00       MOVS            R1, R6</span><br><span class="line">.text:C8A8FA54 90 47       BLX             R2                      ; 获取body长度</span><br><span class="line">.text:C8A8FA56 0A 90       STR             R0, [SP,#0x28]</span><br><span class="line">.text:C8A8FA58 28 00       MOVS            R0, R5</span><br><span class="line">.text:C8A8FA5A 0B F0 35 FF BL              ExceptionCheck_sub_C6BA18C8</span><br><span class="line">.text:C8A8FA5E 00 28       CMP             R0, #0</span><br><span class="line"> </span><br><span class="line">.text:C8A8FAF0 00 00       MOVS            R0, R0</span><br><span class="line">.text:C8A8FAF2 00 00       MOVS            R0, R0</span><br><span class="line">.text:C8A8FAF4 D8 74       STRB            R0, [R3,#0x13]</span><br><span class="line">.text:C8A8FAF6 86 1B       SUBS            R6, R0, R6</span><br><span class="line">.text:C8A8FAF8 10 99       LDR             R1, [SP,#0xC+arg_34]    ; 获取body</span><br><span class="line">.text:C8A8FAFA 0B 20       MOVS            R0, #0xB</span><br><span class="line">.text:C8A8FAFC C2 43       MVNS            R2, R0</span><br><span class="line">.text:C8A8FAFE 03 91       STR             R1, [SP,#0xC+arg_0]</span><br><span class="line">.text:C8A8FB00 08 68       LDR             R0, [R1]</span><br><span class="line">.text:C8A8FB02 02 92       STR             R2, [SP,#0xC+var_4]</span><br><span class="line">.text:C8A8FB04 80 58       LDR             R0, [R0,R2]</span><br><span class="line">.text:C8A8FB06 0A 9C       LDR             R4, [SP,#0xC+arg_1C]</span><br><span class="line">.text:C8A8FB08 00 19       ADDS            R0, R0, R4</span><br><span class="line">.text:C8A8FB0A 04 90       STR             R0, [SP,#0xC+arg_4]</span><br><span class="line">.text:C8A8FB0C 46 1C       ADDS            R6, R0, #1</span><br><span class="line">.text:C8A8FB0E 30 00       MOVS            R0, R6</span><br><span class="line">.text:C8A8FB10 FA F7 EA E8 BLX             malloc                  ; 分配body存储空间</span><br><span class="line">.text:C8A8FB14 00 21       MOVS            R1, #0</span><br><span class="line">.text:C8A8FB16 06 91       STR             R1, [SP,#0xC+arg_C]</span><br><span class="line">.text:C8A8FB18 32 00       MOVS            R2, R6</span><br><span class="line">.text:C8A8FB1A 06 00       MOVS            R6, R0</span><br><span class="line">.text:C8A8FB1C 20 F0 D0 FC BL              memset_sub_C6BB64C0</span><br><span class="line">.text:C8A8FB20 19 20 40 01 MOVS            R0, #0x320</span><br><span class="line">.text:C8A8FB24 29 68       LDR             R1, [R5]</span><br><span class="line">.text:C8A8FB26 08 58       LDR             R0, [R1,R0]</span><br><span class="line">.text:C8A8FB28 05 90       STR             R0, [SP,#0xC+arg_8]</span><br><span class="line">.text:C8A8FB2A 68 46       MOV             R0, SP</span><br><span class="line">.text:C8A8FB2C 06 60       STR             R6, [R0,#0xC+var_C]</span><br><span class="line">.text:C8A8FB2E 28 00       MOVS            R0, R5</span><br><span class="line">.text:C8A8FB30 07 99       LDR             R1, [SP,#0xC+arg_10]</span><br><span class="line">.text:C8A8FB32 06 9A       LDR             R2, [SP,#0xC+arg_C]</span><br><span class="line">.text:C8A8FB34 23 00       MOVS            R3, R4</span><br><span class="line">.text:C8A8FB36 05 9C       LDR             R4, [SP,#0xC+arg_8]</span><br><span class="line">.text:C8A8FB38 A0 47       BLX             R4                      ; GetByteArrayRegion</span><br><span class="line">.text:C8A8FB38                                                     ; 获取要计算签名的body值</span><br><span class="line">.text:C8A8FB3A 28 00       MOVS            R0, R5</span><br><span class="line">.text:C8A8FB3C 0B F0 C4 FE BL              ExceptionCheck_sub_C6BA18C8</span><br><span class="line">.text:C8A8FB40 00 28       CMP             R0, #0</span><br></pre></td></tr></table></figure>

<p>获取的数据(部分)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">CB092000  50 4F 53 54 20 2F 76 35  2F 73 69 67 6E 20 7B 22  POST /v5/sign &#123;&quot;</span><br><span class="line">CB092010  64 61 74 61 22 3A 22 62  4A 62 50 67 72 4B 49 42  data&quot;:&quot;bJbPgrKIB</span><br><span class="line">CB092020  6A 6D 4E 4E 2B 6B 63 30  39 66 66 6F 54 70 67 48  jmNN+kc09ffoTpgH</span><br><span class="line">CB092030  57 39 57 46 7A 43 6B 67  75 4D 4E 71 50 52 57 68  W9WFzCkguMNqPRWh</span><br><span class="line">CB092040  6A 70 41 67 2B 4E 62 45  70 76 47 62 44 42 54 47  jpAg+NbEpvGbDBTG</span><br><span class="line">CB092050  6E 79 31 38 6C 6C 39 38  75 43 37 44 68 67 2B 33  ny18ll98uC7Dhg+3</span><br><span class="line">CB092060  56 44 39 31 62 38 50 67  67 47 2F 47 56 61 52 59  VD91b8PggG/GVaRY</span><br><span class="line">CB092070  71 4D 4C 37 33 36 30 6E  63 71 41 59 57 37 68 4A  qML7360ncqAYW7hJ</span><br><span class="line">CB092080  4A 52 69 34 44 59 73 50  31 66 73 59 35 38 4F 79  JRi4DYsP1fsY58Oy</span><br></pre></td></tr></table></figure>

<p>解密PIC数据获取key (a7),解密流程与初始化时一样。解密后的值</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;a1&quot;</span>:<span class="number">0</span>,<span class="attr">&quot;a10&quot;</span>:<span class="number">400</span>,<span class="attr">&quot;a2&quot;</span>:<span class="string">&quot;com.sankuai.meituan&quot;</span>,<span class="attr">&quot;a11&quot;</span>:<span class="string">&quot;c1ee9178c95d9ec75f0f076a374df94a032d54c8576298d4f75e653de3705449&quot;</span>,<span class="attr">&quot;a3&quot;</span>:<span class="string">&quot;0a16ecd60eb56a6a3349f66cdcf7f7bf5190e5a42d6280d8dc0ee3be228398ec&quot;</span>,<span class="attr">&quot;a4&quot;</span>:<span class="number">1100030200</span>,<span class="attr">&quot;k0&quot;</span>:&#123;<span class="attr">&quot;k1&quot;</span>:<span class="string">&quot;meituan1sankuai0&quot;</span>,<span class="attr">&quot;k2&quot;</span>:<span class="string">&quot;meituan0sankuai1&quot;</span>,<span class="attr">&quot;k3&quot;</span>:<span class="string">&quot;$MXMYBS@HelloPay&quot;</span>,<span class="attr">&quot;k4&quot;</span>:<span class="string">&quot;Maoyan010iauknaS&quot;</span>,<span class="attr">&quot;k5&quot;</span>:<span class="string">&quot;34281a9dw2i701d4&quot;</span>,<span class="attr">&quot;k6&quot;</span>:<span class="string">&quot;X%rj@KiuU+|xY&#125;?f&quot;</span>&#125;,<span class="attr">&quot;a5&quot;</span>:<span class="string">&quot;11.3.200&quot;</span>,<span class="attr">&quot;a0&quot;</span>:<span class="string">&quot;pw/LhTdeoTTyaxPHcHMy+/ssGNS1ihNkrJ+uBI74FIfd90KlTil1m0i7FF/n0bhY&quot;</span>,<span class="attr">&quot;a6&quot;</span>:<span class="string">&quot;/HntC9XIfdUyII/UiVfx020EQPpHz2XZY3qzM2aiNmM0i0pB1yeSO689TY9SBB3s&quot;</span>,<span class="attr">&quot;a7&quot;</span>:<span class="string">&quot;QsHnU6kFjTYR8Z6tHEvkGMO2Hrt+NRnVQhmxg6EtVBzuzQcBpma3AdhTWNMpesFT&quot;</span>,<span class="attr">&quot;c0&quot;</span>:&#123;<span class="attr">&quot;c1&quot;</span>:<span class="literal">true</span>,<span class="attr">&quot;c2&quot;</span>:<span class="literal">false</span>&#125;,<span class="attr">&quot;a9&quot;</span>:<span class="string">&quot;SDEzWXi5LHL/cuMCZ1zYyv+0hIViqWWf+ShbUYILWf4=&quot;</span>,<span class="attr">&quot;a8&quot;</span>:<span class="number">1603800117167</span>&#125;</span><br></pre></td></tr></table></figure>

<p>解析json获取a7</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QsHnU6kFjTYR8Z6tHEvkGMO2Hrt+NRnVQhmxg6EtVBzuzQcBpma3AdhTWNMpesFT</span><br></pre></td></tr></table></figure>

<p>appkey与pic中的a7异或</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">.text:C8A90424 20 00       MOVS            R0, R4</span><br><span class="line">.text:C8A90426 02 99       LDR             R1, [SP,#8]</span><br><span class="line">.text:C8A90428 7E F0 12 FE BL              sub_C8B0F050</span><br><span class="line">.text:C8A9042C 03 98       LDR             R0, [SP,#0xC]</span><br><span class="line">.text:C8A9042E 00 5D       LDRB            R0, [R0,R4]             ; 取a7 QsHnU6kFjTYR8Z6tHEvkGMO2Hrt+NRnVQhmxg6EtVBzuzQcBpma3AdhTWNMpesFT</span><br><span class="line">.text:C8A90430 72 5C       LDRB            R2, [R6,R1]             ; appkey 9b69f861-e054-4bc4-9daf-d36ae205ed3e</span><br><span class="line">.text:C8A90432 42 40       EORS            R2, R0</span><br><span class="line">.text:C8A90434 6A 54       STRB            R2, [R5,R1]</span><br><span class="line">.text:C8A90436 01 34       ADDS            R4, #1</span><br><span class="line">.text:C8A90438 04 98       LDR             R0, [SP,#0x10]</span><br><span class="line">.text:C8A9043A A0 42       CMP             R0, R4                  ; 判断是否结束</span><br><span class="line">.text:C8A9043C F2 D1       BNE             loc_C8A90424</span><br><span class="line">.text:C8A9043E 03 B5       PUSH            &#123;R0,R1,LR&#125;</span><br><span class="line">.text:C8A90440 01 48       LDR             R0, =0</span><br><span class="line">.text:C8A90442 FF F7 DB FF BL              loc_C8A903FC</span><br></pre></td></tr></table></figure>

<p>异或后的值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">BC79D120  5E 54 73 4D 30 7A 4C 44  57 34 53 77 44 40 55 51  ^TsM0zLDW4SwD@UQ</span><br><span class="line">BC79D130  22 50 45 6D 33 2F 2B 5D  01 40 70 35 2B 60 5E 63  &quot;PEm3/+].@p5+`^c</span><br><span class="line">BC79D140  34 0C 5E 1D</span><br></pre></td></tr></table></figure>

<p>再次异或</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">.text:C8A91C00             loc_C8A91C00                            ; CODE XREF: hmac_sha256_sub_BB754BAC+6C↓j</span><br><span class="line">.text:C8A91C00 43 A9       ADD             R1, SP, #0x160+var_54</span><br><span class="line">.text:C8A91C02 09 5C       LDRB            R1, [R1,R0]             ; 取APPkey与a7加密后数据</span><br><span class="line">.text:C8A91C04 5C 22       MOVS            R2, #0x5C ; &#x27;\&#x27;</span><br><span class="line">.text:C8A91C06 4A 40       EORS            R2, R1</span><br><span class="line">.text:C8A91C08 32 AB       ADD             R3, SP, #0x160+var_98</span><br><span class="line">.text:C8A91C0A 1A 54       STRB            R2, [R3,R0]             ; 存值</span><br><span class="line">.text:C8A91C0C 36 22       MOVS            R2, #0x36 ; &#x27;6&#x27;</span><br><span class="line">.text:C8A91C0E 4A 40       EORS            R2, R1</span><br><span class="line">.text:C8A91C10 21 A9       ADD             R1, SP, #0x160+var_DC</span><br><span class="line">.text:C8A91C12 0A 54       STRB            R2, [R1,R0]             ; 存值</span><br><span class="line">.text:C8A91C14 01 30       ADDS            R0, #1</span><br><span class="line">.text:C8A91C16 40 28       CMP             R0, #0x40 ; &#x27;@&#x27;         ; 判断是否结束</span><br><span class="line">.text:C8A91C18 F2 D1       BNE             loc_C8A91C00</span><br></pre></td></tr></table></figure>

<p>异或后的值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CB0D3000  68 62 45 7B 06 4C 7A 72  61 02 65 41 72 76 63 67  hbE&#123;.Lzra.eArvcg</span><br><span class="line">CB0D3010  14 66 73 5B 05 19 1D 6B  37 76 46 03 1D 56 68 55  .fs[...k7vF..VhU</span><br><span class="line">CB0D3020  02 3A 68 2B 36 36 36 36  36 36 36 36 36 36 36 36  .:h+666666666666</span><br><span class="line">CB0D3030  36 36 36 36 36 36 36 36  36 36 36 36 36 36 36 36  6666666666666666</span><br></pre></td></tr></table></figure>

<p>将异或后的值与请求体组合</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">CB0D3000  68 62 45 7B 06 4C 7A 72  61 02 65 41 72 76 63 67  hbE&#123;.Lzra.eArvcg</span><br><span class="line">CB0D3010  14 66 73 5B 05 19 1D 6B  37 76 46 03 1D 56 68 55  .fs[...k7vF..VhU</span><br><span class="line">CB0D3020  02 3A 68 2B 36 36 36 36  36 36 36 36 36 36 36 36  .:h+666666666666</span><br><span class="line">CB0D3030  36 36 36 36 36 36 36 36  36 36 36 36 36 36 36 36  6666666666666666</span><br><span class="line">CB0D3040  50 4F 53 54 20 2F 76 35  2F 73 69 67 6E 20 7B 22  POST /v5/sign &#123;&quot;</span><br><span class="line">CB0D3050  64 61 74 61 22 3A 22 62  4A 62 50 67 72 4B 49 42  data&quot;:&quot;bJbPgrKIB</span><br><span class="line">CB0D3060  6A 6D 4E 4E 2B 6B 63 30  39 66 66 6F 54 70 67 48  jmNN+kc09ffoTpgH</span><br><span class="line">CB0D3070  57 39 57 46 7A 43 6B 67  75 4D 4E 71 50 52 57 68  W9WFzCkguMNqPRWh</span><br><span class="line">CB0D3080  6A 70 41 67 2B 4E 62 45  70 76 47 62 44 42 54 47  jpAg+NbEpvGbDBTG</span><br><span class="line">CB0D3090  6E 79 31 38 6C 6C 39 38  75 43 37 44 68 67 2B 33  ny18ll98uC7Dhg+3</span><br><span class="line">CB0D30A0  56 44 39 31 62 38 50 67  67 47 2F 47 56 61 52 59  VD91b8PggG/GVaRY</span><br><span class="line">CB0D30B0  71 4D 4C 37 33 36 30 6E  63 71 41 59 57 37 68 4A  qML7360ncqAYW7hJ</span><br></pre></td></tr></table></figure>

<p>计算组合值的MD5</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">.text:C8A91C60 2A 00       MOVS            R2, R5</span><br><span class="line">.text:C8A91C62 00 F0 79 F9 BL              md5_sub_BB7CFF58        ; R0:原始数后,R1:大小,R2:返回</span><br><span class="line">.text:C8A91C66 05 AE       ADD             R6, SP, #0x160+var_14C</span><br><span class="line">.text:C8A91C68 55 21       MOVS            R1, #0x55 ; &#x27;U&#x27;</span><br><span class="line">.text:C8A91C6A 30 00       MOVS            R0, R6</span><br><span class="line">.text:C8A91C6C F8 F7 54 E8 BLX             __aeabi_memclr4</span><br><span class="line">.text:C8A91C70 32 A9       ADD             R1, SP, #0x160+var_98</span><br><span class="line">.text:C8A91C72 30 00       MOVS            R0, R6</span><br><span class="line">.text:C8A91C74 02 9A       LDR             R2, [SP,#0x160+var_158]</span><br><span class="line">.text:C8A91C76 1E F0 48 FC BL              getvalu_sub_C87B550A</span><br><span class="line">.text:C8A91C7A 30 00       MOVS            R0, R6</span><br><span class="line">.text:C8A91C7C 40 30       ADDS            R0, #0x40 ; &#x27;@&#x27;</span><br><span class="line">.text:C8A91C7E 14 22       MOVS            R2, #0x14</span><br><span class="line">.text:C8A91C80 29 00       MOVS            R1, R5</span><br><span class="line">.text:C8A91C82 1E F0 42 FC BL              getvalu_sub_C87B550A</span><br><span class="line">.text:C8A91C86 54 21       MOVS            R1, #0x54 ; &#x27;T&#x27;</span><br><span class="line">.text:C8A91C88 30 00       MOVS            R0, R6</span><br><span class="line">.text:C8A91C8A 01 9A       LDR             R2, [SP,#0x160+var_15C]</span><br><span class="line">.text:C8A91C8C 00 F0 64 F9 BL              md5_sub_BB7CFF58        ; R0:原始数后,R1:大小,R2:返回</span><br><span class="line">.text:C8A91C90 20 00       MOVS            R0, R4                  ; p</span><br><span class="line">.text:C8A91C92 F8 F7 30 E8 BLX             free</span><br></pre></td></tr></table></figure>

<p>计算后得到的值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">F0 EF 16 F8 BD C6 7B CC  8C B4 8F AC 4C EC 7A DB A8 A8 D1 05</span><br></pre></td></tr></table></figure>

<p>解密PIC数据获取KEY(a9)<br>解析json获取a3:0a16ecd60eb56a6a3349f66cdcf7f7bf5190e5a42d6280d8dc0ee3be228398ec<br>a3为AES KEY解密a9解密后数据，该值作为加密body md5值的key</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3ey2scPxek170m6K</span><br></pre></td></tr></table></figure>

<p>AES加密Body计算得到的MD5值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">IV 0102030405060708</span><br><span class="line">key:3ey2scPxek170m6K</span><br><span class="line"> </span><br><span class="line">.text:C8AA94F0 E0 F7 FA EB BLX             malloc</span><br><span class="line">.text:C8AA94F4 00 26       MOVS            R6, #0</span><br><span class="line">.text:C8AA94F6 00 28       CMP             R0, #0</span><br><span class="line">.text:C8AA94F8 1C D0       BEQ             loc_C8AA9534</span><br><span class="line">.text:C8AA94FA 4A 99       LDR             R1, [SP,#0x120+arg_0]</span><br><span class="line">.text:C8AA94FC 03 91       STR             R1, [SP,#0x120+var_114]</span><br><span class="line">.text:C8AA94FE 07 AE       ADD             R6, SP, #0x120+var_104</span><br><span class="line">.text:C8AA9500 F4 21       MOVS            R1, #0xF4</span><br><span class="line">.text:C8AA9502 02 90       STR             R0, [SP,#0x120+var_118]</span><br><span class="line">.text:C8AA9504 30 00       MOVS            R0, R6</span><br><span class="line">.text:C8AA9506 E0 F7 08 EC BLX             __aeabi_memclr4</span><br><span class="line">.text:C8AA950A 80 21       MOVS            R1, #0x80</span><br><span class="line">.text:C8AA950C 20 00       MOVS            R0, R4</span><br><span class="line">.text:C8AA950E 32 00       MOVS            R2, R6</span><br><span class="line">.text:C8AA9510 56 F0 30 FF BL              AES_set_Encrypt_key_sub_CB601374 ; R0:key,R1:长度,R2:返回值</span><br><span class="line">.text:C8AA9514 06 9A       LDR             R2, [SP,#0x120+byte_count]</span><br><span class="line">.text:C8AA9516 01 20       MOVS            R0, #1</span><br><span class="line">.text:C8AA9518 69 46       MOV             R1, SP</span><br><span class="line">.text:C8AA951A 04 9B       LDR             R3, [SP,#0x120+var_110]</span><br><span class="line">.text:C8AA951C 0B 60       STR             R3, [R1,#0x120+var_120]</span><br><span class="line">.text:C8AA951E 48 60       STR             R0, [R1,#0x120+var_11C]</span><br><span class="line">.text:C8AA9520 05 98       LDR             R0, [SP,#0x120+p]</span><br><span class="line">.text:C8AA9522 02 9C       LDR             R4, [SP,#0x120+var_118]</span><br><span class="line">.text:C8AA9524 21 00       MOVS            R1, R4</span><br><span class="line">.text:C8AA9526 33 00       MOVS            R3, R6</span><br><span class="line">.text:C8AA9528 57 F0 7A FD BL              AES_cbc_Encrypt_sub_CB602020 ; R0：原始数据,R1:返回,R2:大小,R3:key</span><br><span class="line">.text:C8AA952C 06 98       LDR             R0, [SP,#0x120+byte_count]</span><br><span class="line">.text:C8AA952E 03 99       LDR             R1, [SP,#0x120+var_114]</span><br><span class="line">.text:C8AA9530 08 60       STR             R0, [R1]</span><br><span class="line">.text:C8AA9532 26 00       MOVS            R6, R4</span><br><span class="line">.text:C8AA9534</span><br><span class="line">.text:C8AA9534             loc_C8AA9534                            ; CODE XREF: Aes_sub_CB5AA4B8+40↑j</span><br><span class="line">.text:C8AA9534 05 98       LDR             R0, [SP,#0x120+p]       ; p</span><br><span class="line">.text:C8AA9536 E0 F7 DE EB BLX             free</span><br></pre></td></tr></table></figure>

<p>加密后数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">C7B9C460  06 34 4B B7 17 3B 29 9D  FE B9 85 8D 24 6C 52 AE</span><br><span class="line">C7B9C470  BB AF 22 3F 8E 43 FB C5  66 2B 54 E2 C6 6A 54 EA</span><br></pre></td></tr></table></figure>

<p>转换成字符串</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">06344bb7173b299dfeb9858d246c52aebbaf223f8e43fbc5662b54e2c66a54ea</span><br></pre></td></tr></table></figure>

<p>组合json,生成签名</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;a0&quot;</span>: <span class="string">&quot;2.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;a1&quot;</span>: <span class="string">&quot;9b69f861-e054-4bc4-9daf-d36ae205ed3e&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;a3&quot;</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="attr">&quot;a4&quot;</span>: <span class="number">1631754963</span>,</span><br><span class="line">    <span class="attr">&quot;a5&quot;</span>: <span class="string">&quot;An2sai6nXEuFYeKbDUk/qEo/7am8Jtn3O2Has5efofCux7iubGRCS8TKpjUgotJ6MGdQrBsvwh/peZwuikT+5rCr4RzN8SXXCeDOtZQ6sbo/snVdESSJweNqd6i/WbIwDOgv5eaWRQoISjdgNfW3hk7tf0QhsZFbOELcPxz5pRzo6d6EsBLFu5Mq8DbVNgsYF+6aqZ7302/G+Rr7MlUT2M9y3EjgjH01L39q/eRJ&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;a6&quot;</span>: <span class="number">1025</span>,</span><br><span class="line">    <span class="attr">&quot;a7&quot;</span>: <span class="string">&quot;Rs8NOy0BFS5JQxfdOoIxpMnKV3iqYWcblAjp0vpnWZyNzyF9rfsi3ekpm4ScaIZgeImizX/5AbS3e838Or4el4+PPPI2kD8XW+8vbvjDBSM=&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;a8&quot;</span>: <span class="string">&quot;DAD796C46B5A6525F4B89DF661A97C7A218A219FC24B93F689DEBD92&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;a9&quot;</span>: <span class="string">&quot;f4ec12efNkQBqdtVlV78x1/Mln2Us/xw171NuJjdEXrGWsFDdMV5Te45wqjL0nPO8OFFKjvKthvva+lS9xqhMhSt1WZRjDYpsWc/eh3z4F2JTv3MOh8NEDmk7Frthx5/bczdDIKvRP0QneTfNKSm116fUjdLhOEYlNbym/xI+5jZAEJGfGjltFLEOmtOwgxasgHQh2woMl/vAyr7ePuoVC6wEcbv2+w6n/+Pl1U1KO2YcTw4peiZDqC7iHpTVQH4fWri9R5+Ev1zx/xObVqoxqe3TEW/t2EIRqQ4QoRZRix0xC6C280faz8U5vOqafUnm+qev7tjs7SOV4SNxBv+LEJTxr5IJU302FJEk/CqhKoz5eWRYtT5Z52kEanlfu4AGHcJLC343kpI3GxYw7uPeewA/Ye0qDgZUyfj0MPpaYMPj0UmtvnbXEU4+FaRaCb/LsQtWdOtEiEKveUQU9bTW4NfHch2+6gcHP2/E+UQSlREX67PPa9XN8tgL4H6qzghiE1NL3gYw0rrjzEXiO6jsjvIdzwDjeab9woJyr8W3xSACz3sezUS+AJAKohnJvlQkFM9cdG3lPYS7gByAK++K2/vI714kxJHqCZQQMbVNsoWj5w64YL+sE1A4byzOPgK71oPb9w6Cb+KwVlDtqH8F5vlVkO23Iq8E28BI2vQuq5TLRzMunjo45Ks2Py9ZZuHkGb+QIVpUz6ViB+JlUONKinIJF1p6g==&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;a10&quot;</span>: <span class="string">&quot;&#123;&#125;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;x0&quot;</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;a2&quot;</span>: <span class="string">&quot;06344bb7173b299dfeb9858d246c52aebbaf223f8e43fbc5662b54e2c66a54ea&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>a2:就是请求体签名值，其它字段上面已经解释过，然后将签名值返回到java层，整个签名流程就完成了。</p>
<h1 id="六、设备指纹分析"><a href="#六、设备指纹分析" class="headerlink" title="六、设备指纹分析"></a>六、设备指纹分析</h1><h2 id="6-1、dfpid基本流程"><a href="#6-1、dfpid基本流程" class="headerlink" title="6.1、dfpid基本流程"></a>6.1、dfpid基本流程</h2><p>java层调用fetchDfpId()获取dfpid</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">fetchDfpId</span><span class="params">(<span class="keyword">boolean</span> arg13)</span> </span>&#123;</span><br><span class="line">       Object[] v8 = <span class="keyword">new</span> Object[]&#123;((<span class="keyword">byte</span>)(((<span class="keyword">byte</span>)arg13)))&#125;;</span><br><span class="line">       ChangeQuickRedirect v10 = DFPManager.changeQuickRedirect;</span><br><span class="line">       <span class="keyword">if</span>(PatchProxy.isSupport(v8, <span class="keyword">this</span>, v10, <span class="keyword">false</span>, <span class="string">&quot;19489f6702cf81011acff69ff203e6a7&quot;</span>, <span class="number">0x4000000000000000L</span>)) &#123;</span><br><span class="line">           <span class="keyword">return</span> ((Boolean)PatchProxy.accessDispatch(v8, <span class="keyword">this</span>, v10, <span class="keyword">false</span>, <span class="string">&quot;19489f6702cf81011acff69ff203e6a7&quot;</span>)).booleanValue();</span><br><span class="line">       &#125;</span><br><span class="line"> </span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line">           <span class="keyword">if</span>(<span class="keyword">this</span>.isOutDate()) &#123;</span><br><span class="line">           label_49:</span><br><span class="line">               <span class="keyword">if</span>(!<span class="keyword">this</span>.postDFPID(<span class="keyword">this</span>.encDfpDataForId())) &#123;  <span class="comment">// 服务器获取</span></span><br><span class="line">                   <span class="keyword">this</span>.ensureLocalID();  <span class="comment">// 读取本地ID</span></span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="keyword">else</span> &#123;</span><br><span class="line">               <span class="keyword">if</span>(arg13) &#123;</span><br><span class="line">                   goto label_49;</span><br><span class="line">               &#125;</span><br><span class="line"> </span><br><span class="line">               String v4 = <span class="keyword">this</span>.idStore.getLocalDFPId();</span><br><span class="line">               <span class="keyword">if</span>(!TextUtils.isEmpty(v4)) &#123;</span><br><span class="line">                   goto label_38;</span><br><span class="line">               &#125;</span><br><span class="line"> </span><br><span class="line">               <span class="keyword">if</span>(!<span class="keyword">this</span>.postDFPID(<span class="keyword">this</span>.encDfpDataForId())) &#123;</span><br><span class="line">                   <span class="keyword">this</span>.ensureLocalID();</span><br><span class="line">                   <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">               label_38:</span><br><span class="line">                   <span class="keyword">this</span>.idCallback.onSuccess(v4, ((<span class="keyword">long</span>)DFPManager.ONE_HOUR) * ((<span class="keyword">long</span>)<span class="keyword">this</span>.idStore.getInterval()) + ((<span class="keyword">long</span>)<span class="keyword">this</span>.idStore.getLastUpdateTime()), <span class="string">&quot;get dfp from local store&quot;</span>);</span><br><span class="line">                   <span class="keyword">long</span> v7 = System.currentTimeMillis();</span><br><span class="line">                   <span class="keyword">this</span>.doPersistence(v4, <span class="keyword">this</span>.idStore.getInterval().longValue(), v7);</span><br><span class="line">                   <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">catch</span>(Throwable unused_ex) &#123;</span><br><span class="line">       &#125;</span><br><span class="line"> </span><br><span class="line">       <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>调用encDfpDataForId()方法走到Native层获取请求体</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">encDfpDataForId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      Object[] v8 = <span class="keyword">new</span> Object[<span class="number">0</span>];</span><br><span class="line">      ChangeQuickRedirect v9 = DFPManager.changeQuickRedirect;</span><br><span class="line">      <span class="keyword">if</span>(PatchProxy.isSupport(v8, <span class="keyword">this</span>, v9, <span class="keyword">false</span>, <span class="string">&quot;c899af894ac6d9a1a9df952ed8770d17&quot;</span>, <span class="number">0x4000000000000000L</span>)) &#123;</span><br><span class="line">          <span class="keyword">return</span> (String)PatchProxy.accessDispatch(v8, <span class="keyword">this</span>, v9, <span class="keyword">false</span>, <span class="string">&quot;c899af894ac6d9a1a9df952ed8770d17&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line"> </span><br><span class="line">      FamaCollector.hasCollected = <span class="keyword">true</span>;</span><br><span class="line">      <span class="keyword">return</span> NBridge.main1(<span class="number">41</span>, <span class="keyword">new</span> Object[<span class="number">0</span>]);  <span class="comment">// 请求体</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>调用postDFPID(String arg12)发送网络请求获取dfpid</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line">url: https:<span class="comment">//appsec-mobile.meituan.com/v5/sign</span></span><br><span class="line"> </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">postDFPID</span><span class="params">(String arg12)</span> </span>&#123;</span><br><span class="line">        Object[] v0 = <span class="keyword">new</span> Object[]&#123;<span class="keyword">null</span>&#125;;</span><br><span class="line">        v0[<span class="number">0</span>] = arg12;</span><br><span class="line">        ChangeQuickRedirect v9 = IDFPManager.changeQuickRedirect;</span><br><span class="line">        <span class="keyword">if</span>(PatchProxy.isSupport(v0, <span class="keyword">this</span>, v9, <span class="keyword">false</span>, <span class="string">&quot;f625ba5594fc8256be5f644877e817ae&quot;</span>, <span class="number">0x4000000000000000L</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> ((Boolean)PatchProxy.accessDispatch(v0, <span class="keyword">this</span>, v9, <span class="keyword">false</span>, <span class="string">&quot;f625ba5594fc8256be5f644877e817ae&quot;</span>)).booleanValue();</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        Interceptor v0_1 = <span class="keyword">this</span>.getInterceptor();</span><br><span class="line">        String v1 = <span class="keyword">this</span>.getMtgVersion();</span><br><span class="line">        DFPReporter v0_2 = <span class="keyword">new</span> Builder().addInterceptor(v0_1).addResponseParser(<span class="keyword">new</span> IResponseParser() &#123;</span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">static</span> ChangeQuickRedirect changeQuickRedirect;</span><br><span class="line"> </span><br><span class="line">            <span class="meta">@Override</span>  <span class="comment">// com.meituan.android.common.dfingerprint.network.IResponseParser</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onError</span><span class="params">(Call arg11, IOException arg12)</span> </span>&#123;</span><br><span class="line">                Object[] v0 = <span class="keyword">new</span> Object[]&#123;arg11, arg12&#125;;</span><br><span class="line">                ChangeQuickRedirect v12 = com.meituan.android.common.dfingerprint.interfaces.IDFPManager<span class="number">.1</span>.changeQuickRedirect;</span><br><span class="line">                <span class="keyword">if</span>(PatchProxy.isSupport(v0, <span class="keyword">this</span>, v12, <span class="keyword">false</span>, <span class="string">&quot;0231e3e90aba1d77b6009d4f4e808ce1&quot;</span>, <span class="number">0x4000000000000000L</span>)) &#123;</span><br><span class="line">                    <span class="keyword">return</span> ((Boolean)PatchProxy.accessDispatch(v0, <span class="keyword">this</span>, v12, <span class="keyword">false</span>, <span class="string">&quot;0231e3e90aba1d77b6009d4f4e808ce1&quot;</span>)).booleanValue();</span><br><span class="line">                &#125;</span><br><span class="line"> </span><br><span class="line">                Logger.logD(<span class="string">&quot;/v5/sign onError&quot;</span>);</span><br><span class="line">                IDFPManager.<span class="keyword">this</span>.ensureLocalID();</span><br><span class="line">                <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line"> </span><br><span class="line">            <span class="meta">@Override</span>  <span class="comment">// com.meituan.android.common.dfingerprint.network.IResponseParser</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onResponse</span><span class="params">(Response arg23, <span class="keyword">long</span> arg24, <span class="keyword">int</span> arg26)</span> </span>&#123;</span><br><span class="line">                String v2_1;</span><br><span class="line">                <span class="keyword">long</span> interval;</span><br><span class="line">                String dfpid;</span><br><span class="line">                ResponseBody body;</span><br><span class="line">                Object[] v11 = <span class="keyword">new</span> Object[]&#123;arg23, <span class="keyword">new</span> Long(arg24), ((<span class="keyword">int</span>)arg26)&#125;;</span><br><span class="line">                ChangeQuickRedirect v14 = com.meituan.android.common.dfingerprint.interfaces.IDFPManager<span class="number">.1</span>.changeQuickRedirect;</span><br><span class="line">                <span class="keyword">if</span>(PatchProxy.isSupport(v11, <span class="keyword">this</span>, v14, <span class="keyword">false</span>, <span class="string">&quot;cfa6814ee923204fe513080ced241785&quot;</span>, <span class="number">0x4000000000000000L</span>)) &#123;</span><br><span class="line">                    <span class="keyword">return</span> ((Boolean)PatchProxy.accessDispatch(v11, <span class="keyword">this</span>, v14, <span class="keyword">false</span>, <span class="string">&quot;cfa6814ee923204fe513080ced241785&quot;</span>)).booleanValue();</span><br><span class="line">                &#125;</span><br><span class="line"> </span><br><span class="line">                Logger.logD(<span class="string">&quot;/v5/sign onResponse $response&quot;</span>);</span><br><span class="line">                <span class="keyword">if</span>(arg23 == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line"> </span><br><span class="line">                <span class="keyword">if</span>(arg23.code() != <span class="number">200</span>) &#123;</span><br><span class="line">                    MTGlibInterface.raptorAPI(<span class="string">&quot;v5_/v5/sign&quot;</span>, arg23.code(), arg26, <span class="number">0</span>, System.currentTimeMillis() - arg24);</span><br><span class="line">                    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line"> </span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    body = arg23.body();</span><br><span class="line">                    <span class="keyword">if</span>(body == <span class="keyword">null</span>) &#123;</span><br><span class="line">                        IDFPManager.<span class="keyword">this</span>.idCallback.onFailed(-<span class="number">3</span>, <span class="string">&quot;request body is invalid&quot;</span>);</span><br><span class="line">                        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"> </span><br><span class="line">                    String v3 = <span class="keyword">new</span> String(body.bytes());</span><br><span class="line">                    MTGlibInterface.raptorAPI(<span class="string">&quot;v5_/v5/sign&quot;</span>, arg23.code(), arg26, v3.length(), System.currentTimeMillis() - arg24);</span><br><span class="line">                    Logger.logD(<span class="string">&quot;RaptorMonitorService &gt;&gt; $&#123;RaptorUtil.API_reportdfpidsync&#125;&quot;</span>);</span><br><span class="line">                    Logger.logD(<span class="string">&quot;RaptorMonitorService result&gt;&gt; $&#123;result&#125;&quot;</span>);</span><br><span class="line">                    <span class="keyword">if</span>(v3.isEmpty()) &#123;</span><br><span class="line">                        IDFPManager.<span class="keyword">this</span>.idCallback.onFailed(-<span class="number">3</span>, <span class="string">&quot;request body is invalid&quot;</span>);</span><br><span class="line">                        MTGlibInterface.raptorAPI(<span class="string">&quot;v5_/v5/sign&quot;</span>, <span class="number">9401</span>, arg26, <span class="number">0</span>, System.currentTimeMillis() - arg24);</span><br><span class="line">                        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"> </span><br><span class="line">                    Logger.logD(<span class="string">&quot;/v5/sign response.body() &gt;&gt; $result&quot;</span>);</span><br><span class="line">                    DFPResponse body_json = (DFPResponse)<span class="keyword">new</span> Gson().fromJson(v3, DFPResponse.class);</span><br><span class="line">                    <span class="keyword">if</span>(body_json == <span class="keyword">null</span>) &#123;</span><br><span class="line">                        goto label_145;</span><br><span class="line">                    &#125;</span><br><span class="line"> </span><br><span class="line">                    <span class="keyword">if</span>(body_json.code == <span class="number">0xFFFFFF80</span>) &#123;</span><br><span class="line">                        goto label_145;</span><br><span class="line">                    &#125;</span><br><span class="line"> </span><br><span class="line">                    <span class="keyword">int</span> v3_1 = body_json.code;</span><br><span class="line">                    <span class="keyword">if</span>(v3_1 != <span class="number">0</span>) &#123;</span><br><span class="line">                        IDFPManager.<span class="keyword">this</span>.idCallback.onFailed(v3_1, body_json.message);</span><br><span class="line">                        MTGlibInterface.raptorAPI(<span class="string">&quot;v5_/v5/sign&quot;</span>, <span class="number">9402</span>, arg26, <span class="number">0</span>, System.currentTimeMillis() - arg24);</span><br><span class="line">                        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"> </span><br><span class="line">                    dfpid = body_json.data.dataDfp;</span><br><span class="line">                    interval = body_json.data.dataInterval;</span><br><span class="line">                    v2_1 = body_json.message;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">catch</span>(Exception unused_ex) &#123;</span><br><span class="line">                    IDFPManager.<span class="keyword">this</span>.ensureLocalID();</span><br><span class="line">                    MTGlibInterface.raptorAPI(<span class="string">&quot;v5_/v5/sign&quot;</span>, <span class="number">9405</span>, arg26, <span class="number">0</span>, System.currentTimeMillis() - arg24);</span><br><span class="line">                    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line"> </span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    Logger.logD(<span class="string">&quot;/v5/sign response, dataDecrypt &gt; $dataDecrypt&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">catch</span>(Exception unused_ex) &#123;</span><br><span class="line">                &#125;</span><br><span class="line"> </span><br><span class="line">                <span class="keyword">try</span> &#123;  <span class="comment">// 如果等空读取本地的</span></span><br><span class="line">                    <span class="keyword">if</span>(dfpid == <span class="string">&quot;&quot;</span>) &#123;  <span class="comment">// 如果等空读取本地的</span></span><br><span class="line">                        IDFPManager.<span class="keyword">this</span>.ensureLocalID();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span> &#123;</span><br><span class="line">                        Logger.logD(<span class="string">&quot;/v5/sign 返回新的 local_dfp_id，需要保存它&quot;</span>);</span><br><span class="line">                        <span class="keyword">long</span> currtime = System.currentTimeMillis();</span><br><span class="line">                        <span class="keyword">if</span>(DFPConfigs.isDfpidFirst) &#123;</span><br><span class="line">                            MTGlibInterface.raptorFakeAPI(<span class="string">&quot;v5_dfpid_duration&quot;</span>, <span class="number">200</span>, System.currentTimeMillis() - MTGuard.sFirstLaunchTime);</span><br><span class="line">                            DFPConfigs.isDfpidFirst = <span class="keyword">false</span>;</span><br><span class="line">                        &#125;</span><br><span class="line"> </span><br><span class="line">                        IDFPManager.<span class="keyword">this</span>.doPersistence(dfpid, interval, currtime);  <span class="comment">// 保存dfpid</span></span><br><span class="line">                        IDFPManager.<span class="keyword">this</span>.idCallback.onSuccess(dfpid, interval * ((<span class="keyword">long</span>)IDFPManager.ONE_HOUR) + currtime, v2_1);</span><br><span class="line">                    &#125;</span><br><span class="line"> </span><br><span class="line">                    body.close();</span><br><span class="line">                    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                label_145:</span><br><span class="line">                    IDFPManager.<span class="keyword">this</span>.idCallback.onFailed(-<span class="number">4</span>, <span class="string">&quot;body parse failed&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">catch</span>(Exception unused_ex) &#123;</span><br><span class="line">                    IDFPManager.<span class="keyword">this</span>.ensureLocalID();</span><br><span class="line">                    MTGlibInterface.raptorAPI(<span class="string">&quot;v5_/v5/sign&quot;</span>, <span class="number">9405</span>, arg26, <span class="number">0</span>, System.currentTimeMillis() - arg24);</span><br><span class="line">                &#125;</span><br><span class="line"> </span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).build();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            ReqeustBody v2 = <span class="keyword">new</span> ReqeustBody(arg12, v1, <span class="keyword">null</span>);</span><br><span class="line">            Gson v12 = <span class="keyword">new</span> GsonBuilder().disableHtmlEscaping().create();</span><br><span class="line">            <span class="keyword">if</span>(v12 != <span class="keyword">null</span>) &#123;</span><br><span class="line">                String v12_1 = v12.toJson(v2);</span><br><span class="line">                Logger.logD(<span class="string">&quot;postDFPID body &gt; $body&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> v0_2.reportDFPIDSync(v12_1, ContentType.application_json);  <span class="comment">// 网络请求</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span>(Exception unused_ex) &#123;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="6-2、dfpid请求体分析"><a href="#6-2、dfpid请求体分析" class="headerlink" title="6.2、dfpid请求体分析"></a>6.2、dfpid请求体分析</h2><p>请求体调用Native层方法NBridge.main(41, new Object[0])在Native层计算得到<br>循环获取设备信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">.text:C8A8C684 09 98       LDR             R0, [SP,#0x24]</span><br><span class="line">.text:C8A8C686 61 F0 CD FF BL              getmContext_sub_CC9EF624 ; 获取上下文件</span><br><span class="line">.text:C8A8C68A 07 90       STR             R0, [SP,#0x1C]</span><br><span class="line">.text:C8A8C68C 00 F0 14 FE BL              init_DecString_sub_C84582B8</span><br><span class="line">.text:C8A8C690 06 90       STR             R0, [SP,#0x18]</span><br><span class="line">.text:C8A8C692 2B A8       ADD             R0, SP, #0xAC</span><br><span class="line">.text:C8A8C694 05 90       STR             R0, [SP,#0x14]</span><br><span class="line">.text:C8A8C696 09 99       LDR             R1, [SP,#0x24]</span><br><span class="line">.text:C8A8C698 07 9A       LDR             R2, [SP,#0x1C]</span><br><span class="line">.text:C8A8C69A 2B 00       MOVS            R3, R5</span><br><span class="line">.text:C8A8C69C 26 F0 7A FC BL              GetDeviceInfo_dispatch_loop_sub_C89F8F94 ; 获取设备信息1</span><br><span class="line">.text:C8A8C6A0 06 98       LDR             R0, [SP,#0x18]</span><br><span class="line">.text:C8A8C6A2 29 00       MOVS            R1, R5</span><br><span class="line">.text:C8A8C6A4 05 9A       LDR             R2, [SP,#0x14]</span><br><span class="line">.text:C8A8C6A6 23 F0 8D FF BL              jmp_checkField_sub_C89F65C4 ; 判断获取的内容是否为特殊字符mtg_unsupport,mtg_block,setup_empty</span><br><span class="line">.text:C8A8C6AA 2B 98       LDR             R0, [SP,#0xAC]</span><br><span class="line">.text:C8A8C6AC 04 99       LDR             R1, [SP,#0x10]</span><br><span class="line">.text:C8A8C6AE 40 18       ADDS            R0, R0, R1</span><br><span class="line">.text:C8A8C6B0 27 A9       ADD             R1, SP, #0x9C</span><br><span class="line">.text:C8A8C6B2 77 F0 49 F8 BL              free_sub_B2943748</span><br><span class="line">.text:C8A8C6B6 07 99       LDR             R1, [SP,#0x1C]</span><br><span class="line">.text:C8A8C6B8 00 29       CMP             R1, #0</span><br><span class="line">.text:C8A8C6BA 00 D1       BNE             loc_C8A8C6BE</span><br><span class="line">.text:C8A8C6BC 4C E7       B               loc_C8A8C558</span><br></pre></td></tr></table></figure>

<p>在下面地方下好断点跳到获取设备信息的地方，可以绕过代码流程混淆，快速定位到想要获取设备信息的方法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.text:C8AB5134 80 00       LSLS            R0, R0, #2              ; 跳到真实执行方法</span><br><span class="line">.text:C8AB5136 02 A1       ADR             R1, loc_C8AB5140</span><br><span class="line">.text:C8AB5138 08 58       LDR             R0, [R1,R0]             ; 取方法表偏移</span><br><span class="line">.text:C8AB513A 08 18       ADDS            R0, R1, R0</span><br><span class="line">.text:C8AB513C 87 46       MOV             PC, R0</span><br></pre></td></tr></table></figure>

<p>获取完设备信息后组合成json，主要获取硬件类ID、imei、mac,系统属性、CPU、内存、陀螺仪传感器等</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;m20&quot;</span>: <span class="string">&quot;3&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m22&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m24&quot;</span>: <span class="string">&quot;-1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m25&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m26&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m27&quot;</span>: <span class="string">&quot;DAD703FB1B789AFCFA0CAD4778CF9C8D0146219F941D41B66617A73F&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m28&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m29&quot;</span>: <span class="string">&quot;28.5&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m30&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m31&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m32&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m33&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m34&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m35&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m36&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m37&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m38&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m39&quot;</span>: <span class="string">&quot;Google&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m40&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m41&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m42&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m43&quot;</span>: <span class="string">&quot;23132356608&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m44&quot;</span>: <span class="string">&quot;1230796800000&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m45&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m46&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m47&quot;</span>: <span class="string">&quot;android&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m48&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m49&quot;</span>: <span class="string">&quot;nonetwork&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m50&quot;</span>: <span class="string">&quot;user&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m51&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m52&quot;</span>: <span class="string">&quot;google&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m53&quot;</span>: <span class="string">&quot;unknown&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m54&quot;</span>: <span class="string">&quot;adb&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m55&quot;</span>: <span class="string">&quot;&#123;\&quot;data\&quot;:[36.107063],\&quot;name\&quot;:\&quot;TMD4903LightSensor\&quot;,\&quot;vendor\&quot;:\&quot;AMS\&quot;&#125;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m56&quot;</span>: <span class="string">&quot;google/sailfish/sailfish:9/PQ2A.190305.002/5240760:user/release-keys&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m57&quot;</span>: <span class="string">&quot;[&#123;\&quot;ssid\&quot;:\&quot;2F16C2\&quot;,\&quot;bssid\&quot;:\&quot;cc:ee:07:2f:16:c2\&quot;&#125;,&#123;\&quot;ssid\&quot;:\&quot;2F16C2\&quot;,\&quot;bssid\&quot;:\&quot;cc:ee:07:2f:16:c2\&quot;&#125;,&#123;\&quot;ssid\&quot;:\&quot;JinRong\&quot;,\&quot;bssid\&quot;:\&quot;cc:e9:e4:84:cc:76\&quot;&#125;]&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m58&quot;</span>: <span class="string">&quot;unknown&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m59&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m60&quot;</span>: <span class="string">&quot;2283765760&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m61&quot;</span>: <span class="string">&quot;[1,BMI160accelerometer,1,Bosch,156,2500,0,0,4,BMI160gyroscope,1,Bosch,17,2500,0,0,2,AK09915magnetometer,1,AKM,1300,20000,0,0,6,BMP285pressure,1,Bosch,1100,100000,0,0,65536,BMP285temperature,1,Bosch,85,40000,0,0,8,TMD4903ProximitySensor,1,AMS,5,200000,0,1,5,TMD4903LightSensor,1,AMS,43000,200000,0,10,3,Orientation,1,Google,360,5000,0,1,18,BMI160Stepdetector,1,Bosch,1,0,0,1,17,Significantmotion,1,Google,1,-1,0,1,9,Gravity,1,Google,1000,5000,0,1,10,LinearAcceleration,1,Google,1000,5000,0,1,11,RotationVector,1,Google,1000,5000,0,1,20,GeomagneticRotationVector,1,Google,1000,5000,0,1,15,GameRotationVector,1,Google,1000,5000,0,1,25,PickupGesture,1,Google,1,-1,0,1,22,TiltDetector,1,Google,1,0,0,1,19,BMI160Stepcounter,1,Bosch,1,0,0,1,14,AK09915magnetometer(uncalibrated),1,AKM,1300,20000,0,0,16,BMI160gyroscope(uncalibrated),1,Bosch,17,2500,0,0,65537,SensorsSync,1,Google,1,0,0,1,65538,DoubleTwist,1,Google,1,0,0,1,65539,DoubleTap,1,Google,1,0,0,1,27,DeviceOrientation,1,Google,3,0,0,1,65540,DoubleTouch,1,Google,1,-1,0,1,35,BMI160accelerometer(uncalibrated),1,Bosch,156,2500,0,0,32,DynamicSensorManager,1,Google,1,1000,0,1]&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m62&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m63&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m64&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m65&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m66&quot;</span>: <span class="string">&quot;Bosch&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m67&quot;</span>: <span class="string">&quot;unknown&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m68&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m69&quot;</span>: <span class="string">&quot;352531086839980&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m70&quot;</span>: <span class="string">&quot;sailfish&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m71&quot;</span>: <span class="string">&quot;Gravity&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m72&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m73&quot;</span>: <span class="string">&quot;com.qihoo.appstore-bin.mt.plus-cn.tongdun.sdkdemo-com.arcsoft.arcfacedemo-com.baidu.idl.face.demo-com.bjgas.shop-com.duapps.gif.emoji.gifmaker-com.mv.livebodyexample-com.sankuai.meituan-com.songheng.wubiime&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m74&quot;</span>: <span class="string">&quot;FA7740302912&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m75&quot;</span>: <span class="string">&quot;unknown&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m76&quot;</span>: <span class="string">&quot;QualcommRIL1.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m77&quot;</span>: <span class="string">&quot;BMI160accelerometer&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m78&quot;</span>: <span class="string">&quot;com.android.chrome-com.android.settings-com.android.vending-com.google.android.GoogleCamera-com.google.android.apps.docs-com.google.android.apps.maps-com.google.android.apps.messaging-com.google.android.apps.photos-com.google.android.calendar-com.google.android.contacts&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m79&quot;</span>: <span class="string">&quot;midi,adb&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m80&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m81&quot;</span>: <span class="string">&quot;8996-130181-1811270246&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m82&quot;</span>: <span class="string">&quot;32&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m83&quot;</span>: <span class="string">&quot;PQ2A.190305.002&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m84&quot;</span>: <span class="string">&quot;midi,adb&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m85&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m86&quot;</span>: <span class="string">&quot;PQ2A.190305.002&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m87&quot;</span>: <span class="string">&quot;lac:40980,cid:3909155,rssi:22|lac:-1,cid:-1,rssi:20&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m88&quot;</span>: <span class="string">&quot;cn&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m89&quot;</span>: <span class="string">&quot;release-keys&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m90&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m91&quot;</span>: <span class="string">&quot;unknown&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m92&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m93&quot;</span>: <span class="string">&quot;&#123;\&quot;hashInfo\&quot;:[],\&quot;number\&quot;:0&#125;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m94&quot;</span>: <span class="string">&quot;sailfish&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m95&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m96&quot;</span>: <span class="string">&quot;8996-012001-1812132253&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m97&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m98&quot;</span>: <span class="string">&quot;Google&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m99&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m100&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m101&quot;</span>: <span class="string">&quot;CN&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m102&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m103&quot;</span>: <span class="string">&quot;26109874176&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m104&quot;</span>: <span class="string">&quot;1593600&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m105&quot;</span>: <span class="string">&quot;420&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m106&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m107&quot;</span>: <span class="string">&quot;ac:37:43:df:02:7e&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m108&quot;</span>: <span class="string">&quot;android-build&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m111&quot;</span>: <span class="string">&quot;37cb81453cec878d&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m112&quot;</span>: <span class="string">&quot;unknown&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m116&quot;</span>: <span class="string">&quot;wlan0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m117&quot;</span>: <span class="string">&quot;1631706064788&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m122&quot;</span>: <span class="string">&quot;AA==\n&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m123&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m125&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m126&quot;</span>: <span class="string">&quot;Dalvik/2.1.0(Linux;U;Android9;PixelBuild/PQ2A.190305.002)&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m127&quot;</span>: <span class="string">&quot;0.0000000000|0.0000000000&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m128&quot;</span>: <span class="string">&quot;unknown&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m129&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m130&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m131&quot;</span>: <span class="string">&quot;23132299264&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m132&quot;</span>: <span class="string">&quot;26109874176&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m133&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m134&quot;</span>: <span class="string">&quot;bus&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m135&quot;</span>: <span class="string">&quot;0.000000&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m136&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m137&quot;</span>: <span class="string">&quot;3.18.122-g665c9a1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m138&quot;</span>: <span class="string">&quot;[2,95]&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m139&quot;</span>: <span class="string">&quot;4&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m140&quot;</span>: <span class="string">&quot;arm64-v8a,armeabi-v7a,armeabi&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m141&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m142&quot;</span>: <span class="string">&quot;0.16470589&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m143&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m144&quot;</span>: <span class="string">&quot;11.12.204&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m145&quot;</span>: <span class="string">&quot;mtguard&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m146&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m147&quot;</span>: <span class="string">&quot;sailfish&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m148&quot;</span>: <span class="string">&quot;1631706140783&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m149&quot;</span>: <span class="string">&quot;1631706064&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m150&quot;</span>: <span class="string">&quot;1631754658276&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m151&quot;</span>: <span class="string">&quot;unknown&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m152&quot;</span>: <span class="string">&quot;5.1.7&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m153&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m154&quot;</span>: <span class="string">&quot;com.sankuai.meituan&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m155&quot;</span>: <span class="string">&quot;1629207179980&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m156&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m157&quot;</span>: <span class="string">&quot;3948302336&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m158&quot;</span>: <span class="string">&quot;sailfish&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m159&quot;</span>: <span class="string">&quot;abfarm722&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m160&quot;</span>: <span class="string">&quot;9&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m161&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m162&quot;</span>: <span class="string">&quot;unknown&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m163&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m164&quot;</span>: <span class="string">&quot;zh&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m165&quot;</span>: <span class="string">&quot;[GMT+08:00,Asia/Shanghai]&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m166&quot;</span>: <span class="string">&quot;Pixel&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m167&quot;</span>: <span class="string">&quot;1080*1794&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m253&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m254&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m255&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m256&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m293&quot;</span>: <span class="string">&quot;DAD7A2870A2DAAA2F67190B216A34A886A9E219F941D662641A653D9&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m241&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m242&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m245&quot;</span>: <span class="string">&quot;&#123;\&quot;libc.so:\&quot;:\&quot;E5592D3E966419A89DEF46F6BE029015\&quot;,\&quot;libandroid.so:\&quot;:\&quot;\&quot;,\&quot;libandroid_runtime.so:\&quot;:\&quot;2F4ADAB748DE1F97EACAC55B9584E504\&quot;,\&quot;libandroid_servers.so:\&quot;:\&quot;75AF8941A0B6C9A841C05442FE32CCFC\&quot;,\&quot;framework.jar:\&quot;:\&quot;\&quot;,\&quot;services.jar:\&quot;:\&quot;\&quot;,\&quot;core.jar:\&quot;:\&quot;\&quot;&#125;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m246&quot;</span>: <span class="string">&quot;ae:37:43:df:02:7e&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m247&quot;</span>: <span class="string">&quot;35253108683998&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m289&quot;</span>: <span class="string">&quot;352531086839980&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m290&quot;</span>: <span class="string">&quot;352531086839980&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m294&quot;</span>: <span class="string">&quot;&#123;\&quot;1\&quot;:\&quot;\&quot;,\&quot;2\&quot;:\&quot;1|2|3\&quot;,\&quot;3\&quot;:\&quot;\&quot;,\&quot;4\&quot;:\&quot;\&quot;,\&quot;5\&quot;:\&quot;\&quot;,\&quot;6\&quot;:\&quot;\&quot;,\&quot;7\&quot;:\&quot;2\&quot;,\&quot;8\&quot;:\&quot;\&quot;,\&quot;9\&quot;:\&quot;\&quot;,\&quot;10\&quot;:\&quot;\&quot;,\&quot;11\&quot;:\&quot;\&quot;,\&quot;12\&quot;:\&quot;32\&quot;,\&quot;13\&quot;:\&quot;\&quot;,\&quot;14\&quot;:\&quot;\&quot;,\&quot;15\&quot;:\&quot;\&quot;,\&quot;33\&quot;:&#123;\&quot;0\&quot;:2,\&quot;1\&quot;:\&quot;\&quot;,\&quot;2\&quot;:\&quot;\&quot;,\&quot;3\&quot;:\&quot;\&quot;,\&quot;4\&quot;:\&quot;2|22\&quot;,\&quot;5\&quot;:\&quot;\&quot;,\&quot;6\&quot;:\&quot;\&quot;,\&quot;7\&quot;:\&quot;\&quot;,\&quot;8\&quot;:\&quot;\&quot;,\&quot;9\&quot;:\&quot;\&quot;,\&quot;10\&quot;:\&quot;\&quot;,\&quot;11\&quot;:\&quot;\&quot;,\&quot;12\&quot;:\&quot;\&quot;,\&quot;13\&quot;:\&quot;\&quot;,\&quot;14\&quot;:\&quot;2\&quot;,\&quot;15\&quot;:\&quot;\&quot;&#125;&#125;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m304&quot;</span>: <span class="string">&quot;-1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m305&quot;</span>: <span class="string">&quot;1080*1920&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m217&quot;</span>: <span class="string">&quot;1631706064788185&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m243&quot;</span>: <span class="string">&quot;-1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m244&quot;</span>: <span class="string">&quot;&#123;\&quot;DCIM\&quot;:\&quot;00045F6737E705C00001C3B7F33CF3000005C810802CB9C0000083D1C295CA000005C810802CB9C0000083D1C295CA00\&quot;,\&quot;Android\&quot;:\&quot;00045F6737F648000002A40F89B18AC00005C5CB1C563D000000EE4ABA3499C00005C5CB1C563D000000EE4ABA3499C0\&quot;,\&quot;misc\&quot;:\&quot;0005BA6437AAF540000037EFB50958800005BDC662F5BF40000263501EE0BE000005BDC662F5BF40000263501EE0BE00\&quot;,\&quot;settings\&quot;:\&quot;00045F67360E000000005AF31103944000045F67360E000000005AF31103944000045F67360E000000005AF311039440\&quot;,\&quot;saver\&quot;:\&quot;0005BA6437AAF54000005F590941430000045F67377C360000014D7BCD19158000045F67377C360000014D7BCD191580\&quot;,\&quot;mtp\&quot;:\&quot;0005BA6437AAF5400000CC7CB757DE0000045F67360E00000001EB208F56774000045F67360E00000001EB208F567740\&quot;,\&quot;calendar\&quot;:\&quot;0005BA6437AAF54000008CD291CAAE4000045F6738AD630000019F5706658BC000045F6738AD630000019F5706658BC0\&quot;,\&quot;media\&quot;:\&quot;0005BA6437AAF5400000B7440023B8000000225E8BD0FF0000037B4E60CF5D000000225E8BD0FF0000037E567AF07C40\&quot;,\&quot;misc_ce\&quot;:\&quot;0005BA6437AAF540000062612371A48000045F6737D7C38000010AC9B10045C000057E646876D18000027F601A1B3540\&quot;,\&quot;rollback\&quot;:\&quot;\&quot;,\&quot;system\&quot;:\&quot;0005BA6437AAF54000005C50EF10E1800005CC17296EE1C0000373A4714044800005CC17296EE1C0000373A471404480\&quot;,\&quot;data\&quot;:\&quot;0005BA6437AAF5400000687157C325400005CC0732B344C000001BE686FAA0400005CC0732B344C000001BE686FAA040\&quot;,\&quot;install_sessions\&quot;:\&quot;0005BA6437AAF54000005F59094143000000225E8BD0FF00000329739E3E68C00000225E8BD0FF00000329739E3E68C0\&quot;,\&quot;webview\&quot;:\&quot;0005BA6437AAF54000008CD291CAAE4000045F6737C88140000104B976B8E40000045F6737C88140000107C190DA0340\&quot;&#125;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m248&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;m307&quot;</span>: <span class="string">&quot;&#123;\&quot;m34\&quot;:5,\&quot;m40\&quot;:5,\&quot;m41\&quot;:5,\&quot;m46\&quot;:5,\&quot;m58\&quot;:2,\&quot;m67\&quot;:6,\&quot;m68\&quot;:5,\&quot;m75\&quot;:6,\&quot;m80\&quot;:5,\&quot;m85\&quot;:5,\&quot;m91\&quot;:2,\&quot;m92\&quot;:5,\&quot;m97\&quot;:5,\&quot;m99\&quot;:5,\&quot;m112\&quot;:3,\&quot;m123\&quot;:5,\&quot;m125\&quot;:5,\&quot;m128\&quot;:6,\&quot;m129\&quot;:5,\&quot;m130\&quot;:5,\&quot;m133\&quot;:5,\&quot;m136\&quot;:5,\&quot;m151\&quot;:2,\&quot;m153\&quot;:5,\&quot;m156\&quot;:5,\&quot;m162\&quot;:6,\&quot;m253\&quot;:5,\&quot;m254\&quot;:7,\&quot;m256\&quot;:7,\&quot;m241\&quot;:7,\&quot;m242\&quot;:5,\&quot;m248\&quot;:5&#125;&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="6-3、加密设备数据"><a href="#6-3、加密设备数据" class="headerlink" title="6.3、加密设备数据"></a>6.3、加密设备数据</h2><p>解密PIC数据获取AES KEY, 解密后数据</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;a1&quot;</span>:<span class="number">0</span>,<span class="attr">&quot;a10&quot;</span>:<span class="number">400</span>,<span class="attr">&quot;a2&quot;</span>:<span class="string">&quot;com.sankuai.meituan&quot;</span>,<span class="attr">&quot;a11&quot;</span>:<span class="string">&quot;c1ee9178c95d9ec75f0f076a374df94a032d54c8576298d4f75e653de3705449&quot;</span>,<span class="attr">&quot;a3&quot;</span>:<span class="string">&quot;0a16ecd60eb56a6a3349f66cdcf7f7bf5190e5a42d6280d8dc0ee3be228398ec&quot;</span>,<span class="attr">&quot;a4&quot;</span>:<span class="number">1100030200</span>,<span class="attr">&quot;k0&quot;</span>:&#123;<span class="attr">&quot;k1&quot;</span>:<span class="string">&quot;meituan1sankuai0&quot;</span>,<span class="attr">&quot;k2&quot;</span>:<span class="string">&quot;meituan0sankuai1&quot;</span>,<span class="attr">&quot;k3&quot;</span>:<span class="string">&quot;$MXMYBS@HelloPay&quot;</span>,<span class="attr">&quot;k4&quot;</span>:<span class="string">&quot;Maoyan010iauknaS&quot;</span>,<span class="attr">&quot;k5&quot;</span>:<span class="string">&quot;34281a9dw2i701d4&quot;</span>,<span class="attr">&quot;k6&quot;</span>:<span class="string">&quot;X%rj@KiuU+|xY&#125;?f&quot;</span>&#125;,<span class="attr">&quot;a5&quot;</span>:<span class="string">&quot;11.3.200&quot;</span>,<span class="attr">&quot;a0&quot;</span>:<span class="string">&quot;pw/LhTdeoTTyaxPHcHMy+/ssGNS1ihNkrJ+uBI74FIfd90KlTil1m0i7FF/n0bhY&quot;</span>,<span class="attr">&quot;a6&quot;</span>:<span class="string">&quot;/HntC9XIfdUyII/UiVfx020EQPpHz2XZY3qzM2aiNmM0i0pB1yeSO689TY9SBB3s&quot;</span>,<span class="attr">&quot;a7&quot;</span>:<span class="string">&quot;QsHnU6kFjTYR8Z6tHEvkGMO2Hrt+NRnVQhmxg6EtVBzuzQcBpma3AdhTWNMpesFT&quot;</span>,<span class="attr">&quot;c0&quot;</span>:&#123;<span class="attr">&quot;c1&quot;</span>:<span class="literal">true</span>,<span class="attr">&quot;c2&quot;</span>:<span class="literal">false</span>&#125;,<span class="attr">&quot;a9&quot;</span>:<span class="string">&quot;SDEzWXi5LHL/cuMCZ1zYyv+0hIViqWWf+ShbUYILWf4=&quot;</span>,<span class="attr">&quot;a8&quot;</span>:<span class="number">1603800117167</span>&#125;</span><br></pre></td></tr></table></figure>

<p>解析json得到 aes key:meituan1sankuai0<br>AES加密设备json数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">IV 0102030405060708</span><br><span class="line">.text:C8AA94EE 06 98       LDR             R0, [SP,#0x120+byte_count] ; byte_count</span><br><span class="line">.text:C8AA94F0 E0 F7 FA EB BLX             malloc                  ; 存放加密后数据</span><br><span class="line">.text:C8AA94F4 00 26       MOVS            R6, #0</span><br><span class="line">.text:C8AA94F6 00 28       CMP             R0, #0</span><br><span class="line">.text:C8AA94F8 1C D0       BEQ             loc_C8AA9534</span><br><span class="line">.text:C8AA94FA 4A 99       LDR             R1, [SP,#0x120+arg_0]</span><br><span class="line">.text:C8AA94FC 03 91       STR             R1, [SP,#0x120+var_114]</span><br><span class="line">.text:C8AA94FE 07 AE       ADD             R6, SP, #0x120+var_104</span><br><span class="line">.text:C8AA9500 F4 21       MOVS            R1, #0xF4</span><br><span class="line">.text:C8AA9502 02 90       STR             R0, [SP,#0x120+var_118]</span><br><span class="line">.text:C8AA9504 30 00       MOVS            R0, R6</span><br><span class="line">.text:C8AA9506 E0 F7 08 EC BLX             __aeabi_memclr4</span><br><span class="line">.text:C8AA950A 80 21       MOVS            R1, #0x80</span><br><span class="line">.text:C8AA950C 20 00       MOVS            R0, R4</span><br><span class="line">.text:C8AA950E 32 00       MOVS            R2, R6</span><br><span class="line">.text:C8AA9510 56 F0 30 FF BL              AES_set_Encrypt_key_sub_CB601374 ; R0:key,R1:长度,R2:返回值</span><br><span class="line">.text:C8AA9514 06 9A       LDR             R2, [SP,#0x120+byte_count]</span><br><span class="line">.text:C8AA9516 01 20       MOVS            R0, #1</span><br><span class="line">.text:C8AA9518 69 46       MOV             R1, SP</span><br><span class="line">.text:C8AA951A 04 9B       LDR             R3, [SP,#0x120+var_110]</span><br><span class="line">.text:C8AA951C 0B 60       STR             R3, [R1,#0x120+var_120]</span><br><span class="line">.text:C8AA951E 48 60       STR             R0, [R1,#0x120+var_11C]</span><br><span class="line">.text:C8AA9520 05 98       LDR             R0, [SP,#0x120+p]</span><br><span class="line">.text:C8AA9522 02 9C       LDR             R4, [SP,#0x120+var_118]</span><br><span class="line">.text:C8AA9524 21 00       MOVS            R1, R4</span><br><span class="line">.text:C8AA9526 33 00       MOVS            R3, R6</span><br><span class="line">.text:C8AA9528 57 F0 7A FD BL              AES_cbc_Encrypt_sub_CB602020 ; R0：原始数据,R1:返回,R2:大小,R3:key</span><br><span class="line">.text:C8AA952C 06 98       LDR             R0, [SP,#0x120+byte_count]</span><br><span class="line">.text:C8AA952E 03 99       LDR             R1, [SP,#0x120+var_114]</span><br><span class="line">.text:C8AA9530 08 60       STR             R0, [R1]</span><br><span class="line">.text:C8AA9532 26 00       MOVS            R6, R4</span><br><span class="line">.text:C8AA9534</span><br><span class="line">.text:C8AA9534             loc_C8AA9534                            ; CODE XREF: Aes_sub_CB5AA4B8+40↑j</span><br><span class="line">.text:C8AA9534 05 98       LDR             R0, [SP,#0x120+p]       ; p</span><br><span class="line">.text:C8AA9536 E0 F7 DE EB BLX             free</span><br></pre></td></tr></table></figure>

<p>加密后数据(部分)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">C6A47000  6C 96 CF 82 B2 88 06 39  8D 37 E9 1C D3 D7 DF A1  l.ς ...9.7......</span><br><span class="line">C6A47010  A1 D7 C5 C7 A2 1F 21 47  F4 8D F8 E3 59 55 68 87  ...Ǣ .!G....YUh.</span><br><span class="line">C6A47020  13 D2 C7 A5 AD 47 51 04  64 B2 86 3A 86 AA 47 36  .....GQ.d..:..G6</span><br><span class="line">C6A47030  8A 26 F7 03 A0 42 3F 4E  B7 43 53 F5 E8 DE 9A 48  .&amp;....?N.CS....H</span><br><span class="line">C6A47040  FF 7D CC D3 30 91 1C 59  34 6C 3C D5 A4 45 AD 8A  .&#125;..0..Y4l&lt;դ E..</span><br><span class="line">C6A47050  69 06 49 EA 1B B5 95 7F  40 3F AF BE DB 18 CB CD  i.I.....@?......</span><br><span class="line">C6A47060  85 A9 05 0E 02 43 1C 10  2C 50 53 9F A0 A1 6D 14  .....C..,PS...m.</span><br><span class="line">C6A47070  DF F9 23 99 64 3C E4 D8  7C 56 58 C0 35 E6 81 34  ..#.d&lt;...VX.....</span><br><span class="line">C6A47080  9B 9C 6D A3 92 5B 36 50  6E 85 79 6E 2A 6C EB BF  ..m..[6Pn.yn*l..</span><br><span class="line">C6A47090  59 F5 77 F3 C3 F8 3D 47  04 D4 55 FB C1 D6 8D 3A  Y.....=G.......:</span><br><span class="line">C6A470A0  0F 4D EF 9E A2 C0 DF 93  58 B5 E1 79 22 EE 6A 65  .M  ...X.......</span><br><span class="line">C6A470B0  A4 A8 47 7F 68 BA C1 C7  19 96 8A 9E 29 90 48 07  ..G.h.......).H.</span><br></pre></td></tr></table></figure>

<p>base64加密(部分)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bJbPgrKIBjmNN+kc09ffoaHXxceiHyFH9I3441lVaIcT0selrUdRBGSyhjqGqkc2iib3A6BCP063Q1P16N6aSP99zNMwkRxZNGw81aRFrYppBknqG7WVf0A/r77bGMvNhakFDgJDHBAsUFOfoKFtFN/5I5lkPOTYfFZYwDXmgTSbnG2jkls2UG6FeW4qbOu/WfV388P4PUcE1FX7wdaNOg9N756iwN+TWLXheSLuamWkqEd/aLrBxxmWip4pkEgHlLK14AbB68tlUvIauN50i/KZVCun9lA13FmhY9t4JiZYMuQUiluXGtFLoVLUb3ybe9Uy156k8NFn8sZkCzx5I1nUFKEx2Mgb6Q+SDXY1r4TCh6jYCYd/Dfr+n1ccN+Z7M8oceexb3KD+yapCYKvhj2sm5/WptX+ncnTTalrLG8U53YZAJtwQ2NTZ/yuVJWNpnEjRE3EI</span><br></pre></td></tr></table></figure>

<p>返回java层组合请求体，计算请求头签名发送给服务器获取dfpid 请求体格式</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;data&quot;</span>:<span class="string">&quot;Native加密的设备数据&quot;</span>,<span class="attr">&quot;dfpVersion&quot;</span>:<span class="string">&quot;5.1.7&quot;</span>,<span class="attr">&quot;mtgVersion&quot;</span>:<span class="string">&quot;5.1.7&quot;</span>,<span class="attr">&quot;os&quot;</span>:<span class="string">&quot;Android&quot;</span>,<span class="attr">&quot;time&quot;</span>:<span class="string">&quot;2021-09-01 11:35:35&quot;</span>&#125;</span><br></pre></td></tr></table></figure>

<p>计算的请求头签名</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;a0&quot;</span>:<span class="string">&quot;2.0&quot;</span>,<span class="attr">&quot;a1&quot;</span>:<span class="string">&quot;9b69f861-e054-4bc4-9daf-d36ae205ed3e&quot;</span>,<span class="attr">&quot;a3&quot;</span>:<span class="number">2</span>,<span class="attr">&quot;a4&quot;</span>:<span class="number">1631778284</span>,<span class="attr">&quot;a5&quot;</span>:<span class="string">&quot;A18ywLdCS48BnwSLKup0wrjB+dsq4S6V+9BZPtgOWyf76KKpdYv8xejvBBC8HE6C4uRAl79/X7icd48pdktGG8B0+yAbMGtUl5Ri2kQc4/RgxjDiN64MjMvus7Aok+9LqzRZW1W9Qj2yJoMyK7h57/+amTSLDqyUzbat6zAgCAdeZ/vbKk+34+NVNwoz7fMLqvRlGbTVLZddTFIQvzbs1rNC3eV7mH9ORw==&quot;</span>,<span class="attr">&quot;a6&quot;</span>:<span class="number">0</span>,<span class="attr">&quot;a7&quot;</span>:<span class="string">&quot;lpArUzLcl+lgZ9YXlGR9nPVqJMM2UvrBYyFRM2UsDIidftxLwpEOzzcZ7NPmHxahYSpXrJr/eHv4y2FmjsLwnykKopieCU4Prh4FskqVsRg=&quot;</span>,<span class="attr">&quot;a8&quot;</span>:<span class="string">&quot;DAD796C46B5A6525F4B89DF661A97C7A218A219FC24B93F689DEBD92&quot;</span>,<span class="attr">&quot;a9&quot;</span>:<span class="string">&quot;97a62b63j1IexpGhrGBYdWqnstTXCpGUZncRa5MAcc5LtAO65uXQ/gPQuhqUcACAU5Cstbgs/wxZr8oFrMNqpSDo+Lt3QT7CenBY9BUnVn6bSHYNAaPhQ3WxYc1fpRi3+Lfpqz6/6CtwzNM113yKUoIgwMQZ2TTkRJ5S7JI0PztFc8u2I5ngz2thHx3rIXDjNXhmxoo7xH9rULUa65Y1zdPRx2xVNGDUJDFX78jvL39wIkvvnqBMK54GyQ8F8Vd/+lyPg1Wi3GoVUyFKrfw5RRDTElNyby2CvgQVKFRwHYbJu8OS3TjT6sW4uqmNxZQl4Zg4DBg/C6vlXAZISTCiCzC5yQ/xfqrQ5hNmKmsfHiVMduB7XYh9INAqceiTRlPV/ccY/JeGPRTbo52FoIHEponCLaToMU08uJVYC+hvT21OB/Wae2dr1l0vF4zDP+109YHgf7HbHg40TJW+UfIJdkAR0XHDINEqZIPmgE7jgon2B9KMXSyrWTg3OvOVA2USc7lBX9/8s1AXyI6MYgb7JwddM/cajZJle9ipMzJTmSZbJPw8o3bHGlt2pTtXzJb7mLgOxS1cwoc2kUTQYkRz5irPM1bhY4dT33d0tOr6C8IjROMgQMuIsVxKYCt88qo8ESk/nZEpVcWvBlsM+HWSwjHKtOJ8iPl3EqwSQiWRjVN6bOQyQIsPNVTfkZHSBqKnJ4dXcjXMTqcxGgxEzfD5sLfzXDz71A==&quot;</span>,<span class="attr">&quot;a10&quot;</span>:<span class="string">&quot;&#123;&#125;&quot;</span>,<span class="attr">&quot;x0&quot;</span>:<span class="number">1</span>,<span class="attr">&quot;a2&quot;</span>:<span class="string">&quot;0f4513356e64a6d70d962a764b1d68b8&quot;</span>&#125;</span><br></pre></td></tr></table></figure>

<p>发送给服务器后成功返回dfpid</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;code&quot;</span>:<span class="number">0</span>,<span class="attr">&quot;data&quot;</span>:&#123;<span class="attr">&quot;serverTimestamp&quot;</span>:<span class="number">0</span>,<span class="attr">&quot;clientIp&quot;</span>:<span class="string">&quot;218.xx.xx.xx&quot;</span>,<span class="attr">&quot;interval&quot;</span>:<span class="number">24</span>,<span class="attr">&quot;dfp&quot;</span>:<span class="string">&quot;8ecde1544fbe09ba3ec851e72fdd28c0803df1f83c5c0862c8ad571c&quot;</span>&#125;,<span class="attr">&quot;message&quot;</span>:<span class="string">&quot;ok&quot;</span>&#125;</span><br></pre></td></tr></table></figure>

<p>以上就是完整的dfpid设备指纹生成过程，xid生成也是类似的，也是在Native层获取设备信息加密返回到java层组合请求体，计算请求头签名，发送给服务器计算ID返回ID的过程，我就不再重复分析了。</p>
<h1 id="七、设备指纹攻击"><a href="#七、设备指纹攻击" class="headerlink" title="七、设备指纹攻击"></a>七、设备指纹攻击</h1><h2 id="7-1、设备指纹原理"><a href="#7-1、设备指纹原理" class="headerlink" title="7.1、设备指纹原理"></a>7.1、设备指纹原理</h2><p>设备指纹是用来标识手机设备的唯一ID，能够通过这个ID关联到手机相关的全部数据，因此设备指纹是风控中最核心的数据之一，所以它需要具备以下几个条件时ID不变：设备重置、设备更新、设备刷机。要同时具备这样的条件，必须从多个维度采集不同的信息来生成ID，这些信息可以大致分为：软件ID、软件静态特征、硬件静态特征和硬件动态特征。采集完信息后如何基于这些信息计算出一个稳定的设备指纹ID，还是有比较大挑战，再加上目前国家对公民隐私保护严格，用户敏感信息不能采集，很多唯一性比较好的数据就失效，要做一稳定性高的ID就难上加难了。</p>
<h2 id="7-2、设备指纹变与不变"><a href="#7-2、设备指纹变与不变" class="headerlink" title="7.2、设备指纹变与不变"></a>7.2、设备指纹变与不变</h2><p>既然设备指纹ID是根据手机设备的数据生成的，哪么我们的攻击思路就是修改设备信息，同一台手机不断变化设备信息让生成设备指纹的服务返回新的ID就算攻击成功了，因为它无法识别手机的唯一性。<br>实战修改设备字段生成新的dfpid<br>测试过程就是在内存中将采集的某设备字段改掉就可以生成新的设备ID(该字段是软件相关的ID，比较敏感就不说了，总共没有多少字段，想玩的朋友可以自己调试测试)<br>修改前后对比图7-1与7-2所示，返回新的ID:</p>
<p><img src="https://cdn.jsdelivr.net/gh/404nofoundx/ImageCloud/536985_DPP5RMBC3V9DYM3.bmp" alt="图7-1"></p>
<p><img src="https://cdn.jsdelivr.net/gh/404nofoundx/ImageCloud/536985_RKCY4TXQSR4C7XT.bmp" alt="图7-2"></p>
<h1 id="八、黑产工具特征检测"><a href="#八、黑产工具特征检测" class="headerlink" title="八、黑产工具特征检测"></a>八、黑产工具特征检测</h1><h2 id="8-1、解密黑产工具特征"><a href="#8-1、解密黑产工具特征" class="headerlink" title="8.1、解密黑产工具特征"></a>8.1、解密黑产工具特征</h2><p>获取密钥，解密PIC数据获取key(a9)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">.text:C8571594 20 00       MOVS            R0, R4</span><br><span class="line">.text:C8571596 32 00       MOVS            R2, R6</span><br><span class="line">.text:C8571598 57 F0 7A F8 BL              AES_set_decrypt_key_sub_CB601690 ; R0:key,R1:大小,R2:初始AES_KEY返回结构</span><br><span class="line">.text:C857159C 00 20       MOVS            R0, #0</span><br><span class="line">.text:C857159E 69 46       MOV             R1, SP</span><br><span class="line">.text:C85715A0 06 9A       LDR             R2, [SP,#0x128+var_110]</span><br><span class="line">.text:C85715A2 0A 60       STR             R2, [R1,#0x128+var_128]</span><br><span class="line">.text:C85715A4 48 60       STR             R0, [R1,#0x128+var_124]</span><br><span class="line">.text:C85715A6 08 98       LDR             R0, [SP,#0x128+var_108]</span><br><span class="line">.text:C85715A8 04 9E       LDR             R6, [SP,#0x128+var_118]</span><br><span class="line">.text:C85715AA 31 00       MOVS            R1, R6</span><br><span class="line">.text:C85715AC 07 9C       LDR             R4, [SP,#0x128+var_10C]</span><br><span class="line">.text:C85715AE 22 00       MOVS            R2, R4</span><br><span class="line">.text:C85715B0 03 9B       LDR             R3, [SP,#0x128+var_11C]</span><br><span class="line">.text:C85715B2 57 F0 35 FD BL              AES_cbc_Encrypt_sub_CB602020</span><br><span class="line">.text:C85715B6 30 00       MOVS            R0, R6</span><br></pre></td></tr></table></figure>

<p>解密后特征</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;0&quot;</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="attr">&quot;1&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;2&quot;</span>: [<span class="string">&quot;/sys/devices/virtual/misc/qemu_pipe&quot;</span>, <span class="string">&quot;/sys/module/vboxsf&quot;</span>, <span class="string">&quot;/system/droid4x&quot;</span>, <span class="string">&quot;/system/bin/droid4x-vbox-sf&quot;</span>, <span class="string">&quot;/system/lib/egl/libEGL_tiDetectanVM.so&quot;</span>, <span class="string">&quot;/system/bin/ttVM-vbox-sf&quot;</span>, <span class="string">&quot;/system/lib/libnox.so&quot;</span>, <span class="string">&quot;/system/bin/nox-vbox-sf&quot;</span>, <span class="string">&quot;/system/bin/androVM-vbox-sf&quot;</span>, <span class="string">&quot;/ueventd.vbox86.rc&quot;</span>, <span class="string">&quot;/sys/class/misc/qemu_pipe&quot;</span>, <span class="string">&quot;/sys/qemu_trace&quot;</span>, <span class="string">&quot;/dev/com.bluestacks.superuser.daemon&quot;</span>, <span class="string">&quot;/system/framework/libqemu_wl.txt&quot;</span>, <span class="string">&quot;/system/lib/libc_malloc_debug_qemu.so-arm&quot;</span>, <span class="string">&quot;/data/downloads/qemu_list.txt&quot;</span>, <span class="string">&quot;/system/bin/yiwan-prop&quot;</span>, <span class="string">&quot;/system/bin/yiwan-sf&quot;</span>, <span class="string">&quot;/system/bin/qemu_props&quot;</span>, <span class="string">&quot;/system/bin/androVM-prop&quot;</span>, <span class="string">&quot;/system/bin/microvirt-prop&quot;</span>, <span class="string">&quot;/system/lib/libdroid4x.so&quot;</span>, <span class="string">&quot;/system/bin/windroyed&quot;</span>, <span class="string">&quot;/system/bin/microvirtd&quot;</span>, <span class="string">&quot;/system/bin/nox-prop&quot;</span>, <span class="string">&quot;/system/bin/ttVM-prop&quot;</span>, <span class="string">&quot;/dev/qemu_pipe&quot;</span>, <span class="string">&quot;/vendor/bin/qemu-props&quot;</span>, <span class="string">&quot;/system/bin/droid4x-prop&quot;</span>, <span class="string">&quot;/data/.bluestacks.prop&quot;</span>, <span class="string">&quot;/system/app/com.mumu.launcher&quot;</span>, <span class="string">&quot;/system/lib/vboxguest.ko&quot;</span>, <span class="string">&quot;/system/lib/vboxsf.ko&quot;</span>, <span class="string">&quot;/sys/class/misc/vboxguest&quot;</span>, <span class="string">&quot;/sys/class/misc/vboxuser&quot;</span>],</span><br><span class="line">    <span class="attr">&quot;3&quot;</span>: [<span class="string">&quot;de.robv.android.xposed.installer&quot;</span>, <span class="string">&quot;com.saurik.substrate&quot;</span>, <span class="string">&quot;com.soft.apk008v&quot;</span>, <span class="string">&quot;com.soft.apk008Tool&quot;</span>, <span class="string">&quot;com.mockgps.outside.ui&quot;</span>, <span class="string">&quot;com.tim.apps.mockgps&quot;</span>, <span class="string">&quot;com.huichongzi.locationmocke&quot;</span>, <span class="string">&quot;com.lxzs&quot;</span>],</span><br><span class="line">    <span class="attr">&quot;4&quot;</span>: [<span class="string">&quot;XposedBridge.jar&quot;</span>, <span class="string">&quot;frida&quot;</span>, <span class="string">&quot;substrate&quot;</span>, <span class="string">&quot;libriru_edxp.so&quot;</span>, <span class="string">&quot;libsandhook.edxp.so&quot;</span>, <span class="string">&quot;libwhale.edxp.so&quot;</span>, <span class="string">&quot;libxposed_art.so&quot;</span>, <span class="string">&quot;edxp.jar&quot;</span>, <span class="string">&quot;fasthook&quot;</span>, <span class="string">&quot;libfakeloc_initzygote.so&quot;</span>, <span class="string">&quot;qssq666&quot;</span>, <span class="string">&quot;com.lxzs&quot;</span>, <span class="string">&quot;sandhook&quot;</span>, <span class="string">&quot;libsubstrate.so&quot;</span>, <span class="string">&quot;libiohook.so&quot;</span>, <span class="string">&quot;libepic.so&quot;</span>, <span class="string">&quot;libepic64.so&quot;</span>, <span class="string">&quot;libexp824.so&quot;</span>, <span class="string">&quot;libexp82464.so&quot;</span>, <span class="string">&quot;libexposed.so&quot;</span>, <span class="string">&quot;cydia&quot;</span>, <span class="string">&quot;/data/local/tmp&quot;</span>],</span><br><span class="line">    <span class="attr">&quot;5&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;6&quot;</span>: [<span class="string">&quot;de.robv.android.xposed.XposedBridge&quot;</span>, <span class="string">&quot;de.robv.android.xposed.XposedHelpers&quot;</span>],</span><br><span class="line">    <span class="attr">&quot;7&quot;</span>: [<span class="string">&quot;/system/lib/lic&quot;</span>, <span class="string">&quot;/system/lib/ccc&quot;</span>, <span class="string">&quot;/system/lib/.aa&quot;</span>],</span><br><span class="line">    <span class="attr">&quot;8&quot;</span>: [<span class="string">&quot;de.robv.android.xposed.XposedBridge&quot;</span>, <span class="string">&quot;xposed&quot;</span>, <span class="string">&quot;com.lxzs&quot;</span>],</span><br><span class="line">    <span class="attr">&quot;9&quot;</span>: [<span class="string">&quot;dexguard_DGResourcesSuperClass.dex&quot;</span>],</span><br><span class="line">    <span class="attr">&quot;10&quot;</span>: [<span class="string">&quot;VirtualBox&quot;</span>],</span><br><span class="line">    <span class="attr">&quot;11&quot;</span>: [<span class="string">&quot;com.gsxz.location&quot;</span>, <span class="string">&quot;net.anylocation&quot;</span>, <span class="string">&quot;com.huichongzi.locationmocker&quot;</span>, <span class="string">&quot;top.a1024bytes.mockloc.ca.pro&quot;</span>, <span class="string">&quot;com.deniu.daniu&quot;</span>],</span><br><span class="line">    <span class="attr">&quot;12&quot;</span>: [<span class="string">&quot;fridaserver&quot;</span>, <span class="string">&quot;magisk&quot;</span>, <span class="string">&quot;xposed&quot;</span>],</span><br><span class="line">    <span class="attr">&quot;13&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;14&quot;</span>: [<span class="string">&quot;charles&quot;</span>, <span class="string">&quot;fiddler&quot;</span>],</span><br><span class="line">    <span class="attr">&quot;15&quot;</span>: [<span class="string">&quot;com.netease.nemu_vinput.nemu&quot;</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="8-2、解析json检测特征"><a href="#8-2、解析json检测特征" class="headerlink" title="8.2、解析json检测特征"></a>8.2、解析json检测特征</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">//直接调用SVC指令,检测特征是否存在系统中。</span><br><span class="line">.text:C8571444             faccessat_sub_C8BE5444</span><br><span class="line">.text:C8571444</span><br><span class="line">.text:C8571444 F0 B5       PUSH            &#123;R4-R7,LR&#125;</span><br><span class="line">.text:C8571446 03 AF       ADD             R7, SP, #0xC</span><br><span class="line">.text:C8571448 0B 00       MOVS            R3, R1</span><br><span class="line">.text:C857144A 04 00       MOVS            R4, R0</span><br><span class="line">.text:C857144C 63 20       MOVS            R0, #0x63 ; &#x27;c&#x27;</span><br><span class="line">.text:C857144E C5 43       MVNS            R5, R0</span><br><span class="line">.text:C8571450 A7 20       MOVS            R0, #0xA7</span><br><span class="line">.text:C8571452 46 00       LSLS            R6, R0, #1</span><br><span class="line">.text:C8571454 28 46       MOV             R0, R5</span><br><span class="line">.text:C8571456 21 46       MOV             R1, R4</span><br><span class="line">.text:C8571458 1A 46       MOV             R2, R3</span><br><span class="line">.text:C857145A 37 46       MOV             R7, R6</span><br><span class="line">.text:C857145C 00 DF       SVC             0</span><br><span class="line">.text:C857145E 03 46       MOV             R3, R0</span><br><span class="line">.text:C8571460 18 00       MOVS            R0, R3</span><br><span class="line">.text:C8571462 F0 BD       POP             &#123;R4-R7,PC&#125;</span><br></pre></td></tr></table></figure>

<h1 id="九、总结"><a href="#九、总结" class="headerlink" title="九、总结"></a>九、总结</h1><h2 id="9-1、安全点"><a href="#9-1、安全点" class="headerlink" title="9.1、安全点"></a>9.1、安全点</h2><p>代码混淆，代码块间跳转动态计算获取，单步调试容易跑飞、流程混淆无法F5，字符串加密。采集设备信息都在Native层反射来获取，</p>
<h2 id="9-1、不足点"><a href="#9-1、不足点" class="headerlink" title="9.1、不足点"></a>9.1、不足点</h2><p>指纹稳定性比较差，在华为的机型上基本不行，防hook只是简单做了前几个字节判断，检测黑产工具的特征写死的。</p>
</div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91/">安卓逆向</a></div><!--!--></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered"> </h3><div class="buttons is-centered"><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信公众号</span><span class="qrcode"><img src="/img/qrcode.jpg" alt="微信公众号"></span></a><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-patreon"></i></span><span>知识星球</span><span class="qrcode"><img src="/img/zhishi_100.png" alt="知识星球"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/20220113/%E5%B0%8F-%E4%B9%A6APP-shield%E5%88%86%E6%9E%90/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">安卓逆向 | 某s社交类APP shield</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/20220110/Frida%E4%B8%BB%E5%8A%A8%E8%B0%83%E7%94%A8%E5%87%BD%E6%95%B0/"><span class="level-item">Frida主动调用函数</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">评论</h3><div class="content" id="waline-thread"></div><script src="https://cdn.jsdelivr.net/npm/@waline/client@1.3.1/dist/Waline.min.js"></script><script>Waline({
            el: '#waline-thread',
            serverURL: "https://blog-api-ab4zca1le-404nofoundx.vercel.app/",
            lang: "zh-CN",
            visitor: false,
            emoji: ["https://cdn.jsdelivr.net/gh/walinejs/emojis/weibo"],
            dark: "auto",
            meta: ["nick","mail"],
            requiredMeta: [],
            login: "enable",
            avatar: "mp",
            
            pageSize: 10,
            avatarCDN: "https://sdn.geekzu.org/avatar/",
            avatarForce: false,
            highlight: true,
            mathTagSupport: false,
            copyright: true,
            locale: {"placeholder":"Comment here..."},
        });</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/avatar.png" alt="R1024"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">R1024</p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">44</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">8</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">10</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/404nofoundx" target="_blank" rel="noopener">关注我</a></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#一、电商类APP业务风险类型"><span class="level-left"><span class="level-item">一、电商类APP业务风险类型</span></span></a></li><li><a class="level is-mobile" href="#二、设备指纹在业务中的应用"><span class="level-left"><span class="level-item">二、设备指纹在业务中的应用</span></span></a></li><li><a class="level is-mobile" href="#三、整体框架"><span class="level-left"><span class="level-item">三、整体框架</span></span></a></li><li><a class="level is-mobile" href="#四、初始化流程分析"><span class="level-left"><span class="level-item">四、初始化流程分析</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-1、初始化准备"><span class="level-left"><span class="level-item">4.1、初始化准备</span></span></a></li><li><a class="level is-mobile" href="#4-2、系统环境检测"><span class="level-left"><span class="level-item">4.2、系统环境检测</span></span></a></li><li><a class="level is-mobile" href="#4-3、读取资源文件并解密"><span class="level-left"><span class="level-item">4.3、读取资源文件并解密</span></span></a></li><li><a class="level is-mobile" href="#4-4、采集系统环境信息加密"><span class="level-left"><span class="level-item">4.4、采集系统环境信息加密</span></span></a></li><li><a class="level is-mobile" href="#4-5、第二次加密设备信息"><span class="level-left"><span class="level-item">4.5、第二次加密设备信息</span></span></a></li><li><a class="level is-mobile" href="#4-6、代码混淆"><span class="level-left"><span class="level-item">4.6、代码混淆</span></span></a></li></ul></li><li><a class="level is-mobile" href="#五、反爬虫mtgsig签名"><span class="level-left"><span class="level-item">五、反爬虫mtgsig签名</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#5-1、基本流程"><span class="level-left"><span class="level-item">5.1、基本流程</span></span></a></li><li><a class="level is-mobile" href="#5-2、加密系统环境信息"><span class="level-left"><span class="level-item">5.2、加密系统环境信息</span></span></a></li><li><a class="level is-mobile" href="#5-3、获取dfpid-设备指纹"><span class="level-left"><span class="level-item">5.3、获取dfpid (设备指纹)</span></span></a></li><li><a class="level is-mobile" href="#5-4、获取xid-设备指纹"><span class="level-left"><span class="level-item">5.4、获取xid (设备指纹)</span></span></a></li><li><a class="level is-mobile" href="#5-5、计算请求体签名值"><span class="level-left"><span class="level-item">5.5、计算请求体签名值</span></span></a></li></ul></li><li><a class="level is-mobile" href="#六、设备指纹分析"><span class="level-left"><span class="level-item">六、设备指纹分析</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#6-1、dfpid基本流程"><span class="level-left"><span class="level-item">6.1、dfpid基本流程</span></span></a></li><li><a class="level is-mobile" href="#6-2、dfpid请求体分析"><span class="level-left"><span class="level-item">6.2、dfpid请求体分析</span></span></a></li><li><a class="level is-mobile" href="#6-3、加密设备数据"><span class="level-left"><span class="level-item">6.3、加密设备数据</span></span></a></li></ul></li><li><a class="level is-mobile" href="#七、设备指纹攻击"><span class="level-left"><span class="level-item">七、设备指纹攻击</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#7-1、设备指纹原理"><span class="level-left"><span class="level-item">7.1、设备指纹原理</span></span></a></li><li><a class="level is-mobile" href="#7-2、设备指纹变与不变"><span class="level-left"><span class="level-item">7.2、设备指纹变与不变</span></span></a></li></ul></li><li><a class="level is-mobile" href="#八、黑产工具特征检测"><span class="level-left"><span class="level-item">八、黑产工具特征检测</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#8-1、解密黑产工具特征"><span class="level-left"><span class="level-item">8.1、解密黑产工具特征</span></span></a></li><li><a class="level is-mobile" href="#8-2、解析json检测特征"><span class="level-left"><span class="level-item">8.2、解析json检测特征</span></span></a></li></ul></li><li><a class="level is-mobile" href="#九、总结"><span class="level-left"><span class="level-item">九、总结</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#9-1、安全点"><span class="level-left"><span class="level-item">9.1、安全点</span></span></a></li><li><a class="level is-mobile" href="#9-1、不足点"><span class="level-left"><span class="level-item">9.1、不足点</span></span></a></li></ul></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">R1024</a><p class="is-size-7"><span>&copy; 2022</span>  Zhan  ♡  RR<br><span id="busuanzi_container_site_uv">共<span id="busuanzi_value_site_uv">0</span>个访客, <span id="busuanzi_value_site_pv">0</span>次访问</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://blog.csdn.net/qq_41179280?spm=1000.2115.3001.5343"><i class="fab fa-weibo"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://blog.csdn.net/qq_41179280?spm=1000.2115.3001.5343"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/404nofoundx"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><script type="text/javascript" src="/js/love.js"></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":200,"height":400},"mobile":{"show":true},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>